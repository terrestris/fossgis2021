!function(e,t,r,n,o){var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},u="function"==typeof i.parcelRequire827f&&i.parcelRequire827f,a=u.cache||{},c="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function l(t,r){if(!a[t]){if(!e[t]){var n="function"==typeof i.parcelRequire827f&&i.parcelRequire827f;if(!r&&n)return n(t,!0);if(u)return u(t,!0);if(c&&"string"==typeof t)return c(t);var o=new Error("Cannot find module '"+t+"'");throw o.code="MODULE_NOT_FOUND",o}s.resolve=function(r){return e[t][1][r]||r},s.cache={};var f=a[t]=new l.Module(t);e[t][0].call(f.exports,s,f,f.exports,this)}return a[t].exports;function s(e){return l(s.resolve(e))}}l.isParcelRequire=!0,l.Module=function(e){this.id=e,this.bundle=l,this.exports={}},l.modules=e,l.cache=a,l.parent=u,l.register=function(t,r){e[t]=[function(e,t){t.exports=r},{}]},Object.defineProperty(l,"root",{get:function(){return i.parcelRequire827f}}),i.parcelRequire827f=l;for(var f=0;f<t.length;f++)l(t[f])}({"1asXb":[function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.hasOwnProperty.call(e,r)&&n(t,e,r);return o(t,e),t},u=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function u(e){try{c(n.next(e))}catch(e){i(e)}}function a(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(u,a)}c((n=n.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var r,n,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,n=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=u.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=t.call(e,u)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0}),r.SqliteAdapter=void 0;var l=c(e("fs")),f=c(e("path")),s=c(e("http")),p=c(e("os")),h=function(){function t(e){this.filePath=e}return t.prototype.initialize=function(){return u(this,void 0,void 0,(function(){var t,r,n,o,u,c=this;return a(this,(function(a){switch(a.label){case 0:return[4,Promise.resolve().then((function(){return e("better-sqlite3")})).then((function(e){return i(e)}))];case 1:t=a.sent(),r=t.default;try{return this.filePath&&"string"==typeof this.filePath?0===this.filePath.indexOf("http")?(n=this.filePath,[2,new Promise((function(e,t){s.default.get(n,(function(n){200!==n.statusCode&&t(new Error("Unable to reach url: "+c.filePath));var o=f.default.join(p.default.tmpdir(),Date.now()+Math.floor(100*Math.random())+".gpkg"),i=l.default.createWriteStream(o);n.pipe(i),i.on("close",(function(){try{c.db=new r(o),c.db.pragma("journal_mode = WAL"),c.filePath=o,e(c)}catch(e){console.log("error",e),t(e)}}))})).on("error",(function(e){t(e)}))}))]):(this.db=new r(this.filePath),[2,this]):this.filePath?(o=this.filePath,u=f.default.join(p.default.tmpdir(),Date.now()+".gpkg"),[2,new Promise((function(e,t){l.default.writeFile(u,o,(function(){c.db=new r(u);try{c.db.pragma("journal_mode = WAL")}catch(e){console.log("error",e),t(e)}c.filePath=u,e(c)}))}))]):(console.log("create in memory"),this.db=new r("memory"+Math.random(),{memory:!this.filePath}),[2,this])}catch(e){throw console.log("Error opening database",e),e}return[2]}}))}))},t.prototype.close=function(){this.db.pragma("wal_autocheckpoint=0"),this.db.checkpoint(),this.db.close()},t.prototype.getDBConnection=function(){return this.db},t.prototype.export=function(){return u(this,void 0,void 0,(function(){var e=this;return a(this,(function(t){return[2,new Promise((function(t){return l.default.readFile(e.filePath,(function(e,r){t(r)}))}))]}))}))},t.prototype.registerFunction=function(e,t){return this.db.function(e,t),this},t.prototype.get=function(e,t){var r=this.db.prepare(e);return t?r.get(t):r.get()},t.prototype.isTableExists=function(e){return!!this.db.prepare("SELECT name FROM sqlite_master WHERE type='table' AND name=:name").get({name:e})},t.prototype.all=function(e,t){var r=this.db.prepare(e);return t?r.all(t):r.all()},t.prototype.each=function(e,t){var r=this.db.prepare(e);return t?r.iterate(t):r.iterate()},t.prototype.run=function(e,t){var r=this.db.prepare(e);return t?r.run(t):r.run()},t.prototype.insert=function(e,t){return this.db.prepare(e).run(t).lastInsertRowid},t.prototype.delete=function(e,t){return this.db.prepare(e).run(t).changes},t.prototype.dropTable=function(e){try{var t=this.db.prepare('DROP TABLE IF EXISTS "'+e+'"').run();return this.db.prepare("VACUUM").run(),0===t.changes}catch(e){return console.log("Drop Table Error",e),!1}},t.prototype.count=function(e,t,r){var n='SELECT COUNT(*) as count FROM "'+e+'"';t&&(n+=" where "+t);var o=this.db.prepare(n);return r?o.get(r).count:o.get().count},t}();r.SqliteAdapter=h},{fs:"2RD6T",path:"7rNOE",http:"2uALp",os:"4nIZo","better-sqlite3":"6tmlq"}],"4nIZo":[function(e,t,r){r.endianness=function(){return"LE"},r.hostname=function(){return"undefined"!=typeof location?location.hostname:""},r.loadavg=function(){return[]},r.uptime=function(){return 0},r.freemem=function(){return Number.MAX_VALUE},r.totalmem=function(){return Number.MAX_VALUE},r.cpus=function(){return[]},r.type=function(){return"Browser"},r.release=function(){return"undefined"!=typeof navigator?navigator.appVersion:""},r.networkInterfaces=r.getNetworkInterfaces=function(){return{}},r.arch=function(){return"javascript"},r.platform=function(){return"browser"},r.tmpdir=r.tmpDir=function(){return"/tmp"},r.EOL="\n",r.homedir=function(){return"/"}},{}],"6tmlq":[function(e,t,r){t.exports=e("./loaders/browser/js-loader")(e("./bundle-url").getBundleURL()+e("./relative-path")("5RlLk","4zvP4")).then((()=>t.bundle.root("2nurn")))},{"./loaders/browser/js-loader":"2Ucmd","./bundle-url":"3seVR","./relative-path":"3LXuB"}]},[]);
//# sourceMappingURL=sqliteAdapter.092a150f.js.map
