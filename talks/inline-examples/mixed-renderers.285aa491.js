parcelRequire=function(e){var r="function"==typeof parcelRequire&&parcelRequire,n="function"==typeof require&&require,i={};function u(e,u){if(e in i)return i[e];var t="function"==typeof parcelRequire&&parcelRequire;if(!u&&t)return t(e,!0);if(r)return r(e,!0);if(n&&"string"==typeof e)return n(e);var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}return u.register=function(e,r){i[e]=r},i=e(u),u.modules=i,u}(function (require) {function Cd(a){return a&&a.__esModule?{d:a.default}:{d:a}}var Gc={};var Hc={};var Tb={};var Ic={};var Jc={};function h(){return function(){throw new Error("Unimplemented abstract method.")}()}Jc.abstract=h;var qm=0;function aa(t){return t.ol_uid||(t.ol_uid=String(++qm))}Jc.getUid=aa;var Dd="6.2.2-dev.1583881025549";Jc.VERSION=Dd;var rm=Ic&&Ic.__extends||function(){var t=function(r,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])})(r,e)};return function(r,e){function o(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),ef=function(t){function r(r){var e=this,o="Assertion failed. See https://openlayers.org/en/"+("latest"===Dd?Dd:"v"+Dd.split("-")[0])+"/doc/errors/#"+r+" for details.";return(e=t.call(this,o)||this).code=r,e.name="AssertionError",e.message=o,e}return rm(r,t),r}(Error);Ic.default=ef;var C={ADD:"add",REMOVE:"remove"};var ub={};var Ya={PROPERTYCHANGE:"propertychange"};var Ub={};var Kc={};function d(e,t,n,$,r){if($&&$!==e&&(n=n.bind($)),r){var i=n;n=function(){e.removeEventListener(t,n),i.apply(this,arguments)}}var a={target:e,type:t,listener:n};return e.addEventListener(t,n),a}function Vb(e,t,n,$){return d(e,t,n,$,!0)}function m(e){e&&e.target&&(e.target.removeEventListener(e.type,e.listener),Za(e))}var Wb={},L="function"==typeof Object.assign?Object.assign:function(e,r){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),s=1,n=arguments.length;s<n;++s){var o=arguments[s];if(null!=o)for(var $ in o)o.hasOwnProperty($)&&(t[$]=o[$])}return t};function Za(e){for(var r in e)delete e[r]}Wb.assign=L,Wb.clear=Za;var Ed="function"==typeof Object.values?Object.values:function(e){var r=[];for(var t in e)r.push(e[t]);return r};function Lc(e){var r;for(r in e)return!1;return!r}Wb.getValues=Ed,Wb.isEmpty=Lc;Kc.listen=d,Kc.listenOnce=Vb,Kc.unlistenByKey=m;var Mc={};var ff={},Nc=function(){function t(){this.disposed_=!1}return t.prototype.dispose=function(){this.disposed_||(this.disposed_=!0,this.disposeInternal())},t.prototype.disposeInternal=function(){},t}();ff.default=Nc;function W(){return!0}function vb(){return!1}function Da(){}function sm($){var r,p,e,t=!1;return function(){var o=Array.prototype.slice.call(arguments);return t&&this===e&&$a(o,p)||(t=!0,e=this,p=o,r=$.apply(this,arguments)),r}}var S={};function gi(r,e,o){for(var n,t,$=o||Ea,i=0,u=r.length,a=!1;i<u;)(t=+$(r[n=i+(u-i>>1)],e))<0?i=n+1:(u=n,a=!t);return a?i:~i}function Ea(r,e){return r>e?1:r<e?-1:0}function N(r,e){return r.indexOf(e)>=0}function gf(r,e,o){var n=r.length;if(r[0]<=e)return 0;if(e<=r[n-1])return n-1;var t=void 0;if(o>0){for(t=1;t<n;++t)if(r[t]<e)return t-1}else if(o<0){for(t=1;t<n;++t)if(r[t]<=e)return t}else for(t=1;t<n;++t){if(r[t]==e)return t;if(r[t]<e)return r[t-1]-e<e-r[t]?t-1:t}return n-1}function hi(r,e,o){for(;e<o;){var n=r[e];r[e]=r[o],r[o]=n,++e,--o}}function v(r,e){for(var o=Array.isArray(e)?e:[e],n=o.length,t=0;t<n;t++)r[r.length]=o[t]}function tm(r,e){var o=r.indexOf(e),n=o>-1;return n&&r.splice(o,1),n}function um(r,e){for(var o,n=r.length>>>0,t=0;t<n;t++)if(e(o=r[t],t,r))return o;return null}function $a(r,e){var o=r.length;if(o!==e.length)return!1;for(var n=0;n<o;n++)if(r[n]!==e[n])return!1;return!0}function vm(r,e){var o,n=r.length,t=Array(r.length);for(o=0;o<n;o++)t[o]={index:o,value:r[o]};for(t.sort(function(r,o){return e(r.value,o.value)||r.index-o.index}),o=0;o<r.length;o++)r[o]=t[o].value}function wm(r,e){var o;return!r.every(function(n,t){return o=t,!e(n,t,r)})?o:-1}function xm(r,e,o){var n=e||Ea;return r.every(function(e,t){if(0===t)return!0;var $=n(r[t-1],e);return!($>0||o&&0===$)})}S.binarySearch=gi,S.numberSafeCompareFunction=Ea,S.includes=N,S.linearFindNearest=gf,S.reverseSubArray=hi,S.extend=v,S.remove=tm,S.find=um,S.equals=$a,S.stableSort=vm,S.findIndex=wm,S.isSorted=xm;var Oc={},T=function(){function t(t){this.propagationStopped,this.type=t,this.target=null}return t.prototype.preventDefault=function(){this.propagationStopped=!0},t.prototype.stopPropagation=function(){this.propagationStopped=!0},t}();function ii(t){t.stopPropagation()}function ym(t){t.preventDefault()}Oc.stopPropagation=ii,Oc.preventDefault=ym,Oc.default=T;var zm=Mc&&Mc.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Xb=function(t){function e(e){var n=t.call(this)||this;return n.eventTarget_=e,n.pendingRemovals_={},n.dispatching_={},n.listeners_={},n}return zm(e,t),e.prototype.addEventListener=function(t,e){if(t&&e){var n=this.listeners_[t];n||(n=[],this.listeners_[t]=n),-1===n.indexOf(e)&&n.push(e)}},e.prototype.dispatchEvent=function(t){var e="string"==typeof t?new T(t):t,n=e.type;e.target||(e.target=this.eventTarget_||this);var i,r=this.listeners_[n];if(r){n in this.dispatching_||(this.dispatching_[n]=0,this.pendingRemovals_[n]=0),++this.dispatching_[n];for(var s=0,o=r.length;s<o;++s)if(!1===(i="handleEvent"in r[s]?r[s].handleEvent(e):r[s].call(this,e))||e.propagationStopped){i=!1;break}if(--this.dispatching_[n],0===this.dispatching_[n]){var p=this.pendingRemovals_[n];for(delete this.pendingRemovals_[n];p--;)this.removeEventListener(n,Da);delete this.dispatching_[n]}return i}},e.prototype.disposeInternal=function(){Za(this.listeners_)},e.prototype.getListeners=function(t){return this.listeners_[t]},e.prototype.hasListener=function(t){return t?t in this.listeners_:Object.keys(this.listeners_).length>0},e.prototype.removeEventListener=function(t,e){var n=this.listeners_[t];if(n){var i=n.indexOf(e);-1!==i&&(t in this.pendingRemovals_?(n[i]=Da,++this.pendingRemovals_[t]):(n.splice(i,1),0===n.length&&delete this.listeners_[t]))}},e}(Nc);Mc.default=Xb;var hf={},f={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",TOUCHMOVE:"touchmove",WHEEL:"wheel"};hf.default=f;var Am=Ub&&Ub.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),jf=function(t){function e(){var e=t.call(this)||this;return e.revision_=0,e}return Am(e,t),e.prototype.changed=function(){++this.revision_,this.dispatchEvent(f.CHANGE)},e.prototype.getRevision=function(){return this.revision_},e.prototype.on=function(t,e){if(Array.isArray(t)){for(var r=t.length,n=new Array(r),o=0;o<r;++o)n[o]=d(this,t[o],e);return n}return d(this,t,e)},e.prototype.once=function(t,e){if(Array.isArray(t)){for(var r=t.length,n=new Array(r),o=0;o<r;++o)n[o]=Vb(this,t[o],e);return n}return Vb(this,t,e)},e.prototype.un=function(t,e){if(Array.isArray(t))for(var r=0,n=t.length;r<n;++r)this.removeEventListener(t[r],e);else this.removeEventListener(t,e)},e}(Xb);function Bm(t){if(Array.isArray(t))for(var e=0,r=t.length;e<r;++e)m(t[e]);else m(t)}Ub.unByKey=Bm,Ub.default=jf;var ji=ub&&ub.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),kf=function(e){function t(t,r,n){var $=e.call(this,t)||this;return $.key=r,$.oldValue=n,$}return ji(t,e),t}(T);ub.ObjectEvent=kf;var X=function(e){function t(t){var r=e.call(this)||this;return aa(r),r.values_={},void 0!==t&&r.setProperties(t),r}return ji(t,e),t.prototype.get=function(e){var t;return this.values_.hasOwnProperty(e)&&(t=this.values_[e]),t},t.prototype.getKeys=function(){return Object.keys(this.values_)},t.prototype.getProperties=function(){return L({},this.values_)},t.prototype.notify=function(e,t){var r;r=A(e),this.dispatchEvent(new kf(r,e,t)),r=Ya.PROPERTYCHANGE,this.dispatchEvent(new kf(r,e,t))},t.prototype.set=function(e,t,r){if(r)this.values_[e]=t;else{var n=this.values_[e];this.values_[e]=t,n!==t&&this.notify(e,n)}},t.prototype.setProperties=function(e,t){for(var r in e)this.set(r,e[r],t)},t.prototype.unset=function(e,t){if(e in this.values_){var r=this.values_[e];delete this.values_[e],t||this.notify(e,r)}},t}(jf),lf={};function A(e){return lf.hasOwnProperty(e)?lf[e]:lf[e]="change:"+e}ub.getChangeEventType=A,ub.default=X;var ki=Tb&&Tb.__extends||function(){var t=function(r,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])})(r,e)};return function(r,e){function n(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}(),li={LENGTH:"length"},Pc=function(t){function r(r,e,n){var o=t.call(this,r)||this;return o.element=e,o.index=n,o}return ki(r,t),r}(T);Tb.CollectionEvent=Pc;var K=function(t){function r(r,e){var n=t.call(this)||this,o=e||{};if(n.unique_=!!o.unique,n.array_=r||[],n.unique_)for(var i=0,s=n.array_.length;i<s;++i)n.assertUnique_(n.array_[i],i);return n.updateLength_(),n}return ki(r,t),r.prototype.clear=function(){for(;this.getLength()>0;)this.pop()},r.prototype.extend=function(t){for(var r=0,e=t.length;r<e;++r)this.push(t[r]);return this},r.prototype.forEach=function(t){for(var r=this.array_,e=0,n=r.length;e<n;++e)t(r[e],e,r)},r.prototype.getArray=function(){return this.array_},r.prototype.item=function(t){return this.array_[t]},r.prototype.getLength=function(){return this.get(li.LENGTH)},r.prototype.insertAt=function(t,r){this.unique_&&this.assertUnique_(r),this.array_.splice(t,0,r),this.updateLength_(),this.dispatchEvent(new Pc(C.ADD,r,t))},r.prototype.pop=function(){return this.removeAt(this.getLength()-1)},r.prototype.push=function(t){this.unique_&&this.assertUnique_(t);var r=this.getLength();return this.insertAt(r,t),this.getLength()},r.prototype.remove=function(t){for(var r=this.array_,e=0,n=r.length;e<n;++e)if(r[e]===t)return this.removeAt(e)},r.prototype.removeAt=function(t){var r=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new Pc(C.REMOVE,r,t)),r},r.prototype.setAt=function(t,r){var e=this.getLength();if(t<e){this.unique_&&this.assertUnique_(r,t);var n=this.array_[t];this.array_[t]=r,this.dispatchEvent(new Pc(C.REMOVE,n,t)),this.dispatchEvent(new Pc(C.ADD,r,t))}else{for(var o=e;o<t;++o)this.insertAt(o,void 0);this.insertAt(t,r)}},r.prototype.updateLength_=function(){this.set(li.LENGTH,this.array_.length)},r.prototype.assertUnique_=function(t,r){for(var e=0,n=this.array_.length;e<n;++e)if(this.array_[e]===t&&e!==r)throw new ef(58)},r}(X);Tb.default=K;var Qc={};var Rc={};var Cm=Rc&&Rc.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Sc=function(t){function e(e,r,n){var o=t.call(this,e)||this;return o.map=r,o.frameState=void 0!==n?n:null,o}return Cm(e,t),e}(T);Rc.default=Sc;var Dm=Qc&&Qc.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function n(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),mf=function(t){function e(e,o,n,r,i){var p=t.call(this,e,o,i)||this;return p.originalEvent=n,p.pixel_=null,p.coordinate_=null,p.dragging=void 0!==r&&r,p}return Dm(e,t),Object.defineProperty(e.prototype,"pixel",{get:function(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_},set:function(t){this.pixel_=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"coordinate",{get:function(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_},set:function(t){this.coordinate_=t},enumerable:!0,configurable:!0}),e.prototype.preventDefault=function(){t.prototype.preventDefault.call(this),this.originalEvent.preventDefault()},e.prototype.stopPropagation=function(){t.prototype.stopPropagation.call(this),this.originalEvent.stopPropagation()},e}(Sc);Qc.default=mf;var Tc={};var mi=null,ni=null;function Em(){Element.prototype.setPointerCapture=Element.prototype.setCapture,Element.prototype.releasePointerCapture=Element.prototype.releaseCapture}function nf(e,t,r){e.addEventListener(t,function(e){var n=new MouseEvent(r,e);n.pointerId=1,n.isPrimary=!0,n.pointerType="mouse",n.width=1,n.height=1,n.tiltX=0,n.tiltY=0,"buttons"in e&&0!==e.buttons?n.pressure=.5:n.pressure=0;var o=e.target;null!==ni&&(o=ni,"mouseup"===t&&(ni=null)),o.dispatchEvent(n),n.defaultPrevented&&e.preventDefault()})}function of(e,t,r){e.addEventListener(t,function(e){for(var n=e.changedTouches,o=n.length,i=0;i<o;i++){var a=new CustomEvent(r,{bubbles:!0,cancelable:!0});a.ctrlKey=e.ctrlKey,a.shiftKey=e.shiftKey,a.altKey=e.altKey,a.metaKey=e.metaKey;var u=n.item(i);a.clientX=u.clientX,a.clientY=u.clientY,a.screenX=u.screenX,a.screenY=u.screenY,a.pageX=u.pageX,a.pageY=u.pageY;var $=u.target.getBoundingClientRect();a.offsetX=u.clientX-$.left,a.offsetY=u.clientY-$.top,a.pointerId=1+u.identifier,a.button=0,a.buttons=1,a.movementX=0,a.movementY=0,a.region=null,a.relatedTarget=null,a.x=a.clientX,a.y=a.clientY,a.pointerType="touch",a.width=1,a.height=1,a.tiltX=0,a.tiltY=0,a.pressure=1,"touchstart"===t&&null===mi&&(mi=u.identifier),a.isPrimary=u.identifier===mi,"touchend"===t&&a.isPrimary&&(mi=null),e.target.dispatchEvent(a),a.defaultPrevented&&e.preventDefault()}})}"PointerEvent"in window||(Em(),"TouchEvent"in window||(nf(document,"mousedown","pointerdown"),nf(document,"mousemove","pointermove"),nf(document,"mouseup","pointerup")),of(document,"touchstart","pointerdown"),of(document,"touchmove","pointermove"),of(document,"touchend","pointerup"));var Yb="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"",Fm=-1!==Yb.indexOf("firefox");var Jt=-1!==Yb.indexOf("safari")&&-1==Yb.indexOf("chrom");var Gm=-1!==Yb.indexOf("webkit")&&-1==Yb.indexOf("edge");var Hm=-1!==Yb.indexOf("macintosh");var Uc=window.devicePixelRatio||1;var oi="undefined"!=typeof Image&&Image.prototype.decode;var pi=function(){var $=!1;try{var e=Object.defineProperty({},"passive",{get:function(){$=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch(p){}return $}();var j={SINGLECLICK:"singleclick",CLICK:f.CLICK,DBLCLICK:f.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};var Vc={};var Im=Vc&&Vc.__extends||function(){var t=function(r,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])})(r,e)};return function(r,e){function o(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),Fa=function(t){function r(r,e,o,n,s){var $=t.call(this,r,e,o,n,s)||this;return $.pointerEvent=o,$}return Im(r,t),r}(mf);Vc.default=Fa;var Ga={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};var Jm=Tc&&Tc.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),qi=function(t){function e(e,i){var r=t.call(this,e)||this;r.map_=e,r.clickTimeoutId_,r.dragging_=!1,r.dragListenerKeys_=[],r.moveTolerance_=i?i*Uc:Uc,r.down_=null;var n=r.map_.getViewport();return r.activePointers_=0,r.trackedTouches_={},r.element_=n,r.pointerdownListenerKey_=d(n,Ga.POINTERDOWN,r.handlePointerDown_,r),r.originalPointerMoveEvent_,r.relayedListenerKey_=d(n,Ga.POINTERMOVE,r.relayEvent_,r),r.boundHandleTouchMove_=r.handleTouchMove_.bind(r),r.element_.addEventListener(f.TOUCHMOVE,r.boundHandleTouchMove_,!!pi&&{passive:!1}),r}return Jm(e,t),e.prototype.emulateClick_=function(t){var e=new Fa(j.CLICK,this.map_,t);this.dispatchEvent(e),void 0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new Fa(j.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=void 0;var e=new Fa(j.SINGLECLICK,this.map_,t);this.dispatchEvent(e)}.bind(this),250)},e.prototype.updateActivePointers_=function(t){var e=t;e.type==j.POINTERUP||e.type==j.POINTERCANCEL?delete this.trackedTouches_[e.pointerId]:e.type==j.POINTERDOWN&&(this.trackedTouches_[e.pointerId]=!0),this.activePointers_=Object.keys(this.trackedTouches_).length},e.prototype.handlePointerUp_=function(t){this.updateActivePointers_(t);var e=new Fa(j.POINTERUP,this.map_,t);this.dispatchEvent(e),e.propagationStopped||this.dragging_||!this.isMouseActionButton_(t)||this.emulateClick_(this.down_),0===this.activePointers_&&(this.dragListenerKeys_.forEach(m),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)},e.prototype.isMouseActionButton_=function(t){return 0===t.button},e.prototype.handlePointerDown_=function(t){this.updateActivePointers_(t);var e=new Fa(j.POINTERDOWN,this.map_,t);this.dispatchEvent(e),this.down_=t,0===this.dragListenerKeys_.length&&this.dragListenerKeys_.push(d(document,j.POINTERMOVE,this.handlePointerMove_,this),d(document,j.POINTERUP,this.handlePointerUp_,this),d(this.element_,j.POINTERCANCEL,this.handlePointerUp_,this))},e.prototype.handlePointerMove_=function(t){if(this.isMoving_(t)){this.dragging_=!0;var e=new Fa(j.POINTERDRAG,this.map_,t,this.dragging_);this.dispatchEvent(e)}},e.prototype.relayEvent_=function(t){this.originalPointerMoveEvent_=t;var e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new Fa(t.type,this.map_,t,e))},e.prototype.handleTouchMove_=function(t){this.originalPointerMoveEvent_&&!this.originalPointerMoveEvent_.defaultPrevented||t.preventDefault()},e.prototype.isMoving_=function(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_},e.prototype.disposeInternal=function(){this.relayedListenerKey_&&(m(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(f.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(m(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(m),this.dragListenerKeys_.length=0,this.element_=null,t.prototype.disposeInternal.call(this)},e}(Xb);Tc.default=qi;var Zb={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend"};var s={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"};var pf={},_a={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"};pf.default=_a;var Wc={};var qf={},fa={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};qf.default=fa;var rf={};function q(r,$){if(!r)throw new ef($)}rf.assert=q;var Fd=1/0;var Km=function(){function t(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}return t.prototype.clear=function(){this.elements_.length=0,this.priorities_.length=0,Za(this.queuedElements_)},t.prototype.dequeue=function(){var t=this.elements_,e=this.priorities_,i=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));var n=this.keyFunction_(i);return delete this.queuedElements_[n],i},t.prototype.enqueue=function(t){q(!(this.keyFunction_(t)in this.queuedElements_),31);var e=this.priorityFunction_(t);return e!=Fd&&(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)},t.prototype.getCount=function(){return this.elements_.length},t.prototype.getLeftChildIndex_=function(t){return 2*t+1},t.prototype.getRightChildIndex_=function(t){return 2*t+2},t.prototype.getParentIndex_=function(t){return t-1>>1},t.prototype.heapify_=function(){var t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)},t.prototype.isEmpty=function(){return 0===this.elements_.length},t.prototype.isKeyQueued=function(t){return t in this.queuedElements_},t.prototype.isQueued=function(t){return this.isKeyQueued(this.keyFunction_(t))},t.prototype.siftUp_=function(t){for(var e=this.elements_,i=this.priorities_,n=e.length,r=e[t],s=i[t],o=t;t<n>>1;){var u=this.getLeftChildIndex_(t),h=this.getRightChildIndex_(t),p=h<n&&i[h]<i[u]?h:u;e[t]=e[p],i[t]=i[p],t=p}e[t]=r,i[t]=s,this.siftDown_(o,t)},t.prototype.siftDown_=function(t,e){for(var i=this.elements_,n=this.priorities_,r=i[e],s=n[e];e>t;){var o=this.getParentIndex_(e);if(!(n[o]>s))break;i[e]=i[o],n[e]=n[o],e=o}i[e]=r,n[e]=s},t.prototype.reprioritize=function(){var t,e,i,n=this.priorityFunction_,r=this.elements_,s=this.priorities_,o=0,u=r.length;for(e=0;e<u;++e)(i=n(t=r[e]))==Fd?delete this.queuedElements_[this.keyFunction_(t)]:(s[o]=i,r[o++]=t);r.length=o,s.length=o,this.heapify_()},t}();var Lm=Wc&&Wc.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),ri=function(e){function t(t,i){var n=e.call(this,function(e){return t.apply(null,e)},function(e){return e[0].getKey()})||this;return n.boundHandleTileChange_=n.handleTileChange.bind(n),n.tileChangeCallback_=i,n.tilesLoading_=0,n.tilesLoadingKeys_={},n}return Lm(t,e),t.prototype.enqueue=function(t){var i=e.prototype.enqueue.call(this,t);i&&t[0].addEventListener(f.CHANGE,this.boundHandleTileChange_);return i},t.prototype.getTilesLoading=function(){return this.tilesLoading_},t.prototype.handleTileChange=function(e){var t=e.target,i=t.getState();if(t.hifi&&i===fa.LOADED||i===fa.ERROR||i===fa.EMPTY){t.removeEventListener(f.CHANGE,this.boundHandleTileChange_);var n=t.getKey();n in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[n],--this.tilesLoading_),this.tileChangeCallback_()}},t.prototype.loadMoreTiles=function(e,t){for(var i,n,r=0;this.tilesLoading_<e&&r<t&&this.getCount()>0;)n=(i=this.dequeue()[0]).getKey(),i.getState()!==fa.IDLE||n in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[n]=!0,++this.tilesLoading_,++r,i.load())},t}(Km);Wc.default=ri;var Ha={};var Gd={},Mm=42;Gd.DEFAULT_MAX_ZOOM=Mm;var si=256;Gd.DEFAULT_TILE_SIZE=si;function ti(t,$,e){return function(r,a,o,n){if(r){var f=$?0:o[0]*a,x=$?0:o[1]*a,E=t[0]+f/2,p=t[2]-f/2,B=t[1]+x/2,P=t[3]-x/2;E>p&&(p=E=(p+E)/2),B>P&&(P=B=(P+B)/2);var c=F(r[0],E,p),h=F(r[1],B,P),m=30*a;return n&&e&&(c+=-m*Math.log(1+Math.max(0,E-r[0])/m)+m*Math.log(1+Math.max(0,r[0]-p)/m),h+=-m*Math.log(1+Math.max(0,B-r[1])/m)+m*Math.log(1+Math.max(0,r[1]-P)/m)),[c,h]}}}function Nm(t){return t}var ia={};function F(r,e,t){return Math.min(Math.max(r,e),t)}ia.clamp=F;var ui="cosh"in Math?Math.cosh:function(r){var e=Math.exp(r);return(e+1/e)/2};function vi(r,e,t,$,o,a){var n=o-t,s=a-$;if(0!==n||0!==s){var p=((r-t)*n+(e-$)*s)/(n*n+s*s);p>1?(t=o,$=a):p>0&&(t+=n*p,$+=s*p)}return ab(r,e,t,$)}function ab(r,e,t,$){var o=t-r,a=$-e;return o*o+a*a}function Om(r){for(var e=r.length,t=0;t<e;t++){for(var $=t,o=Math.abs(r[t][t]),a=t+1;a<e;a++){var n=Math.abs(r[a][t]);n>o&&(o=n,$=a)}if(0===o)return null;var s=r[$];r[$]=r[t],r[t]=s;for(var p=t+1;p<e;p++)for(var q=-r[p][t]/r[t][t],x=t;x<e+1;x++)t==x?r[p][x]=0:r[p][x]+=q*r[t][x]}for(var u=new Array(e),A=e-1;A>=0;A--){u[A]=r[A][e]/r[A][A];for(var K=A-1;K>=0;K--)r[K][e]-=r[K][A]*u[A]}return u}function sf(r){return 180*r/Math.PI}function ja(r){return r*Math.PI/180}function $b(r,e){var t=r%e;return t*e<0?t+e:t}function wb(r,e,t){return r+t*(e-r)}ia.cosh=ui,ia.squaredSegmentDistance=vi,ia.squaredDistance=ab,ia.solveLinearSystem=Om,ia.toDegrees=sf,ia.toRadians=ja,ia.modulo=$b,ia.lerp=wb;function tf(t,e,o,r){var a=ka(e)/o[0],$=Ja(e)/o[1];return r?Math.min(t,Math.max(a,$)):Math.min(t,Math.min(a,$))}function uf(t,e,o){var r=Math.min(t,e);return r*=Math.log(1+50*Math.max(0,t/e-1))/50+1,o&&(r=Math.max(r,o),r/=Math.log(1+50*Math.max(0,o/t-1))/50+1),F(r,o/2,2*e)}function Pm(t,e,o,r){return function(a,$,u,i){if(void 0!==a){var n=t[0],x=t[t.length-1],p=o?tf(n,o,u,r):n;if(i)return void 0===e||e?uf(a,p,x):F(a,x,p);var l=Math.min(p,a),m=Math.floor(gf(t,l,$));return t[m]>p&&m<t.length-1?t[m+1]:t[m]}}}function Qm(t,e,o,r,a,$){return function(u,i,n,x){if(void 0!==u){var p=a?tf(e,a,n,$):e,l=void 0!==o?o:0;if(x)return void 0===r||r?uf(u,p,l):F(u,l,p);var m=Math.ceil(Math.log(e/p)/Math.log(t)-1e-9),h=-i*(.5-1e-9)+.5,O=Math.min(p,u),M=Math.floor(Math.log(e/O)/Math.log(t)+h),c=Math.max(m,M),s=e/Math.pow(t,c);return F(s,l,p)}}}function wi(t,e,o,r,a){return function($,u,i,n){if(void 0!==$){var x=r?tf(t,r,i,a):t;return(void 0===o||o)&&n?uf($,x,e):F($,e,x)}}}var g={};function D(t){for(var e=da(),$=0,r=t.length;$<r;++$)Jd(e,t[$]);return e}function Rm(t,e,$){return Ia(Math.min.apply(null,t),Math.min.apply(null,e),Math.max.apply(null,t),Math.max.apply(null,e),$)}function _b(t,e,$){return $?($[0]=t[0]-e,$[1]=t[1]-e,$[2]=t[2]+e,$[3]=t[3]+e,$):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]}function vf(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()}function bb(t,e,$){var r,o;return(r=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0)*r+(o=$<t[1]?t[1]-$:t[3]<$?$-t[3]:0)*o}function Sm(t,e){return Hd(t,e[0],e[1])}function ra(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]}function Hd(t,e,$){return t[0]<=e&&e<=t[2]&&t[1]<=$&&$<=t[3]}function Id(t,e){var $=t[0],r=t[1],o=t[2],n=t[3],p=e[0],i=e[1],a=J.UNKNOWN;return p<$?a|=J.LEFT:p>o&&(a|=J.RIGHT),i<r?a|=J.BELOW:i>n&&(a|=J.ABOVE),a===J.UNKNOWN&&(a=J.INTERSECTING),a}function da(){return[1/0,1/0,-1/0,-1/0]}function Ia(t,e,$,r,o){return o?(o[0]=t,o[1]=e,o[2]=$,o[3]=r,o):[t,e,$,r]}function cb(t){return Ia(1/0,1/0,-1/0,-1/0,t)}function Xc(t,e){var $=t[0],r=t[1];return Ia($,r,$,r,e)}function xi(t,e){return yf(cb(e),t)}function wf(t,e,$,r,o){return zf(cb(o),t,e,$,r)}function Tm(t,e){return yi(cb(e),t)}function db(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]}function xf(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t}function Jd(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function yf(t,e){for(var $=0,r=e.length;$<r;++$)Jd(t,e[$]);return t}function zf(t,e,$,r,o){for(;$<r;$+=o)zi(t,e[$],e[$+1]);return t}function yi(t,e){for(var $=0,r=e.length;$<r;++$)yf(t,e[$]);return t}function zi(t,e,$){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],$),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],$)}function Af(t,e){var $;return($=e(eb(t)))?$:($=e(xb(t)))?$:($=e(yb(t)))?$:($=e(fb(t)))||!1}function Bf(t){var e=0;return Ld(t)||(e=ka(t)*Ja(t)),e}function eb(t){return[t[0],t[1]]}function xb(t){return[t[2],t[1]]}function ac(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]}function Um(t,e){var $;return e===Yc.BOTTOM_LEFT?$=eb(t):e===Yc.BOTTOM_RIGHT?$=xb(t):e===Yc.TOP_LEFT?$=fb(t):e===Yc.TOP_RIGHT?$=yb(t):q(!1,13),$}function Vm(t,e){var $=Math.min(t[0],e[0]),r=Math.min(t[1],e[1]);return(Math.max(t[2],e[2])-$)*(Math.max(t[3],e[3])-r)}function Cf(t,e,$,r,o){var n=e*r[0]/2,p=e*r[1]/2,i=Math.cos($),a=Math.sin($),L=n*i,x=n*a,V=p*i,w=p*a,s=t[0],c=t[1],u=s-L+w,d=s-L-w,g=s+L-w,m=s+L+w,f=c-x-V,h=c-x+V,l=c+x+V,R=c+x-V;return Ia(Math.min(u,d,g,m),Math.min(f,h,l,R),Math.max(u,d,g,m),Math.max(f,h,l,R),o)}function Ja(t){return t[3]-t[1]}function Wm(t,e){return Bf(Kd(t,e))}function Kd(t,e,$){var r=$||da();return ea(t,e)?(t[0]>e[0]?r[0]=t[0]:r[0]=e[0],t[1]>e[1]?r[1]=t[1]:r[1]=e[1],t[2]<e[2]?r[2]=t[2]:r[2]=e[2],t[3]<e[3]?r[3]=t[3]:r[3]=e[3]):cb(r),r}function Xm(t){return ka(t)+Ja(t)}function Ym(t){return[t[2]-t[0],t[3]-t[1]]}function fb(t){return[t[0],t[3]]}function yb(t){return[t[2],t[3]]}function ka(t){return t[2]-t[0]}function ea(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]}function Ld(t){return t[2]<t[0]||t[3]<t[1]}function Ai(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t}function Df(t,e){var $=(t[2]-t[0])/2*(e-1),r=(t[3]-t[1])/2*(e-1);t[0]-=$,t[2]+=$,t[1]-=r,t[3]+=r}function Bi(t,e,$){var r=!1,o=Id(t,e),n=Id(t,$);if(o===J.INTERSECTING||n===J.INTERSECTING)r=!0;else{var p=t[0],i=t[1],a=t[2],L=t[3],x=e[0],V=e[1],w=$[0],s=$[1],c=(s-V)/(w-x),u=void 0,d=void 0;n&J.ABOVE&&!(o&J.ABOVE)&&(r=(u=w-(s-L)/c)>=p&&u<=a),r||!(n&J.RIGHT)||o&J.RIGHT||(r=(d=s-(w-a)*c)>=i&&d<=L),r||!(n&J.BELOW)||o&J.BELOW||(r=(u=w-(s-i)/c)>=p&&u<=a),r||!(n&J.LEFT)||o&J.LEFT||(r=(d=s-(w-p)*c)>=i&&d<=L)}return r}function Ci(t,e,$,r){var o=[];if(r>1)for(var n=t[2]-t[0],p=t[3]-t[1],i=0;i<r;++i)o.push(t[0]+n*i/r,t[1],t[2],t[1]+p*i/r,t[2]-n*i/r,t[3],t[0],t[3]-p*i/r);else o=[t[0],t[1],t[2],t[1],t[2],t[3],t[0],t[3]];e(o,o,2);for(var a=[],L=[],x=(i=0,o.length);i<x;i+=2)a.push(o[i]),L.push(o[i+1]);return Rm(a,L,$)}var Ef={},Yc={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"};Ef.default=Yc;var J={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};g.boundingExtent=D,g.buffer=_b,g.clone=vf,g.closestSquaredDistanceXY=bb,g.containsCoordinate=Sm,g.containsExtent=ra,g.containsXY=Hd,g.coordinateRelationship=Id,g.createEmpty=da,g.createOrUpdate=Ia,g.createOrUpdateEmpty=cb,g.createOrUpdateFromCoordinate=Xc,g.createOrUpdateFromCoordinates=xi,g.createOrUpdateFromFlatCoordinates=wf,g.createOrUpdateFromRings=Tm,g.equals=db,g.extend=xf,g.extendCoordinate=Jd,g.extendCoordinates=yf,g.extendFlatCoordinates=zf,g.extendRings=yi,g.extendXY=zi,g.forEachCorner=Af,g.getArea=Bf,g.getBottomLeft=eb,g.getBottomRight=xb,g.getCenter=ac,g.getCorner=Um,g.getEnlargedArea=Vm,g.getForViewAndSize=Cf,g.getHeight=Ja,g.getIntersectionArea=Wm,g.getIntersection=Kd,g.getMargin=Xm,g.getSize=Ym,g.getTopLeft=fb,g.getTopRight=yb,g.getWidth=ka,g.intersects=ea,g.isEmpty=Ld,g.returnOrUpdate=Ai,g.scaleFromCenter=Df,g.intersectsSegment=Bi,g.applyTransform=Ci;function Ff(e){return void 0!==e?0:void 0}function Di(e){return void 0!==e?e:void 0}function Zm(e){var o=2*Math.PI/e;return function(e,r){return r?e:void 0!==e?e=Math.floor(e/o+.5)*o:void 0}}function $m(e){var o=e||ja(5);return function(e,r){return r?e:void 0!==e?Math.abs(e)<=o?0:e:void 0}}var H={ANIMATING:0,INTERACTING:1};var Y={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};var t={};function Ei(t,e){return t[0]+=+e[0],t[1]+=+e[1],t}function Fi(t,e){var r=e.getRadius(),$=e.getCenter(),o=$[0],n=$[1],M=t[0]-o,s=t[1]-n;0===M&&0===s&&(M=1);var a=Math.sqrt(M*M+s*s);return[o+r*M/a,n+r*s/a]}function Zc(t,e){var r,$,o=t[0],n=t[1],M=e[0],s=e[1],a=M[0],O=M[1],p=s[0],C=s[1],i=p-a,x=C-O,c=0===i&&0===x?0:(i*(o-a)+x*(n-O))/(i*i+x*x||0);return c<=0?(r=a,$=O):c>=1?(r=p,$=C):(r=a+c*i,$=O+c*x),[r,$]}function _m(t){return function(e){return Ii(e,t)}}function Gf(t,e,r){var $=$b(e+180,360)-180,o=Math.abs(3600*$),n=r||0,M=Math.pow(10,n),s=Math.floor(o/3600),a=Math.floor((o-3600*s)/60),O=o-3600*s-60*a;return(O=Math.ceil(O*M)/M)>=60&&(O=0,a+=1),a>=60&&(a=0,s+=1),s+"\xB0 "+Hf(a,2)+"\u2032 "+Hf(O,2,n)+"\u2033"+(0==$?"":" "+t.charAt($<0?1:0))}function Gi(t,e,r){return t?e.replace("{x}",t[0].toFixed(r)).replace("{y}",t[1].toFixed(r)):""}function la(t,e){for(var r=!0,$=t.length-1;$>=0;--$)if(t[$]!=e[$]){r=!1;break}return r}function Md(t,e){var r=Math.cos(e),$=Math.sin(e),o=t[0]*r-t[1]*$,n=t[1]*r+t[0]*$;return t[0]=o,t[1]=n,t}function Hi(t,e){return t[0]*=e,t[1]*=e,t}function U(t,e){var r=t[0]-e[0],$=t[1]-e[1];return r*r+$*$}function $c(t,e){return Math.sqrt(U(t,e))}function _c(t,e){return U(t,Zc(t,e))}function an(t,e){return t?Gf("NS",t[1],e)+" "+Gf("EW",t[0],e):""}function Ii(t,e){return Gi(t,"{x}, {y}",e)}var Nd={};function Hf(r,e,n){var t=void 0!==n?r.toFixed(n):""+r,s=t.indexOf(".");return(s=-1===s?t.length:s)>e?t:new Array(1+e-s).join("0")+t}function bn(r,e){for(var n=(""+r).split("."),t=(""+e).split("."),s=0;s<Math.max(n.length,t.length);s++){var o=parseInt(n[s]||"0",10),$=parseInt(t[s]||"0",10);if(o>$)return 1;if($>o)return-1}return 0}Nd.padNumber=Hf,Nd.compareVersions=bn;t.add=Ei,t.closestOnCircle=Fi,t.closestOnSegment=Zc,t.createStringXY=_m,t.degreesToStringHDMS=Gf,t.format=Gi,t.equals=la,t.rotate=Md,t.scale=Hi,t.squaredDistance=U,t.distance=$c,t.squaredDistanceToSegment=_c,t.toStringHDMS=an,t.toStringXY=Ii;var zb={};function Ji($){return Math.pow($,3)}function gb($){return 1-Ji(1-$)}function Od($){return 3*$*$-2*$*$*$}function Ki($){return $}function cn($){return $<.5?Od(2*$):1-Od(2*($-.5))}zb.easeIn=Ji,zb.easeOut=gb,zb.inAndOut=Od,zb.linear=Ki,zb.upAndDown=cn;var If={},k={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"};If.default=k;var Ka={};var Jf={},l={XY:"XY",XYZ:"XYZ",XYM:"XYM",XYZM:"XYZM"};Jf.default=l;var Kf={};var ad={};var Lf={};function Ab(r,t,e,$,o,a){for(var n=a||[],v=0,s=t;s<e;s+=$){var f=r[s],l=r[s+1];n[v++]=o[0]*f+o[2]*l+o[4],n[v++]=o[1]*f+o[3]*l+o[5]}return a&&n.length!=v&&(n.length=v),n}function Li(r,t,e,$,o,a,n){for(var v=n||[],s=Math.cos(o),f=Math.sin(o),l=a[0],b=a[1],j=0,p=t;p<e;p+=$){var x=r[p]-l,h=r[p+1]-b;v[j++]=l+x*s-h*f,v[j++]=b+x*f+h*s;for(var c=p+2;c<p+$;++c)v[j++]=r[c]}return n&&v.length!=j&&(v.length=j),v}function dn(r,t,e,$,o,a,n,v){for(var s=v||[],f=n[0],l=n[1],b=0,j=t;j<e;j+=$){var p=r[j]-f,x=r[j+1]-l;s[b++]=f+o*p,s[b++]=l+a*x;for(var h=j+2;h<j+$;++h)s[b++]=r[h]}return v&&s.length!=b&&(s.length=b),s}function Mi(r,t,e,$,o,a,n){for(var v=n||[],s=0,f=t;f<e;f+=$){v[s++]=r[f]+o,v[s++]=r[f+1]+a;for(var l=f+2;l<f+$;++l)v[s++]=r[l]}return n&&v.length!=s&&(v.length=s),v}var i={};function Pd(r,o,$){var t;if(void 0!==o){for(var e=0,c=r.length;e<c;++e)o[e]=r[e];t=o}else t=r.slice();return t}function Mf(r,o,$){if(void 0!==o&&r!==o){for(var t=0,e=r.length;t<e;++t)o[t]=r[t];r=o}return r}function Ni(r){tn(r.getCode(),r),dc(r,r,Pd)}function Oi(r){r.forEach(Ni)}function E(r){return"string"==typeof r?sn(r):r||null}function Pi(r,o,$,t){var e,c=(r=E(r)).getPointResolutionFunc();if(c)e=c(o,$),t&&t!==r.getUnits()&&(n=r.getMetersPerUnit())&&(e=e*n/ma[t]);else if(r.getUnits()==O.DEGREES&&!t||t==O.DEGREES)e=o;else{var n,s=La(r,E("EPSG:4326")),i=[$[0]-o/2,$[1],$[0]+o/2,$[1],$[0],$[1]-o/2,$[0],$[1]+o/2];i=s(i,i,2),e=(Qf(i.slice(0,2),i.slice(2,4))+Qf(i.slice(4,6),i.slice(6,8)))/2,void 0!==(n=t?ma[t]:r.getMetersPerUnit())&&(e/=n)}return e}function Nf(r){Oi(r),r.forEach(function(o){r.forEach(function(r){o!==r&&dc(o,r,Pd)})})}function Qi(r,o,$,t){r.forEach(function(r){o.forEach(function(o){dc(r,o,$),dc(o,r,t)})})}function en(){rn(),pn()}function Qd(r,o){return r?"string"==typeof r?E(r):r:E(o)}function Of(r){return function(o,$,t){for(var e=o.length,c=void 0!==t?t:2,n=void 0!==$?$:new Array(e),s=0;s<e;s+=c){var i=r([o[s],o[s+1]]);n[s]=i[0],n[s+1]=i[1];for(var a=c-1;a>=2;--a)n[s+a]=o[s+a]}return n}}function fn(r,o,$,t){var e=E(r),c=E(o);dc(e,c,Of($)),dc(c,e,Of(t))}function gn(r,o){return cd(r,"EPSG:4326",void 0!==o?o:"EPSG:3857")}function hn(r,o){var $=cd(r,void 0!==o?o:"EPSG:3857","EPSG:4326"),t=$[0];return(t<-180||t>180)&&($[0]=$b(t+180,360)-180),$}function Ri(r,o){if(r===o)return!0;var $=r.getUnits()===o.getUnits();return r.getCode()===o.getCode()?$:La(r,o)===Pd&&$}function La(r,o){var $=r.getCode(),t=o.getCode(),e=qn($,t);return e||(e=Mf),e}function bd(r,o){return La(E(r),E(o))}function cd(r,o,$){return bd(o,$)(r,void 0,r.length)}function Pf(r,o,$,t){var e=bd(o,$);return Ci(r,e,void 0,t)}function jn(r,o,$){return La(o,$)(r)}var Rd=6371008.8;function Qf(e,t,r){var $=r||Rd,a=ja(e[1]),o=ja(t[1]),T=(o-a)/2,n=ja(t[0]-e[0])/2,A=Math.sin(T)*Math.sin(T)+Math.sin(n)*Math.sin(n)*Math.cos(a)*Math.cos(o);return 2*$*Math.atan2(Math.sqrt(A),Math.sqrt(1-A))}function Rf(e,t){for(var r=0,$=0,a=e.length;$<a-1;++$)r+=Qf(e[$],e[$+1],t);return r}function kn(e,t){var r=t||{},$=r.radius||Rd,a=r.projection||"EPSG:3857",o=e.getType();o!==k.GEOMETRY_COLLECTION&&(e=e.clone().transform(a,"EPSG:4326"));var T,n,A,x,p,s,d=0;switch(o){case k.POINT:case k.MULTI_POINT:break;case k.LINE_STRING:case k.LINEAR_RING:d=Rf(T=e.getCoordinates(),$);break;case k.MULTI_LINE_STRING:case k.POLYGON:for(A=0,x=(T=e.getCoordinates()).length;A<x;++A)d+=Rf(T[A],$);break;case k.MULTI_POLYGON:for(A=0,x=(T=e.getCoordinates()).length;A<x;++A)for(p=0,s=(n=T[A]).length;p<s;++p)d+=Rf(n[p],$);break;case k.GEOMETRY_COLLECTION:var i=e.getGeometries();for(A=0,x=i.length;A<x;++A)d+=kn(i[A],t);break;default:throw new Error("Unsupported geometry type: "+o);}return d}function Sd(e,t){for(var r=0,$=e.length,a=e[$-1][0],o=e[$-1][1],T=0;T<$;T++){var n=e[T][0],A=e[T][1];r+=ja(n-a)*(2+Math.sin(ja(o))+Math.sin(ja(A))),a=n,o=A}return r*t*t/2}function ln(e,t){var r=t||{},$=r.radius||Rd,a=r.projection||"EPSG:3857",o=e.getType();o!==k.GEOMETRY_COLLECTION&&(e=e.clone().transform(a,"EPSG:4326"));var T,n,A,x,p,s,d=0;switch(o){case k.POINT:case k.MULTI_POINT:case k.LINE_STRING:case k.MULTI_LINE_STRING:case k.LINEAR_RING:break;case k.POLYGON:for(T=e.getCoordinates(),d=Math.abs(Sd(T[0],$)),A=1,x=T.length;A<x;++A)d-=Math.abs(Sd(T[A],$));break;case k.MULTI_POLYGON:for(A=0,x=(T=e.getCoordinates()).length;A<x;++A)for(n=T[A],d+=Math.abs(Sd(n[0],$)),p=1,s=n.length;p<s;++p)d-=Math.abs(Sd(n[p],$));break;case k.GEOMETRY_COLLECTION:var i=e.getGeometries();for(A=0,x=i.length;A<x;++A)d+=ln(i[A],t);break;default:throw new Error("Unsupported geometry type: "+o);}return d}function mn(e,t,r,$){var a=$||Rd,o=ja(e[1]),T=ja(e[0]),n=t/a,A=Math.asin(Math.sin(o)*Math.cos(n)+Math.cos(o)*Math.sin(n)*Math.cos(r)),x=T+Math.atan2(Math.sin(r)*Math.sin(n)*Math.cos(o),Math.cos(n)-Math.sin(o)*Math.sin(A));return[sf(x),sf(A)]}var Ma={};var Kt=arguments[0];var Td={},O={DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"},ma={};Td.METERS_PER_UNIT=ma,ma[O.DEGREES]=2*Math.PI*6370997/360,ma[O.FEET]=.3048,ma[O.METERS]=1,ma[O.USFEET]=1200/3937,Td.default=O;var Sf=function(){function t(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}return t.prototype.canWrapX=function(){return this.canWrapX_},t.prototype.getCode=function(){return this.code_},t.prototype.getExtent=function(){return this.extent_},t.prototype.getUnits=function(){return this.units_},t.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||ma[this.units_]},t.prototype.getWorldExtent=function(){return this.worldExtent_},t.prototype.getAxisOrientation=function(){return this.axisOrientation_},t.prototype.isGlobal=function(){return this.global_},t.prototype.setGlobal=function(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)},t.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},t.prototype.setDefaultTileGrid=function(t){this.defaultTileGrid_=t},t.prototype.setExtent=function(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)},t.prototype.setWorldExtent=function(t){this.worldExtent_=t},t.prototype.setGetPointResolution=function(t){this.getPointResolutionFunc_=t},t.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_},t}();var nn=Ma&&Ma.__extends||function(){var $=function(n,r){return($=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function($,n){$.__proto__=n}||function($,n){for(var r in n)n.hasOwnProperty(r)&&($[r]=n[r])})(n,r)};return function(n,r){function t(){this.constructor=n}$(n,r),n.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)}}(),dd=6378137;Ma.RADIUS=dd;var Bb=Math.PI*dd;Ma.HALF_SIZE=Bb;var Si=[-Bb,-Bb,Bb,Bb];Ma.EXTENT=Si;var Ti=[-180,-85,180,85];Ma.WORLD_EXTENT=Ti;var Cb=function($){function n(n){return $.call(this,{code:n,units:O.METERS,extent:Si,global:!0,worldExtent:Ti,getPointResolution:function($,n){return $/ui(n[1]/dd)}})||this}return nn(n,$),n}(Sf),Tf=[new Cb("EPSG:3857"),new Cb("EPSG:102100"),new Cb("EPSG:102113"),new Cb("EPSG:900913"),new Cb("urn:ogc:def:crs:EPSG:6.18:3:3857"),new Cb("urn:ogc:def:crs:EPSG::3857"),new Cb("http://www.opengis.net/gml/srs/epsg.xml#3857")];function Ui($,n,r){var t=$.length,o=r>1?r:2,e=n;void 0===e&&(e=o>2?$.slice():new Array(t));for(var m=Bb,Z=0;Z<t;Z+=o){e[Z]=m*$[Z]/180;var p=dd*Math.log(Math.tan(Math.PI*(+$[Z+1]+90)/360));p>m?p=m:p<-m&&(p=-m),e[Z+1]=p}return e}function Vi($,n,r){var t=$.length,o=r>1?r:2,e=n;void 0===e&&(e=o>2?$.slice():new Array(t));for(var m=0;m<t;m+=o)e[m]=180*$[m]/Bb,e[m+1]=360*Math.atan(Math.exp($[m+1]/dd))/Math.PI-90;return e}Ma.PROJECTIONS=Tf,Ma.fromEPSG4326=Ui,Ma.toEPSG4326=Vi;var bc={};var on=bc&&bc.__extends||function(){var t=function(r,$){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var $ in r)r.hasOwnProperty($)&&(t[$]=r[$])})(r,$)};return function(r,$){function e(){this.constructor=r}t(r,$),r.prototype=null===$?Object.create($):(e.prototype=$.prototype,new e)}}(),Wi=6378137;bc.RADIUS=Wi;var Uf=[-180,-90,180,90];bc.EXTENT=Uf;var Xi=Math.PI*Wi/180;bc.METERS_PER_UNIT=Xi;var hb=function(t){function r(r,$){return t.call(this,{code:r,units:O.DEGREES,extent:Uf,axisOrientation:$,global:!0,metersPerUnit:Xi,worldExtent:Uf})||this}return on(r,t),r}(Sf),Vf=[new hb("CRS:84"),new hb("EPSG:4326","neu"),new hb("urn:ogc:def:crs:EPSG::4326","neu"),new hb("urn:ogc:def:crs:EPSG:6.6:4326","neu"),new hb("urn:ogc:def:crs:OGC:1.3:CRS84"),new hb("urn:ogc:def:crs:OGC:2:84"),new hb("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new hb("urn:x-ogc:def:crs:EPSG:4326","neu")];bc.PROJECTIONS=Vf;var cc={};function pn(){cc={}}function dc($,t,r){var e=$.getCode(),o=t.getCode();e in cc||(cc[e]={}),cc[e][o]=r}function qn($,t){var r;return $ in cc&&t in cc[$]&&(r=cc[$][t]),r}var Yi={};function rn(){Yi={}}function sn($){return Yi[$]||null}function tn($,t){Yi[$]=t}i.METERS_PER_UNIT=ma,i.Projection=Sf,i.cloneTransform=Pd,i.identityTransform=Mf,i.addProjection=Ni,i.addProjections=Oi,i.get=E,i.getPointResolution=Pi,i.addEquivalentProjections=Nf,i.addEquivalentTransforms=Qi,i.clearAllProjections=en,i.createProjection=Qd,i.createTransformFromCoordinateTransform=Of,i.addCoordinateTransforms=fn,i.fromLonLat=gn,i.toLonLat=hn,i.equivalent=Ri,i.getTransformFromProjections=La,i.getTransform=bd,i.transform=cd,i.transformExtent=Pf,i.transformWithProjections=jn;var Na=null;function Zi(r){Na=E(r)}function un(){Na=null}function ib(){return Na}function vn(){Zi("EPSG:4326")}function ec(r,o){return Na?cd(r,o,Na):r}function w(r,o){return Na?cd(r,Na,o):r}function fc(r,o){return Na?Pf(r,o,Na):r}function Oa(r,o){return Na?Pf(r,Na,o):r}function $i(){Nf(Tf),Nf(Vf),Qi(Vf,Tf,Ui,Vi)}i.setUserProjection=Zi,i.clearUserProjection=un,i.getUserProjection=ib,i.useGeographic=vn,i.toUserCoordinate=ec,i.fromUserCoordinate=w,i.toUserExtent=fc,i.fromUserExtent=Oa,i.addCommon=$i,$i();var o={};var Wf=new Array(6);function G(){return[1,0,0,1,0,0]}function Ud($){return hc($,1,0,0,1,0,0)}function gc($,t){var r=$[0],e=$[1],n=$[2],o=$[3],p=$[4],D=$[5],L=t[0],s=t[1],x=t[2],a=t[3],i=t[4],u=t[5];return $[0]=r*L+n*s,$[1]=e*L+o*s,$[2]=r*x+n*a,$[3]=e*x+o*a,$[4]=r*i+n*u+p,$[5]=e*i+o*u+D,$}function hc($,t,r,e,n,o,p){return $[0]=t,$[1]=r,$[2]=e,$[3]=n,$[4]=o,$[5]=p,$}function _i($,t){return $[0]=t[0],$[1]=t[1],$[2]=t[2],$[3]=t[3],$[4]=t[4],$[5]=t[5],$}function ca($,t){var r=t[0],e=t[1];return t[0]=$[0]*r+$[2]*e+$[4],t[1]=$[1]*r+$[3]*e+$[5],t}function aj($,t){var r=Math.cos(t),e=Math.sin(t);return gc($,hc(Wf,r,e,-e,r,0,0))}function Xf($,t,r){return gc($,hc(Wf,t,0,0,r,0,0))}function bj($,t,r){return hc($,t,0,0,r,0,0)}function wn($,t,r){return gc($,hc(Wf,1,0,0,1,t,r))}function ga($,t,r,e,n,o,p,D){var L=Math.sin(o),s=Math.cos(o);return $[0]=e*s,$[1]=n*L,$[2]=-e*L,$[3]=n*s,$[4]=p*e*s-D*e*L+t,$[5]=p*n*L+D*n*s+r,$}function cj($,t,r,e,n,o,p){return Vd(ga(G(),$,t,r,e,n,o,p))}function xn($){return ic($,$)}function ic($,t){var r=dj(t);q(0!==r,32);var e=t[0],n=t[1],o=t[2],p=t[3],D=t[4],L=t[5];return $[0]=p/r,$[1]=-n/r,$[2]=-o/r,$[3]=e/r,$[4]=(o*L-p*D)/r,$[5]=-(e*L-n*D)/r,$}function dj($){return $[0]*$[3]-$[1]*$[2]}function Vd($){return"matrix("+$.join(", ")+")"}o.create=G,o.reset=Ud,o.multiply=gc,o.set=hc,o.setFromArray=_i,o.apply=ca,o.rotate=aj,o.scale=Xf,o.makeScale=bj,o.translate=wn,o.compose=ga,o.composeCssTransform=cj,o.invert=xn,o.makeInverse=ic,o.determinant=dj,o.toString=Vd;var yn=Lf&&Lf.__extends||function(){var t=function(r,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])})(r,e)};return function(r,e){function n(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}(),ej=G(),Yf=function(t){function r(){var r=t.call(this)||this;return r.extent_=da(),r.extentRevision_=-1,r.simplifiedGeometryMaxMinSquaredTolerance=0,r.simplifiedGeometryRevision=0,r.simplifyTransformedInternal=sm(function(t,r,e){if(!e)return this.getSimplifiedGeometry(r);var n=this.clone();return n.applyTransform(e),n.getSimplifiedGeometry(r)}),r}return yn(r,t),r.prototype.simplifyTransformed=function(t,r){return this.simplifyTransformedInternal(this.getRevision(),t,r)},r.prototype.clone=function(){return h()},r.prototype.closestPointXY=function(t,r,e,n){return h()},r.prototype.containsXY=function(t,r){var e=this.getClosestPoint([t,r]);return e[0]===t&&e[1]===r},r.prototype.getClosestPoint=function(t,r){var e=r||[NaN,NaN];return this.closestPointXY(t[0],t[1],e,1/0),e},r.prototype.intersectsCoordinate=function(t){return this.containsXY(t[0],t[1])},r.prototype.computeExtent=function(t){return h()},r.prototype.getExtent=function(t){return this.extentRevision_!=this.getRevision()&&(this.extent_=this.computeExtent(this.extent_),this.extentRevision_=this.getRevision()),Ai(this.extent_,t)},r.prototype.rotate=function(t,r){h()},r.prototype.scale=function(t,r,e){h()},r.prototype.simplify=function(t){return this.getSimplifiedGeometry(t*t)},r.prototype.getSimplifiedGeometry=function(t){return h()},r.prototype.getType=function(){return h()},r.prototype.applyTransform=function(t){h()},r.prototype.intersectsExtent=function(t){return h()},r.prototype.translate=function(t,r){h()},r.prototype.transform=function(t,r){var e=E(t),n=e.getUnits()==O.TILE_PIXELS?function(t,n,o){var i=e.getExtent(),$=e.getWorldExtent(),p=Ja($)/Ja(i);return ga(ej,$[0],$[3],p,-p,0,0,0),Ab(t,0,t.length,o,ej,n),bd(e,r)(t,n,o)}:bd(e,r);return this.applyTransform(n),this},r}(X);Lf.default=Yf;var zn=ad&&ad.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),Pa=function(t){function e(){var e=t.call(this)||this;return e.layout=l.XY,e.stride=2,e.flatCoordinates=null,e}return zn(e,t),e.prototype.computeExtent=function(t){return wf(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinates=function(){return h()},e.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.getFlatCoordinates=function(){return this.flatCoordinates},e.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},e.prototype.getLayout=function(){return this.layout},e.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)},e.prototype.getSimplifiedGeometryInternal=function(t){return this},e.prototype.getStride=function(){return this.stride},e.prototype.setFlatCoordinates=function(t,e){this.stride=Zf(t),this.layout=t,this.flatCoordinates=e},e.prototype.setCoordinates=function(t,e){h()},e.prototype.setLayout=function(t,e,r){var o;if(t)o=Zf(t);else{for(var i=0;i<r;++i){if(0===e.length)return this.layout=l.XY,void(this.stride=2);e=e[0]}t=An(o=e.length)}this.layout=t,this.stride=o},e.prototype.applyTransform=function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},e.prototype.rotate=function(t,e){var r=this.getFlatCoordinates();if(r){var o=this.getStride();Li(r,0,r.length,o,t,e,r),this.changed()}},e.prototype.scale=function(t,e,r){var o=e;void 0===o&&(o=t);var i=r;i||(i=ac(this.getExtent()));var n=this.getFlatCoordinates();if(n){var a=this.getStride();dn(n,0,n.length,a,t,o,i,n),this.changed()}},e.prototype.translate=function(t,e){var r=this.getFlatCoordinates();if(r){var o=this.getStride();Mi(r,0,r.length,o,t,e,r),this.changed()}},e}(Yf);function An(t){var e;return 2==t?e=l.XY:3==t?e=l.XYZ:4==t&&(e=l.XYZM),e}function Zf(t){var e;return t==l.XY?e=2:t==l.XYZ||t==l.XYM?e=3:t==l.XYZM&&(e=4),e}function fj(t,e,r){var o=t.getFlatCoordinates();if(o){var i=t.getStride();return Ab(o,0,o.length,i,e,r)}return null}ad.getStrideForLayout=Zf,ad.transformGeom2D=fj,ad.default=Pa;function gj(e,r,n,$){for(var i=0,t=e[n-$],a=e[n-$+1];r<n;r+=$){var o=e[r],g=e[r+1];i+=a*o-t*g,t=o,a=g}return i/2}function hj(e,r,n,$){for(var i=0,t=0,a=n.length;t<a;++t){var o=n[t];i+=gj(e,r,o,$),r=o}return i}function Bn(e,r,n,$){for(var i=0,t=0,a=n.length;t<a;++t){var o=n[t];i+=hj(e,r,o,$),r=o[o.length-1]}return i}function ij(r,t,a,e,$,h,s){var o,n=r[t],i=r[t+1],l=r[a]-n,u=r[a+1]-i;if(0===l&&0===u)o=t;else{var x=(($-n)*l+(h-i)*u)/(l*l+u*u);if(x>1)o=a;else{if(x>0){for(var w=0;w<e;++w)s[w]=wb(r[t+w],r[a+w],x);return void(s.length=e)}o=t}}for(w=0;w<e;++w)s[w]=r[o+w];s.length=e}function $f(r,t,a,e,$){var h=r[t],s=r[t+1];for(t+=e;t<a;t+=e){var o=r[t],n=r[t+1],i=ab(h,s,o,n);i>$&&($=i),h=o,s=n}return $}function _f(r,t,a,e,$){for(var h=0,s=a.length;h<s;++h){var o=a[h];$=$f(r,t,o,e,$),t=o}return $}function Cn(r,t,a,e,$){for(var h=0,s=a.length;h<s;++h){var o=a[h];$=_f(r,t,o,e,$),t=o[o.length-1]}return $}function ag(r,t,a,e,$,h,s,o,n,i,l){if(t==a)return i;var u,x;if(0===$){if((x=ab(s,o,r[t],r[t+1]))<i){for(u=0;u<e;++u)n[u]=r[t+u];return n.length=e,x}return i}for(var w=l||[NaN,NaN],B=t+e;B<a;)if(ij(r,B-e,B,e,s,o,w),(x=ab(s,o,w[0],w[1]))<i){for(i=x,u=0;u<e;++u)n[u]=w[u];n.length=e,B+=e}else B+=e*Math.max((Math.sqrt(x)-Math.sqrt(i))/$|0,1);if(h&&(ij(r,a-e,t,e,s,o,w),(x=ab(s,o,w[0],w[1]))<i)){for(i=x,u=0;u<e;++u)n[u]=w[u];n.length=e}return i}function bg(r,t,a,e,$,h,s,o,n,i,l){for(var u=l||[NaN,NaN],x=0,w=a.length;x<w;++x){var B=a[x];i=ag(r,t,B,e,$,h,s,o,n,i,u),t=B}return i}function Dn(r,t,a,e,$,h,s,o,n,i,l){for(var u=l||[NaN,NaN],x=0,w=a.length;x<w;++x){var B=a[x];i=bg(r,t,B,e,$,h,s,o,n,i,u),t=B[B.length-1]}return i}function jj(e,r,t,o){for(var n=0,a=t.length;n<a;++n)e[r++]=t[n];return r}function Wd(e,r,t,o){for(var n=0,a=t.length;n<a;++n)for(var $=t[n],d=0;d<o;++d)e[r++]=$[d];return r}function cg(e,r,t,o,n){for(var a=n||[],$=0,d=0,u=t.length;d<u;++d){var l=Wd(e,r,t[d],o);a[$++]=l,r=l}return a.length=$,a}function En(e,r,t,o,n){for(var a=n||[],$=0,d=0,u=t.length;d<u;++d){var l=cg(e,r,t[d],o,a[$]);a[$++]=l,r=l[l.length-1]}return a.length=$,a}function ed(r,t,e,o,n){for(var a=void 0!==n?n:[],i=0,$=t;$<e;$+=o)a[i++]=r.slice($,$+o);return a.length=i,a}function Xd(r,t,e,o,n){for(var a=void 0!==n?n:[],i=0,$=0,l=e.length;$<l;++$){var f=e[$];a[i++]=ed(r,t,f,o,a[i]),t=f}return a.length=i,a}function kj(r,t,e,o,n){for(var a=void 0!==n?n:[],i=0,$=0,l=e.length;$<l;++$){var f=e[$];a[i++]=Xd(r,t,f,o,a[i]),t=f[f.length-1]}return a.length=i,a}function dg(r,$,e,t,a,o,n){var u=(e-$)/t;if(u<3){for(;$<e;$+=t)o[n++]=r[$],o[n++]=r[$+1];return n}var p=new Array(u);p[0]=1,p[u-1]=1;for(var i=[$,e-t],m=0;i.length>0;){for(var M=i.pop(),s=i.pop(),w=0,I=r[s],x=r[s+1],l=r[M],c=r[M+1],f=s+t;f<M;f+=t){var g=r[f],d=r[f+1],v=vi(g,d,I,x,l,c);v>w&&(m=f,w=v)}w>a&&(p[(m-$)/t]=1,s+t<m&&i.push(s,m),m+t<M&&i.push(m,M))}for(f=0;f<u;++f)p[f]&&(o[n++]=r[$+f*t],o[n++]=r[$+f*t+1]);return n}function Fn(r,$,e,t,a,o,n,u){for(var p=0,i=e.length;p<i;++p){var m=e[p];n=dg(r,$,m,t,a,o,n),u.push(n),$=m}return n}function Db(r,$){return $*Math.round(r/$)}function Gn(r,$,e,t,a,o,n){if($==e)return n;var u,p,i=Db(r[$],a),m=Db(r[$+1],a);$+=t,o[n++]=i,o[n++]=m;do{if(u=Db(r[$],a),p=Db(r[$+1],a),($+=t)==e)return o[n++]=u,o[n++]=p,n}while(u==i&&p==m);for(;$<e;){var M=Db(r[$],a),s=Db(r[$+1],a);if($+=t,M!=u||s!=p){var w=u-i,I=p-m,x=M-i,l=s-m;w*l==I*x&&(w<0&&x<w||w==x||w>0&&x>w)&&(I<0&&l<I||I==l||I>0&&l>I)?(u=M,p=s):(o[n++]=u,o[n++]=p,i=u,m=p,u=M,p=s)}}return o[n++]=u,o[n++]=p,n}function lj(r,$,e,t,a,o,n,u){for(var p=0,i=e.length;p<i;++p){var m=e[p];n=Gn(r,$,m,t,a,o,n),u.push(n),$=m}return n}function Hn(r,$,e,t,a,o,n,u){for(var p=0,i=e.length;p<i;++p){var m=e[p],M=[];n=lj(r,$,m,t,a,o,n,M),u.push(M),$=m[m.length-1]}return n}var In=Kf&&Kf.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),eg=function(t){function e(e,o){var r=t.call(this)||this;return r.maxDelta_=-1,r.maxDeltaRevision_=-1,void 0===o||Array.isArray(e[0])?r.setCoordinates(e,o):r.setFlatCoordinates(o,e),r}return In(e,t),e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,o,r){return r<bb(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt($f(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ag(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,o,r))},e.prototype.getArea=function(){return gj(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinates=function(){return ed(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getSimplifiedGeometryInternal=function(t){var o=[];return o.length=dg(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,o,0),new e(o,l.XY)},e.prototype.getType=function(){return k.LINEAR_RING},e.prototype.intersectsExtent=function(t){return!1},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Wd(this.flatCoordinates,0,t,this.stride),this.changed()},e}(Pa);Kf.default=eg;var fd={};var Jn=fd&&fd.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),Qa=function(t){function e(e,r){var o=t.call(this)||this;return o.setCoordinates(e,r),o}return Jn(e,t),e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,r,o){var n=this.flatCoordinates,i=ab(t,e,n[0],n[1]);if(i<o){for(var s=this.stride,a=0;a<s;++a)r[a]=n[a];return r.length=s,i}return o},e.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},e.prototype.computeExtent=function(t){return Xc(this.flatCoordinates,t)},e.prototype.getType=function(){return k.POINT},e.prototype.intersectsExtent=function(t){return Hd(t,this.flatCoordinates[0],this.flatCoordinates[1])},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=jj(this.flatCoordinates,0,t,this.stride),this.changed()},e}(Pa);fd.default=Qa;function Kn(n,r,t,i,a){return!Af(a,function(a){return!Eb(n,r,t,i,a[0],a[1])})}function Eb(n,r,t,i,a,e){for(var $=0,o=n[t-i],s=n[t-i+1];r<t;r+=i){var l=n[r],g=n[r+1];s<=e?g>e&&(l-o)*(e-s)-(a-o)*(g-s)>0&&$++:g<=e&&(l-o)*(e-s)-(a-o)*(g-s)<0&&$--,o=l,s=g}return 0!==$}function fg(n,r,t,i,a,e){if(0===t.length)return!1;if(!Eb(n,r,t[0],i,a,e))return!1;for(var $=1,o=t.length;$<o;++$)if(Eb(n,t[$-1],t[$],i,a,e))return!1;return!0}function Ln(n,r,t,i,a,e){if(0===t.length)return!1;for(var $=0,o=t.length;$<o;++$){var s=t[$];if(fg(n,r,s,i,a,e))return!0;r=s[s.length-1]}return!1}function mj(r,t,a,e,o,n,$){for(var i,p,m,s,f,u,g,V=o[n+1],l=[],x=0,y=a.length;x<y;++x){var h=a[x];for(s=r[h-e],u=r[h-e+1],i=t;i<h;i+=e)f=r[i],g=r[i+1],(V<=u&&g<=V||u<=V&&V<=g)&&(m=(V-u)/(g-u)*(f-s)+s,l.push(m)),s=f,u=g}var v=NaN,A=-1/0;for(l.sort(Ea),s=l[0],i=1,p=l.length;i<p;++i){f=l[i];var I=Math.abs(f-s);I>A&&(m=(s+f)/2,fg(r,t,a,e,m,V)&&(v=m,A=I)),s=f}return isNaN(v)&&(v=o[n]),$?($.push(v,V,A),$):[v,V,A]}function Mn(r,t,a,e,o){for(var n=[],$=0,i=a.length;$<i;++$){var p=a[$];n=mj(r,t,p,e,o,2*$,n),t=p[p.length-1]}return n}function Yd(r,t,e,n,i){var $=zf(da(),r,t,e,n);return!!ea(i,$)&&(!!ra(i,$)||$[0]>=i[0]&&$[2]<=i[2]||$[1]>=i[1]&&$[3]<=i[3]||oj(r,t,e,n,function(r,t){return Bi(i,r,t)}))}function Nn(r,t,e,n,i){for(var $=0,a=e.length;$<a;++$){if(Yd(r,t,e[$],n,i))return!0;t=e[$]}return!1}function On(r,t,e,n,i){return!!Yd(r,t,e,n,i)||!!Eb(r,t,e,n,i[0],i[1])||!!Eb(r,t,e,n,i[0],i[3])||!!Eb(r,t,e,n,i[2],i[1])||!!Eb(r,t,e,n,i[2],i[3])}function nj(r,t,e,n,i){if(!On(r,t,e[0],n,i))return!1;if(1===e.length)return!0;for(var $=1,a=e.length;$<a;++$)if(Kn(r,e[$-1],e[$],n,i)&&!Yd(r,e[$-1],e[$],n,i))return!1;return!0}function Pn(r,t,e,n,i){for(var $=0,a=e.length;$<a;++$){var s=e[$];if(nj(r,t,s,n,i))return!0;t=s[s.length-1]}return!1}function oj(r,$,o,p,t){for(var e,f=[r[$],r[$+1]],s=[];$+p<o;$+=p){if(s[0]=r[$+p],s[1]=r[$+p+1],e=t(f,s))return e;f[0]=s[0],f[1]=s[1]}return!1}function pj(r,e,n,i){for(var $=0,t=r[n-i],o=r[n-i+1];e<n;e+=i){var p=r[e],x=r[e+1];$+=(p-t)*(x+o),t=p,o=x}return $>0}function qj(r,e,n,i,$){for(var t=void 0!==$&&$,o=0,p=n.length;o<p;++o){var x=n[o],s=pj(r,e,x,i);if(0===o){if(t&&s||!t&&!s)return!1}else if(t&&!s||!t&&s)return!1;e=x}return!0}function Qn(r,e,n,i,$){for(var t=0,o=n.length;t<o;++t){var p=n[t];if(!qj(r,e,p,i,$))return!1;p.length&&(e=p[p.length-1])}return!0}function gg(r,e,n,i,$){for(var t=void 0!==$&&$,o=0,p=n.length;o<p;++o){var x=n[o],s=pj(r,e,x,i);(0===o?t&&s||!t&&!s:t&&!s||!t&&s)&&Rn(r,e,x,i),e=x}return e}function rj(r,e,n,i,$){for(var t=0,o=n.length;t<o;++t)e=gg(r,e,n[t],i,$);return e}function Rn(o,r,e,$){for(;r<e-$;){for(var t=0;t<$;++t){var a=o[r+t];o[r+t]=o[e-$+t],o[e-$+t]=a}r+=$,e-=$}}var Sn=Ka&&Ka.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),na=function(t){function e(e,r,i){var o=t.call(this)||this;return o.ends_=[],o.flatInteriorPointRevision_=-1,o.flatInteriorPoint_=null,o.maxDelta_=-1,o.maxDeltaRevision_=-1,o.orientedRevision_=-1,o.orientedFlatCoordinates_=null,void 0!==r&&i?(o.setFlatCoordinates(r,e),o.ends_=i):o.setCoordinates(e,r),o}return Sn(e,t),e.prototype.appendLinearRing=function(t){this.flatCoordinates?v(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice())},e.prototype.closestPointXY=function(t,e,r,i){return i<bb(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(_f(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),bg(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,r,i))},e.prototype.containsXY=function(t,e){return fg(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)},e.prototype.getArea=function(){return hj(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},e.prototype.getCoordinates=function(t){var e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),gg(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,Xd(e,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var t=ac(this.getExtent());this.flatInteriorPoint_=mj(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_},e.prototype.getInteriorPoint=function(){return new Qa(this.getFlatInteriorPoint(),l.XYM)},e.prototype.getLinearRingCount=function(){return this.ends_.length},e.prototype.getLinearRing=function(t){return t<0||this.ends_.length<=t?null:new eg(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLinearRings=function(){for(var t=this.layout,e=this.flatCoordinates,r=this.ends_,i=[],o=0,n=0,s=r.length;n<s;++n){var a=r[n],l=new eg(e.slice(o,a),t);i.push(l),o=a}return i},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;qj(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=gg(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var r=[],i=[];return r.length=lj(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),r,0,i),new e(r,l.XY,i)},e.prototype.getType=function(){return k.POLYGON},e.prototype.intersectsExtent=function(t){return nj(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var r=cg(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===r.length?0:r[r.length-1],this.changed()},e}(Pa);function Tn(t,e,r,i){for(var o=r||32,n=[],s=0;s<o;++s)v(n,mn(t,e,2*Math.PI*s/o,i));return n.push(n[0],n[1]),new na(n,l.XY,[n.length])}function Fb(t){var e=t[0],r=t[1],i=t[2],o=t[3],n=[e,r,e,o,i,o,i,r,e,r];return new na(n,l.XY,[n.length])}function hg(t,e,r){for(var i=e||32,o=t.getStride(),n=t.getLayout(),s=t.getCenter(),a=o*(i+1),l=new Array(a),$=0;$<a;$+=o){l[$]=0,l[$+1]=0;for(var p=2;p<o;p++)l[$+p]=s[p]}var h=[l.length],d=new na(l,n,h);return ig(d,s,t.getRadius(),r),d}function ig(t,e,r,i){for(var o=t.getFlatCoordinates(),n=t.getStride(),s=o.length/n-1,a=i||0,l=0;l<=s;++l){var $=l*n,p=a+2*$b(l,s)*Math.PI/s;o[$]=e[0]+r*Math.cos(p),o[$+1]=e[1]+r*Math.sin(p)}t.changed()}Ka.default=na,Ka.circular=Tn,Ka.fromExtent=Fb,Ka.fromCircle=hg,Ka.makeRegular=ig;var Un=Ha&&Ha.__extends||function(){var t=function(o,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var e in o)o.hasOwnProperty(e)&&(t[e]=o[e])})(o,e)};return function(o,e){function r(){this.constructor=o}t(o,e),o.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),jg=0,Zd=function(t){function o(o){var e=t.call(this)||this,r=L({},o);return e.hints_=[0,0],e.animations_=[],e.updateAnimationKey_,e.projection_=Qd(r.projection,"EPSG:3857"),e.viewportSize_=[100,100],e.targetCenter_=null,e.targetResolution_,e.targetRotation_,e.cancelAnchor_=void 0,r.center&&(r.center=w(r.center,e.projection_)),r.extent&&(r.extent=Oa(r.extent,e.projection_)),e.applyOptions_(r),e}return Un(o,t),o.prototype.applyOptions_=function(t){var o=tj(t);this.maxResolution_=o.maxResolution,this.minResolution_=o.minResolution,this.zoomFactor_=o.zoomFactor,this.resolutions_=t.resolutions,this.minZoom_=o.minZoom;var e=sj(t),r=o.constraint,i=uj(t);this.constraints_={center:e,resolution:r,rotation:i},this.setRotation(void 0!==t.rotation?t.rotation:0),this.setCenterInternal(void 0!==t.center?t.center:null),void 0!==t.resolution?this.setResolution(t.resolution):void 0!==t.zoom&&this.setZoom(t.zoom),this.setProperties({}),this.options_=t},o.prototype.getUpdatedOptions_=function(t){var o=L({},this.options_);return void 0!==o.resolution?o.resolution=this.getResolution():o.zoom=this.getZoom(),o.center=this.getCenterInternal(),o.rotation=this.getRotation(),L({},o,t)},o.prototype.animate=function(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);for(var o=new Array(arguments.length),e=0;e<o.length;++e){var r=arguments[e];r.center&&((r=L({},r)).center=w(r.center,this.getProjection())),r.anchor&&((r=L({},r)).anchor=w(r.anchor,this.getProjection())),o[e]=r}this.animateInternal.apply(this,o)},o.prototype.animateInternal=function(t){var o,e=arguments.length;if(e>1&&"function"==typeof arguments[e-1]&&(o=arguments[e-1],--e),!this.isDef()){var r=arguments[e-1];return r.center&&this.setCenterInternal(r.center),void 0!==r.zoom&&this.setZoom(r.zoom),void 0!==r.rotation&&this.setRotation(r.rotation),void(o&&$d(o,!0))}for(var i=Date.now(),n=this.targetCenter_.slice(),s=this.targetResolution_,a=this.targetRotation_,p=[],$=0;$<e;++$){var u=arguments[$],h={start:i,complete:!1,anchor:u.anchor,duration:void 0!==u.duration?u.duration:1e3,easing:u.easing||Od,callback:o};if(u.center&&(h.sourceCenter=n,h.targetCenter=u.center.slice(),n=h.targetCenter),void 0!==u.zoom?(h.sourceResolution=s,h.targetResolution=this.getResolutionForZoom(u.zoom),s=h.targetResolution):u.resolution&&(h.sourceResolution=s,h.targetResolution=u.resolution,s=h.targetResolution),void 0!==u.rotation){h.sourceRotation=a;var l=$b(u.rotation-a+Math.PI,2*Math.PI)-Math.PI;h.targetRotation=a+l,a=h.targetRotation}vj(h)?h.complete=!0:i+=h.duration,p.push(h)}this.animations_.push(p),this.setHint(H.ANIMATING,1),this.updateAnimations_()},o.prototype.getAnimating=function(){return this.hints_[H.ANIMATING]>0},o.prototype.getInteracting=function(){return this.hints_[H.INTERACTING]>0},o.prototype.cancelAnimations=function(){var t;this.setHint(H.ANIMATING,-this.hints_[H.ANIMATING]);for(var o=0,e=this.animations_.length;o<e;++o){var r=this.animations_[o];if(r[0].callback&&$d(r[0].callback,!1),!t)for(var i=0,n=r.length;i<n;++i){var s=r[i];if(!s.complete){t=s.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t},o.prototype.updateAnimations_=function(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),this.getAnimating()){for(var t=Date.now(),o=!1,e=this.animations_.length-1;e>=0;--e){for(var r=this.animations_[e],i=!0,n=0,s=r.length;n<s;++n){var a=r[n];if(!a.complete){var p=t-a.start,$=a.duration>0?p/a.duration:1;$>=1?(a.complete=!0,$=1):i=!1;var u=a.easing($);if(a.sourceCenter){var h=a.sourceCenter[0],l=a.sourceCenter[1],c=h+u*(a.targetCenter[0]-h),m=l+u*(a.targetCenter[1]-l);this.targetCenter_=[c,m]}if(a.sourceResolution&&a.targetResolution){var g=1===u?a.targetResolution:a.sourceResolution+u*(a.targetResolution-a.sourceResolution);if(a.anchor){var _=this.getViewportSize_(this.getRotation()),R=this.constraints_.resolution(g,0,_,!0);this.targetCenter_=this.calculateCenterZoom(R,a.anchor)}this.targetResolution_=g,this.applyTargetState_(!0)}if(void 0!==a.sourceRotation&&void 0!==a.targetRotation){var L=1===u?$b(a.targetRotation+Math.PI,2*Math.PI)-Math.PI:a.sourceRotation+u*(a.targetRotation-a.sourceRotation);if(a.anchor){var v=this.constraints_.rotation(L,!0);this.targetCenter_=this.calculateCenterRotate(v,a.anchor)}this.targetRotation_=L}if(this.applyTargetState_(!0),o=!0,!a.complete)break}}if(i){this.animations_[e]=null,this.setHint(H.ANIMATING,-1);var f=r[0].callback;f&&$d(f,!0)}}this.animations_=this.animations_.filter(Boolean),o&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}},o.prototype.calculateCenterRotate=function(t,o){var e,r=this.getCenterInternal();return void 0!==r&&(e=[r[0]-o[0],r[1]-o[1]],Md(e,t-this.getRotation()),Ei(e,o)),e},o.prototype.calculateCenterZoom=function(t,o){var e,r=this.getCenterInternal(),i=this.getResolution();void 0!==r&&void 0!==i&&(e=[o[0]-t*(o[0]-r[0])/i,o[1]-t*(o[1]-r[1])/i]);return e},o.prototype.getViewportSize_=function(t){var o=this.viewportSize_;if(t){var e=o[0],r=o[1];return[Math.abs(e*Math.cos(t))+Math.abs(r*Math.sin(t)),Math.abs(e*Math.sin(t))+Math.abs(r*Math.cos(t))]}return o},o.prototype.setViewportSize=function(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.resolveConstraints(0)},o.prototype.getCenter=function(){var t=this.getCenterInternal();return t?ec(t,this.getProjection()):t},o.prototype.getCenterInternal=function(){return this.get(Y.CENTER)},o.prototype.getConstraints=function(){return this.constraints_},o.prototype.getConstrainResolution=function(){return this.options_.constrainResolution},o.prototype.getHints=function(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()},o.prototype.calculateExtent=function(t){var o=this.calculateExtentInternal(t);return fc(o,this.getProjection())},o.prototype.calculateExtentInternal=function(t){var o=t||this.getViewportSize_(),e=this.getCenterInternal();q(e,1);var r=this.getResolution();q(void 0!==r,2);var i=this.getRotation();return q(void 0!==i,3),Cf(e,r,i,o)},o.prototype.getMaxResolution=function(){return this.maxResolution_},o.prototype.getMinResolution=function(){return this.minResolution_},o.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)},o.prototype.setMaxZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))},o.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)},o.prototype.setMinZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))},o.prototype.setConstrainResolution=function(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))},o.prototype.getProjection=function(){return this.projection_},o.prototype.getResolution=function(){return this.get(Y.RESOLUTION)},o.prototype.getResolutions=function(){return this.resolutions_},o.prototype.getResolutionForExtent=function(t,o){return this.getResolutionForExtentInternal(Oa(t,this.getProjection()),o)},o.prototype.getResolutionForExtentInternal=function(t,o){var e=o||this.getViewportSize_(),r=ka(t)/e[0],i=Ja(t)/e[1];return Math.max(r,i)},o.prototype.getResolutionForValueFunction=function(t){var o=t||2,e=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,i=Math.log(e/r)/Math.log(o);return function(t){return e/Math.pow(o,t*i)}},o.prototype.getRotation=function(){return this.get(Y.ROTATION)},o.prototype.getValueForResolutionFunction=function(t){var o=Math.log(t||2),e=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,i=Math.log(e/r)/o;return function(t){return Math.log(e/t)/o/i}},o.prototype.getState=function(){var t=this.getCenterInternal(),o=this.getProjection(),e=this.getResolution(),r=this.getRotation();return{center:t.slice(0),projection:void 0!==o?o:null,resolution:e,rotation:r,zoom:this.getZoom()}},o.prototype.getZoom=function(){var t,o=this.getResolution();return void 0!==o&&(t=this.getZoomForResolution(o)),t},o.prototype.getZoomForResolution=function(t){var o,e,r=this.minZoom_||0;if(this.resolutions_){var i=gf(this.resolutions_,t,1);r=i,o=this.resolutions_[i],e=i==this.resolutions_.length-1?2:o/this.resolutions_[i+1]}else o=this.maxResolution_,e=this.zoomFactor_;return r+Math.log(o/t)/Math.log(e)},o.prototype.getResolutionForZoom=function(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;var o=F(Math.floor(t),0,this.resolutions_.length-2),e=this.resolutions_[o]/this.resolutions_[o+1];return this.resolutions_[o]/Math.pow(e,F(t-o,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)},o.prototype.fit=function(t,o){var e,r=L({size:this.getViewportSize_()},o||{});if(q(Array.isArray(t)||"function"==typeof t.getSimplifiedGeometry,24),Array.isArray(t)){q(!Ld(t),25);var i=Oa(t,this.getProjection());e=Fb(i)}else if(t.getType()===k.CIRCLE){i=Oa(t.getExtent(),this.getProjection());(e=Fb(i)).rotate(this.getRotation(),ac(i))}else{var n=ib();e=n?t.clone().transform(n,this.getProjection()):t}this.fitInternal(e,r)},o.prototype.fitInternal=function(t,o){var e=o||{},r=e.size;r||(r=this.getViewportSize_());var i,n=void 0!==e.padding?e.padding:[0,0,0,0],s=void 0!==e.nearest&&e.nearest;i=void 0!==e.minResolution?e.minResolution:void 0!==e.maxZoom?this.getResolutionForZoom(e.maxZoom):0;for(var a=t.getFlatCoordinates(),p=this.getRotation(),$=Math.cos(-p),u=Math.sin(-p),h=1/0,l=1/0,c=-1/0,m=-1/0,g=t.getStride(),_=0,R=a.length;_<R;_+=g){var L=a[_]*$-a[_+1]*u,v=a[_]*u+a[_+1]*$;h=Math.min(h,L),l=Math.min(l,v),c=Math.max(c,L),m=Math.max(m,v)}var f=this.getResolutionForExtentInternal([h,l,c,m],[r[0]-n[1]-n[3],r[1]-n[0]-n[2]]);f=isNaN(f)?i:Math.max(f,i),f=this.getConstrainedResolution(f,s?0:1),u=-u;var d=(h+c)/2,X=(l+m)/2,y=[(d+=(n[1]-n[3])/2*f)*$-(X+=(n[0]-n[2])/2*f)*u,X*$+d*u],C=e.callback?e.callback:Da;void 0!==e.duration?this.animateInternal({resolution:f,center:this.getConstrainedCenter(y,f),duration:e.duration,easing:e.easing},C):(this.targetResolution_=f,this.targetCenter_=y,this.applyTargetState_(!1,!0),$d(C,!0))},o.prototype.centerOn=function(t,o,e){this.centerOnInternal(w(t,this.getProjection()),o,e)},o.prototype.centerOnInternal=function(t,o,e){var r=this.getRotation(),i=Math.cos(-r),n=Math.sin(-r),s=t[0]*i-t[1]*n,a=t[1]*i+t[0]*n,p=this.getResolution(),$=(s+=(o[0]/2-e[0])*p)*i-(a+=(e[1]-o[1]/2)*p)*(n=-n),u=a*i+s*n;this.setCenterInternal([$,u])},o.prototype.isDef=function(){return!!this.getCenterInternal()&&void 0!==this.getResolution()},o.prototype.adjustCenter=function(t){var o=ec(this.targetCenter_,this.getProjection());this.setCenter([o[0]+t[0],o[1]+t[1]])},o.prototype.adjustCenterInternal=function(t){var o=this.targetCenter_;this.setCenterInternal([o[0]+t[0],o[1]+t[1]])},o.prototype.adjustResolution=function(t,o){var e=o&&w(o,this.getProjection());this.adjustResolutionInternal(t,e)},o.prototype.adjustResolutionInternal=function(t,o){var e=this.getAnimating()||this.getInteracting(),r=this.getViewportSize_(this.getRotation()),i=this.constraints_.resolution(this.targetResolution_*t,0,r,e);o&&(this.targetCenter_=this.calculateCenterZoom(i,o)),this.targetResolution_*=t,this.applyTargetState_()},o.prototype.adjustZoom=function(t,o){this.adjustResolution(Math.pow(this.zoomFactor_,-t),o)},o.prototype.adjustRotation=function(t,o){o&&(o=w(o,this.getProjection())),this.adjustRotationInternal(t,o)},o.prototype.adjustRotationInternal=function(t,o){var e=this.getAnimating()||this.getInteracting(),r=this.constraints_.rotation(this.targetRotation_+t,e);o&&(this.targetCenter_=this.calculateCenterRotate(r,o)),this.targetRotation_+=t,this.applyTargetState_()},o.prototype.setCenter=function(t){this.setCenterInternal(w(t,this.getProjection()))},o.prototype.setCenterInternal=function(t){this.targetCenter_=t,this.applyTargetState_()},o.prototype.setHint=function(t,o){return this.hints_[t]+=o,this.changed(),this.hints_[t]},o.prototype.setResolution=function(t){this.targetResolution_=t,this.applyTargetState_()},o.prototype.setRotation=function(t){this.targetRotation_=t,this.applyTargetState_()},o.prototype.setZoom=function(t){this.setResolution(this.getResolutionForZoom(t))},o.prototype.applyTargetState_=function(t,o){var e=this.getAnimating()||this.getInteracting()||o,r=this.constraints_.rotation(this.targetRotation_,e),i=this.getViewportSize_(r),n=this.constraints_.resolution(this.targetResolution_,0,i,e),s=this.constraints_.center(this.targetCenter_,n,i,e);this.get(Y.ROTATION)!==r&&this.set(Y.ROTATION,r),this.get(Y.RESOLUTION)!==n&&this.set(Y.RESOLUTION,n),this.get(Y.CENTER)&&la(this.get(Y.CENTER),s)||this.set(Y.CENTER,s),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0},o.prototype.resolveConstraints=function(t,o,e){var r=void 0!==t?t:200,i=o||0,n=this.constraints_.rotation(this.targetRotation_),s=this.getViewportSize_(n),a=this.constraints_.resolution(this.targetResolution_,i,s),p=this.constraints_.center(this.targetCenter_,a,s);if(0===r&&!this.cancelAnchor_)return this.targetResolution_=a,this.targetRotation_=n,this.targetCenter_=p,void this.applyTargetState_();var $=e||(0===r?this.cancelAnchor_:void 0);this.cancelAnchor_=void 0,this.getResolution()===a&&this.getRotation()===n&&this.getCenterInternal()&&la(this.getCenterInternal(),p)||(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:n,center:p,resolution:a,duration:r,easing:gb,anchor:$}))},o.prototype.beginInteraction=function(){this.resolveConstraints(0),this.setHint(H.INTERACTING,1)},o.prototype.endInteraction=function(t,o,e){var r=e&&w(e,this.getProjection());this.endInteractionInternal(t,o,r)},o.prototype.endInteractionInternal=function(t,o,e){this.setHint(H.INTERACTING,-1),this.resolveConstraints(t,o,e)},o.prototype.getConstrainedCenter=function(t,o){var e=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,o||this.getResolution(),e)},o.prototype.getConstrainedZoom=function(t,o){var e=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(e,o))},o.prototype.getConstrainedResolution=function(t,o){var e=o||0,r=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,r)},o}(X);function $d(t,o){setTimeout(function(){t(o)},0)}function sj(t){if(void 0!==t.extent){var o=void 0===t.smoothExtentConstraint||t.smoothExtentConstraint;return ti(t.extent,t.constrainOnlyCenter,o)}var e=Qd(t.projection,"EPSG:3857");if(!0!==t.multiWorld&&e.isGlobal()){var r=e.getExtent().slice();return r[0]=-1/0,r[2]=1/0,ti(r,!1,!1)}return Nm}function tj(t){var o,e,r,i=void 0!==t.minZoom?t.minZoom:jg,n=void 0!==t.maxZoom?t.maxZoom:28,s=void 0!==t.zoomFactor?t.zoomFactor:2,a=void 0!==t.multiWorld&&t.multiWorld,p=void 0===t.smoothResolutionConstraint||t.smoothResolutionConstraint,$=void 0!==t.showFullExtent&&t.showFullExtent,u=Qd(t.projection,"EPSG:3857"),h=u.getExtent(),l=t.constrainOnlyCenter,c=t.extent;if(a||c||!u.isGlobal()||(l=!1,c=h),void 0!==t.resolutions){var m=t.resolutions;e=m[i],r=void 0!==m[n]?m[n]:m[m.length-1],o=t.constrainResolution?Pm(m,p,!l&&c,$):wi(e,r,p,!l&&c,$)}else{var g=(h?Math.max(ka(h),Ja(h)):360*ma[O.DEGREES]/u.getMetersPerUnit())/si/Math.pow(2,jg),_=g/Math.pow(2,28-jg);void 0!==(e=t.maxResolution)?i=0:e=g/Math.pow(s,i),void 0===(r=t.minResolution)&&(r=void 0!==t.maxZoom?void 0!==t.maxResolution?e/Math.pow(s,n):g/Math.pow(s,n):_),n=i+Math.floor(Math.log(e/r)/Math.log(s)),r=e/Math.pow(s,n-i),o=t.constrainResolution?Qm(s,e,r,p,!l&&c,$):wi(e,r,p,!l&&c,$)}return{constraint:o,maxResolution:e,minResolution:r,minZoom:i,zoomFactor:s}}function uj(t){if(void 0===t.enableRotation||t.enableRotation){var o=t.constrainRotation;return void 0===o||!0===o?$m():!1===o?Di:"number"==typeof o?Zm(o):Di}return Ff}function vj(t){return!(t.sourceCenter&&t.targetCenter&&!la(t.sourceCenter,t.targetCenter))&&t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation}Ha.createCenterConstraint=sj,Ha.createResolutionConstraint=tj,Ha.createRotationConstraint=uj,Ha.isNoopAnimation=vj,Ha.default=Zd;var Ra={};function Z(e,t,r){var o=r&&r.length?r.shift():document.createElement("canvas");return e&&(o.width=e),t&&(o.height=t),o.getContext("2d")}function wj(e){var t=e.offsetWidth,r=getComputedStyle(e);return t+=parseInt(r.marginLeft,10)+parseInt(r.marginRight,10)}function xj(e){var t=e.offsetHeight,r=getComputedStyle(e);return t+=parseInt(r.marginTop,10)+parseInt(r.marginBottom,10)}function Gb(e,t){var r=t.parentNode;r&&r.replaceChild(e,t)}function gd(e){return e&&e.parentNode?e.parentNode.removeChild(e):null}function kg(e){for(;e.lastChild;)e.removeChild(e.lastChild)}function yj(e,t){for(var r=e.childNodes,o=0;;++o){var $=r[o],n=t[o];if(!$&&!n)break;$!==n&&($?n?e.insertBefore(n,$):(e.removeChild($),--o):e.appendChild(n))}}Ra.createCanvasContext2D=Z,Ra.outerWidth=wj,Ra.outerHeight=xj,Ra.replaceNode=Gb,Ra.removeNode=gd,Ra.removeChildren=kg,Ra.replaceChildren=yj;var lg={};var mg={};var p={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source"};var Vn=mg&&mg.__extends||function(){var t=function(o,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var e in o)o.hasOwnProperty(e)&&(t[e]=o[e])})(o,e)};return function(o,e){function r(){this.constructor=o}t(o,e),o.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),ng=function(t){function o(o){var e=t.call(this)||this,r=L({},o);return r[p.OPACITY]=void 0!==o.opacity?o.opacity:1,q("number"==typeof r[p.OPACITY],64),r[p.VISIBLE]=void 0===o.visible||o.visible,r[p.Z_INDEX]=o.zIndex,r[p.MAX_RESOLUTION]=void 0!==o.maxResolution?o.maxResolution:1/0,r[p.MIN_RESOLUTION]=void 0!==o.minResolution?o.minResolution:0,r[p.MIN_ZOOM]=void 0!==o.minZoom?o.minZoom:-1/0,r[p.MAX_ZOOM]=void 0!==o.maxZoom?o.maxZoom:1/0,e.className_=void 0!==r.className?o.className:"ol-layer",delete r.className,e.setProperties(r),e.state_=null,e}return Vn(o,t),o.prototype.getClassName=function(){return this.className_},o.prototype.getLayerState=function(t){var o=this.state_||{layer:this,managed:void 0===t||t},e=this.getZIndex();return o.opacity=F(Math.round(100*this.getOpacity())/100,0,1),o.sourceState=this.getSourceState(),o.visible=this.getVisible(),o.extent=this.getExtent(),o.zIndex=void 0!==e?e:!1===o.managed?1/0:0,o.maxResolution=this.getMaxResolution(),o.minResolution=Math.max(this.getMinResolution(),0),o.minZoom=this.getMinZoom(),o.maxZoom=this.getMaxZoom(),this.state_=o,o},o.prototype.getLayersArray=function(t){return h()},o.prototype.getLayerStatesArray=function(t){return h()},o.prototype.getExtent=function(){return this.get(p.EXTENT)},o.prototype.getMaxResolution=function(){return this.get(p.MAX_RESOLUTION)},o.prototype.getMinResolution=function(){return this.get(p.MIN_RESOLUTION)},o.prototype.getMinZoom=function(){return this.get(p.MIN_ZOOM)},o.prototype.getMaxZoom=function(){return this.get(p.MAX_ZOOM)},o.prototype.getOpacity=function(){return this.get(p.OPACITY)},o.prototype.getSourceState=function(){return h()},o.prototype.getVisible=function(){return this.get(p.VISIBLE)},o.prototype.getZIndex=function(){return this.get(p.Z_INDEX)},o.prototype.setExtent=function(t){this.set(p.EXTENT,t)},o.prototype.setMaxResolution=function(t){this.set(p.MAX_RESOLUTION,t)},o.prototype.setMinResolution=function(t){this.set(p.MIN_RESOLUTION,t)},o.prototype.setMaxZoom=function(t){this.set(p.MAX_ZOOM,t)},o.prototype.setMinZoom=function(t){this.set(p.MIN_ZOOM,t)},o.prototype.setOpacity=function(t){q("number"==typeof t,64),this.set(p.OPACITY,t)},o.prototype.setVisible=function(t){this.set(p.VISIBLE,t)},o.prototype.setZIndex=function(t){this.set(p.Z_INDEX,t)},o.prototype.disposeInternal=function(){this.state_&&(this.state_.layer=null,this.state_=null),t.prototype.disposeInternal.call(this)},o}(X);mg.default=ng;var og={},jb={UNDEFINED:"undefined",LOADING:"loading",READY:"ready",ERROR:"error"};og.default=jb;var Wn=lg&&lg.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function s(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(s.prototype=r.prototype,new s)}}(),pg={LAYERS:"layers"},zj=function(e){function t(t){var r=this,s=t||{},i=L({},s);delete i.layers;var n=s.layers;return(r=e.call(this,i)||this).layersListenerKeys_=[],r.listenerKeys_={},r.addEventListener(A(pg.LAYERS),r.handleLayersChanged_),n?Array.isArray(n)?n=new K(n.slice(),{unique:!0}):q("function"==typeof n.getArray,43):n=new K(void 0,{unique:!0}),r.setLayers(n),r}return Wn(t,e),t.prototype.handleLayerChange_=function(){this.changed()},t.prototype.handleLayersChanged_=function(){this.layersListenerKeys_.forEach(m),this.layersListenerKeys_.length=0;var e=this.getLayers();for(var t in this.layersListenerKeys_.push(d(e,C.ADD,this.handleLayersAdd_,this),d(e,C.REMOVE,this.handleLayersRemove_,this)),this.listenerKeys_)this.listenerKeys_[t].forEach(m);Za(this.listenerKeys_);for(var r=e.getArray(),s=0,i=r.length;s<i;s++){var n=r[s];this.listenerKeys_[aa(n)]=[d(n,Ya.PROPERTYCHANGE,this.handleLayerChange_,this),d(n,f.CHANGE,this.handleLayerChange_,this)]}this.changed()},t.prototype.handleLayersAdd_=function(e){var t=e.element;this.listenerKeys_[aa(t)]=[d(t,Ya.PROPERTYCHANGE,this.handleLayerChange_,this),d(t,f.CHANGE,this.handleLayerChange_,this)],this.changed()},t.prototype.handleLayersRemove_=function(e){var t=e.element,r=aa(t);this.listenerKeys_[r].forEach(m),delete this.listenerKeys_[r],this.changed()},t.prototype.getLayers=function(){return this.get(pg.LAYERS)},t.prototype.setLayers=function(e){this.set(pg.LAYERS,e)},t.prototype.getLayersArray=function(e){var t=void 0!==e?e:[];return this.getLayers().forEach(function(e){e.getLayersArray(t)}),t},t.prototype.getLayerStatesArray=function(e){var t=void 0!==e?e:[],r=t.length;this.getLayers().forEach(function(e){e.getLayerStatesArray(t)});for(var s=this.getLayerState(),i=r,n=t.length;i<n;i++){var o=t[i];o.opacity*=s.opacity,o.visible=o.visible&&s.visible,o.maxResolution=Math.min(o.maxResolution,s.maxResolution),o.minResolution=Math.max(o.minResolution,s.minResolution),o.minZoom=Math.max(o.minZoom,s.minZoom),o.maxZoom=Math.min(o.maxZoom,s.maxZoom),void 0!==s.extent&&(void 0!==o.extent?o.extent=Kd(o.extent,s.extent):o.extent=s.extent)}return t},t.prototype.getSourceState=function(){return jb.READY},t}(ng);lg.default=zj;var jc={};function Xn($,r,e){return void 0===e&&(e=[0,0]),e[0]=$[0]+2*r,e[1]=$[1]+2*r,e}function Aj($){return $[0]>0&&$[1]>0}function Yn($,r,e){return void 0===e&&(e=[0,0]),e[0]=$[0]*r+.5|0,e[1]=$[1]*r+.5|0,e}function Zn($,r){return Array.isArray($)?$:(void 0===r?r=[$,$]:(r[0]=$,r[1]=$),r)}jc.buffer=Xn,jc.hasArea=Aj,jc.scale=Yn,jc.toSize=Zn;var $n=Hc&&Hc.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),qg=function(e){function t(t){var r=e.call(this)||this,i=_n(t);r.boundHandleBrowserEvent_=r.handleBrowserEvent.bind(r),r.maxTilesLoading_=void 0!==t.maxTilesLoading?t.maxTilesLoading:16,r.pixelRatio_=void 0!==t.pixelRatio?t.pixelRatio:Uc,r.postRenderTimeoutHandle_,r.animationDelayKey_,r.animationDelay_=function(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}.bind(r),r.coordinateToPixelTransform_=G(),r.pixelToCoordinateTransform_=G(),r.frameIndex_=0,r.frameState_=null,r.previousExtent_=null,r.viewPropertyListenerKey_=null,r.viewChangeListenerKey_=null,r.layerGroupPropertyListenerKeys_=null,r.viewport_=document.createElement("div"),r.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),r.viewport_.style.position="relative",r.viewport_.style.overflow="hidden",r.viewport_.style.width="100%",r.viewport_.style.height="100%",r.overlayContainer_=document.createElement("div"),r.overlayContainer_.style.position="absolute",r.overlayContainer_.style.zIndex="0",r.overlayContainer_.style.width="100%",r.overlayContainer_.style.height="100%",r.overlayContainer_.className="ol-overlaycontainer",r.viewport_.appendChild(r.overlayContainer_),r.overlayContainerStopEvent_=document.createElement("div"),r.overlayContainerStopEvent_.style.position="absolute",r.overlayContainerStopEvent_.style.zIndex="0",r.overlayContainerStopEvent_.style.width="100%",r.overlayContainerStopEvent_.style.height="100%",r.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",r.viewport_.appendChild(r.overlayContainerStopEvent_),r.mapBrowserEventHandler_=new qi(r,t.moveTolerance);var n=r.handleMapBrowserEvent.bind(r);for(var o in j)r.mapBrowserEventHandler_.addEventListener(j[o],n);r.keyboardEventTarget_=i.keyboardEventTarget,r.keyHandlerKeys_=null;var a=r.handleBrowserEvent.bind(r);return r.viewport_.addEventListener(f.CONTEXTMENU,a,!1),r.viewport_.addEventListener(f.WHEEL,a,!!pi&&{passive:!1}),r.controls=i.controls||new K,r.interactions=i.interactions||new K,r.overlays_=i.overlays,r.overlayIdIndex_={},r.renderer_=null,r.handleResize_,r.postRenderFunctions_=[],r.tileQueue_=new ri(r.getTilePriority.bind(r),r.handleTileChange_.bind(r)),r.addEventListener(A(s.LAYERGROUP),r.handleLayerGroupChanged_),r.addEventListener(A(s.VIEW),r.handleViewChanged_),r.addEventListener(A(s.SIZE),r.handleSizeChanged_),r.addEventListener(A(s.TARGET),r.handleTargetChanged_),r.setProperties(i.values),r.controls.forEach(function(e){e.setMap(this)}.bind(r)),r.controls.addEventListener(C.ADD,function(e){e.element.setMap(this)}.bind(r)),r.controls.addEventListener(C.REMOVE,function(e){e.element.setMap(null)}.bind(r)),r.interactions.forEach(function(e){e.setMap(this)}.bind(r)),r.interactions.addEventListener(C.ADD,function(e){e.element.setMap(this)}.bind(r)),r.interactions.addEventListener(C.REMOVE,function(e){e.element.setMap(null)}.bind(r)),r.overlays_.forEach(r.addOverlayInternal_.bind(r)),r.overlays_.addEventListener(C.ADD,function(e){this.addOverlayInternal_(e.element)}.bind(r)),r.overlays_.addEventListener(C.REMOVE,function(e){var t=e.element.getId();void 0!==t&&delete this.overlayIdIndex_[t.toString()],e.element.setMap(null)}.bind(r)),r}return $n(t,e),t.prototype.createRenderer=function(){throw new Error("Use a map type that has a createRenderer method")},t.prototype.addControl=function(e){this.getControls().push(e)},t.prototype.addInteraction=function(e){this.getInteractions().push(e)},t.prototype.addLayer=function(e){this.getLayerGroup().getLayers().push(e)},t.prototype.addOverlay=function(e){this.getOverlays().push(e)},t.prototype.addOverlayInternal_=function(e){var t=e.getId();void 0!==t&&(this.overlayIdIndex_[t.toString()]=e),e.setMap(this)},t.prototype.disposeInternal=function(){this.mapBrowserEventHandler_.dispose(),this.viewport_.removeEventListener(f.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(f.WHEEL,this.boundHandleBrowserEvent_),void 0!==this.handleResize_&&(removeEventListener(f.RESIZE,this.handleResize_,!1),this.handleResize_=void 0),this.setTarget(null),e.prototype.disposeInternal.call(this)},t.prototype.forEachFeatureAtPixel=function(e,t,r){if(this.frameState_){var i=this.getCoordinateFromPixelInternal(e),n=void 0!==(r=void 0!==r?r:{}).hitTolerance?r.hitTolerance*this.frameState_.pixelRatio:0,o=void 0!==r.layerFilter?r.layerFilter:W,a=!1!==r.checkWrapped;return this.renderer_.forEachFeatureAtCoordinate(i,this.frameState_,n,a,t,null,o,null)}},t.prototype.getFeaturesAtPixel=function(e,t){var r=[];return this.forEachFeatureAtPixel(e,function(e){r.push(e)},t),r},t.prototype.forEachLayerAtPixel=function(e,t,r){if(this.frameState_){var i=r||{},n=void 0!==i.hitTolerance?i.hitTolerance*this.frameState_.pixelRatio:0,o=i.layerFilter||W;return this.renderer_.forEachLayerAtPixel(e,this.frameState_,n,t,o)}},t.prototype.hasFeatureAtPixel=function(e,t){if(!this.frameState_)return!1;var r=this.getCoordinateFromPixelInternal(e),i=void 0!==(t=void 0!==t?t:{}).layerFilter?t.layerFilter:W,n=void 0!==t.hitTolerance?t.hitTolerance*this.frameState_.pixelRatio:0,o=!1!==t.checkWrapped;return this.renderer_.hasFeatureAtCoordinate(r,this.frameState_,n,o,i,null)},t.prototype.getEventCoordinate=function(e){return this.getCoordinateFromPixel(this.getEventPixel(e))},t.prototype.getEventCoordinateInternal=function(e){return this.getCoordinateFromPixelInternal(this.getEventPixel(e))},t.prototype.getEventPixel=function(e){var t=this.viewport_.getBoundingClientRect(),r="changedTouches"in e?e.changedTouches[0]:e;return[r.clientX-t.left,r.clientY-t.top]},t.prototype.getTarget=function(){return this.get(s.TARGET)},t.prototype.getTargetElement=function(){var e=this.getTarget();return void 0!==e?"string"==typeof e?document.getElementById(e):e:null},t.prototype.getCoordinateFromPixel=function(e){return ec(this.getCoordinateFromPixelInternal(e),this.getView().getProjection())},t.prototype.getCoordinateFromPixelInternal=function(e){var t=this.frameState_;return t?ca(t.pixelToCoordinateTransform,e.slice()):null},t.prototype.getControls=function(){return this.controls},t.prototype.getOverlays=function(){return this.overlays_},t.prototype.getOverlayById=function(e){var t=this.overlayIdIndex_[e.toString()];return void 0!==t?t:null},t.prototype.getInteractions=function(){return this.interactions},t.prototype.getLayerGroup=function(){return this.get(s.LAYERGROUP)},t.prototype.getLayers=function(){return this.getLayerGroup().getLayers()},t.prototype.getLoading=function(){for(var e=this.getLayerGroup().getLayerStatesArray(),t=0,r=e.length;t<r;++t){var i=e[t].layer.getSource();if(i&&i.loading)return!0}return!1},t.prototype.getPixelFromCoordinate=function(e){var t=w(e,this.getView().getProjection());return this.getPixelFromCoordinateInternal(t)},t.prototype.getPixelFromCoordinateInternal=function(e){var t=this.frameState_;return t?ca(t.coordinateToPixelTransform,e.slice(0,2)):null},t.prototype.getRenderer=function(){return this.renderer_},t.prototype.getSize=function(){return this.get(s.SIZE)},t.prototype.getView=function(){return this.get(s.VIEW)},t.prototype.getViewport=function(){return this.viewport_},t.prototype.getOverlayContainer=function(){return this.overlayContainer_},t.prototype.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_},t.prototype.getTilePriority=function(e,t,r,i){var n=this.frameState_;if(!(n&&t in n.wantedTiles))return Fd;if(!n.wantedTiles[t][e.getKey()])return Fd;var o=n.viewState.center,a=r[0]-o[0],s=r[1]-o[1];return 65536*Math.log(i)+Math.sqrt(a*a+s*s)/i},t.prototype.handleBrowserEvent=function(e,t){var r=t||e.type,i=new mf(r,this,e);this.handleMapBrowserEvent(i)},t.prototype.handleMapBrowserEvent=function(e){if(this.frameState_){var t=e.originalEvent.target;if(e.dragging||!this.overlayContainerStopEvent_.contains(t)&&(document.body.contains(t)||this.viewport_.getRootNode&&this.viewport_.getRootNode().contains(t))){e.frameState=this.frameState_;var r=this.getInteractions().getArray();if(!1!==this.dispatchEvent(e))for(var i=r.length-1;i>=0;i--){var n=r[i];if(n.getActive())if(!n.handleEvent(e))break}}}},t.prototype.handlePostRender=function(){var e=this.frameState_,t=this.tileQueue_;if(!t.isEmpty()){var r=this.maxTilesLoading_,i=r;if(e){var n=e.viewHints;if(n[H.ANIMATING]||n[H.INTERACTING]){var o=!oi&&Date.now()-e.time>8;r=o?0:8,i=o?0:2}}t.getTilesLoading()<r&&(t.reprioritize(),t.loadMoreTiles(r,i))}!e||!this.hasListener(_a.RENDERCOMPLETE)||e.animate||this.tileQueue_.getTilesLoading()||this.getLoading()||this.renderer_.dispatchRenderEvent(_a.RENDERCOMPLETE,e);for(var a=this.postRenderFunctions_,s=0,p=a.length;s<p;++s)a[s](this,e);a.length=0},t.prototype.handleSizeChanged_=function(){this.getView()&&this.getView().resolveConstraints(0),this.render()},t.prototype.handleTargetChanged_=function(){var e;if(this.getTarget()&&(e=this.getTargetElement()),this.keyHandlerKeys_){for(var t=0,r=this.keyHandlerKeys_.length;t<r;++t)m(this.keyHandlerKeys_[t]);this.keyHandlerKeys_=null}if(e){e.appendChild(this.viewport_),this.renderer_||(this.renderer_=this.createRenderer());var i=this.keyboardEventTarget_?this.keyboardEventTarget_:e;this.keyHandlerKeys_=[d(i,f.KEYDOWN,this.handleBrowserEvent,this),d(i,f.KEYPRESS,this.handleBrowserEvent,this)],this.handleResize_||(this.handleResize_=this.updateSize.bind(this),window.addEventListener(f.RESIZE,this.handleResize_,!1))}else this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0),gd(this.viewport_),void 0!==this.handleResize_&&(removeEventListener(f.RESIZE,this.handleResize_,!1),this.handleResize_=void 0);this.updateSize()},t.prototype.handleTileChange_=function(){this.render()},t.prototype.handleViewPropertyChanged_=function(){this.render()},t.prototype.handleViewChanged_=function(){this.viewPropertyListenerKey_&&(m(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(m(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var e=this.getView();e&&(this.updateViewportSize_(),this.viewPropertyListenerKey_=d(e,Ya.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=d(e,f.CHANGE,this.handleViewPropertyChanged_,this),e.resolveConstraints(0)),this.render()},t.prototype.handleLayerGroupChanged_=function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(m),this.layerGroupPropertyListenerKeys_=null);var e=this.getLayerGroup();e&&(this.layerGroupPropertyListenerKeys_=[d(e,Ya.PROPERTYCHANGE,this.render,this),d(e,f.CHANGE,this.render,this)]),this.render()},t.prototype.isRendered=function(){return!!this.frameState_},t.prototype.renderSync=function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()},t.prototype.redrawText=function(){for(var e=this.getLayerGroup().getLayerStatesArray(),t=0,r=e.length;t<r;++t){var i=e[t].layer;i.hasRenderer()&&i.getRenderer().handleFontsChanged()}},t.prototype.render=function(){this.renderer_&&void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))},t.prototype.removeControl=function(e){return this.getControls().remove(e)},t.prototype.removeInteraction=function(e){return this.getInteractions().remove(e)},t.prototype.removeLayer=function(e){return this.getLayerGroup().getLayers().remove(e)},t.prototype.removeOverlay=function(e){return this.getOverlays().remove(e)},t.prototype.renderFrame_=function(e){var t=this.getSize(),r=this.getView(),i=this.frameState_,n=null;if(void 0!==t&&Aj(t)&&r&&r.isDef()){var o=r.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=r.getState();n={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterItems:i?i.declutterItems:[],extent:Cf(a.center,a.resolution,a.rotation,t),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:t,tileQueue:this.tileQueue_,time:e,usedTiles:{},viewState:a,viewHints:o,wantedTiles:{}}}if(this.frameState_=n,this.renderer_.renderFrame(n),n){if(n.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,n.postRenderFunctions),i)(!this.previousExtent_||!Ld(this.previousExtent_)&&!db(n.extent,this.previousExtent_))&&(this.dispatchEvent(new Sc(Zb.MOVESTART,this,i)),this.previousExtent_=cb(this.previousExtent_));this.previousExtent_&&!n.viewHints[H.ANIMATING]&&!n.viewHints[H.INTERACTING]&&!db(n.extent,this.previousExtent_)&&(this.dispatchEvent(new Sc(Zb.MOVEEND,this,n)),vf(n.extent,this.previousExtent_))}this.dispatchEvent(new Sc(Zb.POSTRENDER,this,n)),this.postRenderTimeoutHandle_=setTimeout(this.handlePostRender.bind(this),0)},t.prototype.setLayerGroup=function(e){this.set(s.LAYERGROUP,e)},t.prototype.setSize=function(e){this.set(s.SIZE,e)},t.prototype.setTarget=function(e){this.set(s.TARGET,e)},t.prototype.setView=function(e){this.set(s.VIEW,e)},t.prototype.updateSize=function(){var e=this.getTargetElement();if(e){var t=getComputedStyle(e);this.setSize([e.offsetWidth-parseFloat(t.borderLeftWidth)-parseFloat(t.paddingLeft)-parseFloat(t.paddingRight)-parseFloat(t.borderRightWidth),e.offsetHeight-parseFloat(t.borderTopWidth)-parseFloat(t.paddingTop)-parseFloat(t.paddingBottom)-parseFloat(t.borderBottomWidth)])}else this.setSize(void 0);this.updateViewportSize_()},t.prototype.updateViewportSize_=function(){var e=this.getView();if(e){var t=void 0,r=getComputedStyle(this.viewport_);r.width&&r.height&&(t=[parseInt(r.width,10),parseInt(r.height,10)]),e.setViewportSize(t)}},t}(X);function _n(e){var t=null;void 0!==e.keyboardEventTarget&&(t="string"==typeof e.keyboardEventTarget?document.getElementById(e.keyboardEventTarget):e.keyboardEventTarget);var r,i,n,o={},a=e.layers&&"function"==typeof e.layers.getLayers?e.layers:new zj({layers:e.layers});return o[s.LAYERGROUP]=a,o[s.TARGET]=e.target,o[s.VIEW]=void 0!==e.view?e.view:new Zd,void 0!==e.controls&&(Array.isArray(e.controls)?r=new K(e.controls.slice()):(q("function"==typeof e.controls.getArray,47),r=e.controls)),void 0!==e.interactions&&(Array.isArray(e.interactions)?i=new K(e.interactions.slice()):(q("function"==typeof e.interactions.getArray,48),i=e.interactions)),void 0!==e.overlays?Array.isArray(e.overlays)?n=new K(e.overlays.slice()):(q("function"==typeof e.overlays.getArray,49),n=e.overlays):n=new K,{controls:r,interactions:i,keyboardEventTarget:t,overlays:n,values:o}}Hc.default=qg;function ao(o){var i=o||{},r=new K;return(void 0===i.zoom||i.zoom)&&r.push(new Fj(i.zoomOptions)),(void 0===i.rotate||i.rotate)&&r.push(new Dj(i.rotateOptions)),(void 0===i.attribution||i.attribution)&&r.push(new Bj(i.attributionOptions)),r}var _d={};var rg={};var bo=rg&&rg.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),sa=function(e){function t(t){var r=e.call(this)||this;return r.element=t.element?t.element:null,r.target_=null,r.map_=null,r.listenerKeys=[],r.render_=t.render?t.render:Da,t.target&&r.setTarget(t.target),r}return bo(t,e),t.prototype.disposeInternal=function(){gd(this.element),e.prototype.disposeInternal.call(this)},t.prototype.getMap=function(){return this.map_},t.prototype.setMap=function(e){this.map_&&gd(this.element);for(var t=0,r=this.listenerKeys.length;t<r;++t)m(this.listenerKeys[t]);(this.listenerKeys.length=0,this.map_=e,this.map_)&&((this.target_?this.target_:e.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==Da&&this.listenerKeys.push(d(e,Zb.POSTRENDER,this.render,this)),e.render())},t.prototype.render=function(e){this.render_.call(this,e)},t.prototype.setTarget=function(e){this.target_="string"==typeof e?document.getElementById(e):e},t}(X);rg.default=sa;var ae="ol-hidden";var co="ol-selectable";var ta="ol-unselectable";var eo="ol-unsupported";var Hb="ol-control";var be="ol-collapsed";var fo=function(){var $,e={};return function(t){if($||($=document.createElement("div").style),!(t in e)){$.font=t;var S=$.fontFamily,r=$.fontWeight,n=$.fontStyle;if($.font="",!S)return null;var o=S.split(/,\s?/);e[t]={families:o,weight:r,style:n}}return e[t]}}();var ce={};var go=ce&&ce.__extends||function(){var e=function(r,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(r,t)};return function(r,t){function n(){this.constructor=r}e(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),de=function(e){function r(r){var t=this,n=L({},r);delete n.source,(t=e.call(this,n)||this).mapPrecomposeKey_=null,t.mapRenderKey_=null,t.sourceChangeKey_=null,t.renderer_=null,r.render&&(t.render=r.render),r.map&&t.setMap(r.map),t.addEventListener(A(p.SOURCE),t.handleSourcePropertyChange_);var o=r.source?r.source:null;return t.setSource(o),t}return go(r,e),r.prototype.getLayersArray=function(e){var r=e||[];return r.push(this),r},r.prototype.getLayerStatesArray=function(e){var r=e||[];return r.push(this.getLayerState()),r},r.prototype.getSource=function(){return this.get(p.SOURCE)||null},r.prototype.getSourceState=function(){var e=this.getSource();return e?e.getState():jb.UNDEFINED},r.prototype.handleSourceChange_=function(){this.changed()},r.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&(m(this.sourceChangeKey_),this.sourceChangeKey_=null);var e=this.getSource();e&&(this.sourceChangeKey_=d(e,f.CHANGE,this.handleSourceChange_,this)),this.changed()},r.prototype.getFeatures=function(e){return this.renderer_.getFeatures(e)},r.prototype.render=function(e,r){var t=this.getRenderer();if(t.prepareFrame(e))return t.renderFrame(e,r)},r.prototype.setMap=function(e){this.mapPrecomposeKey_&&(m(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(m(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=d(e,_a.PRECOMPOSE,function(e){var r=e.frameState.layerStatesArray,t=this.getLayerState(!1);q(!r.some(function(e){return e.layer===t.layer}),67),r.push(t)},this),this.mapRenderKey_=d(this,f.CHANGE,e.render,e),this.changed())},r.prototype.setSource=function(e){this.set(p.SOURCE,e)},r.prototype.getRenderer=function(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_},r.prototype.hasRenderer=function(){return!!this.renderer_},r.prototype.createRenderer=function(){return null},r.prototype.disposeInternal=function(){this.setSource(null),e.prototype.disposeInternal.call(this)},r}(ng);function hd(e,r){if(!e.visible)return!1;var t=r.resolution;if(t<e.minResolution||t>=e.maxResolution)return!1;var n=r.zoom;return n>e.minZoom&&n<=e.maxZoom}ce.inView=hd,ce.default=de;var ho=_d&&_d.__extends||function(){var e=function(t,l){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var l in t)t.hasOwnProperty(l)&&(e[l]=t[l])})(t,l)};return function(t,l){function r(){this.constructor=t}e(t,l),t.prototype=null===l?Object.create(l):(r.prototype=l.prototype,new r)}}(),Bj=function(e){function t(t){var l=this,r=t||{};(l=e.call(this,{element:document.createElement("div"),render:r.render||Cj,target:r.target})||this).ulElement_=document.createElement("ul"),l.collapsed_=void 0===r.collapsed||r.collapsed,l.overrideCollapsible_=void 0!==r.collapsible,l.collapsible_=void 0===r.collapsible||r.collapsible,l.collapsible_||(l.collapsed_=!1);var o=void 0!==r.className?r.className:"ol-attribution",i=void 0!==r.tipLabel?r.tipLabel:"Attributions",a=void 0!==r.collapseLabel?r.collapseLabel:"\xBB";"string"==typeof a?(l.collapseLabel_=document.createElement("span"),l.collapseLabel_.textContent=a):l.collapseLabel_=a;var s=void 0!==r.label?r.label:"i";"string"==typeof s?(l.label_=document.createElement("span"),l.label_.textContent=s):l.label_=s;var n=l.collapsible_&&!l.collapsed_?l.collapseLabel_:l.label_,p=document.createElement("button");p.setAttribute("type","button"),p.title=i,p.appendChild(n),p.addEventListener(f.CLICK,l.handleClick_.bind(l),!1);var d=o+" "+ta+" "+Hb+(l.collapsed_&&l.collapsible_?" "+be:"")+(l.collapsible_?"":" ol-uncollapsible"),c=l.element;return c.className=d,c.appendChild(l.ulElement_),c.appendChild(p),l.renderedAttributions_=[],l.renderedVisible_=!0,l}return ho(t,e),t.prototype.collectSourceAttributions_=function(e){for(var t={},l=[],r=e.layerStatesArray,o=0,i=r.length;o<i;++o){var a=r[o];if(hd(a,e.viewState)){var s=a.layer.getSource();if(s){var n=s.getAttributions();if(n){var p=n(e);if(p)if(this.overrideCollapsible_||!1!==s.getAttributionsCollapsible()||this.setCollapsible(!1),Array.isArray(p))for(var d=0,c=p.length;d<c;++d)p[d]in t||(l.push(p[d]),t[p[d]]=!0);else p in t||(l.push(p),t[p]=!0)}}}}return l},t.prototype.updateElement_=function(e){if(e){var t=this.collectSourceAttributions_(e),l=t.length>0;if(this.renderedVisible_!=l&&(this.element.style.display=l?"":"none",this.renderedVisible_=l),!$a(t,this.renderedAttributions_)){kg(this.ulElement_);for(var r=0,o=t.length;r<o;++r){var i=document.createElement("li");i.innerHTML=t[r],this.ulElement_.appendChild(i)}this.renderedAttributions_=t}}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)},t.prototype.handleClick_=function(e){e.preventDefault(),this.handleToggle_()},t.prototype.handleToggle_=function(){this.element.classList.toggle(be),this.collapsed_?Gb(this.collapseLabel_,this.label_):Gb(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_},t.prototype.getCollapsible=function(){return this.collapsible_},t.prototype.setCollapsible=function(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),!e&&this.collapsed_&&this.handleToggle_())},t.prototype.setCollapsed=function(e){this.collapsible_&&this.collapsed_!==e&&this.handleToggle_()},t.prototype.getCollapsed=function(){return this.collapsed_},t}(sa);function Cj(e){this.updateElement_(e.frameState)}_d.render=Cj,_d.default=Bj;var ee={};var io=ee&&ee.__extends||function(){var t=function(e,a){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(e,a)};return function(e,a){function r(){this.constructor=e}t(e,a),e.prototype=null===a?Object.create(a):(r.prototype=a.prototype,new r)}}(),Dj=function(t){function e(e){var a=this,r=e||{};a=t.call(this,{element:document.createElement("div"),render:r.render||Ej,target:r.target})||this;var o=void 0!==r.className?r.className:"ol-rotate",i=void 0!==r.label?r.label:"\u21E7";a.label_=null,"string"==typeof i?(a.label_=document.createElement("span"),a.label_.className="ol-compass",a.label_.textContent=i):(a.label_=i,a.label_.classList.add("ol-compass"));var n=r.tipLabel?r.tipLabel:"Reset rotation",s=document.createElement("button");s.className=o+"-reset",s.setAttribute("type","button"),s.title=n,s.appendChild(a.label_),s.addEventListener(f.CLICK,a.handleClick_.bind(a),!1);var l=o+" "+ta+" "+Hb,u=a.element;return u.className=l,u.appendChild(s),a.callResetNorth_=r.resetNorth?r.resetNorth:void 0,a.duration_=void 0!==r.duration?r.duration:250,a.autoHide_=void 0===r.autoHide||r.autoHide,a.rotation_=void 0,a.autoHide_&&a.element.classList.add(ae),a}return io(e,t),e.prototype.handleClick_=function(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()},e.prototype.resetNorth_=function(){var t=this.getMap().getView();if(t){var e=t.getRotation();void 0!==e&&(this.duration_>0&&e%(2*Math.PI)!=0?t.animate({rotation:0,duration:this.duration_,easing:gb}):t.setRotation(0))}},e}(sa);function Ej(t){var e=t.frameState;if(e){var a=e.viewState.rotation;if(a!=this.rotation_){var r="rotate("+a+"rad)";if(this.autoHide_){var o=this.element.classList.contains(ae);o||0!==a?o&&0!==a&&this.element.classList.remove(ae):this.element.classList.add(ae)}this.label_.style.transform=r}this.rotation_=a}}ee.render=Ej,ee.default=Dj;var sg={};var jo=sg&&sg.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),Fj=function(e){function t(t){var o=this,n=t||{};o=e.call(this,{element:document.createElement("div"),target:n.target})||this;var r=void 0!==n.className?n.className:"ol-zoom",a=void 0!==n.delta?n.delta:1,i=void 0!==n.zoomInLabel?n.zoomInLabel:"+",p=void 0!==n.zoomOutLabel?n.zoomOutLabel:"\u2212",l=void 0!==n.zoomInTipLabel?n.zoomInTipLabel:"Zoom in",d=void 0!==n.zoomOutTipLabel?n.zoomOutTipLabel:"Zoom out",s=document.createElement("button");s.className=r+"-in",s.setAttribute("type","button"),s.title=l,s.appendChild("string"==typeof i?document.createTextNode(i):i),s.addEventListener(f.CLICK,o.handleClick_.bind(o,a),!1);var u=document.createElement("button");u.className=r+"-out",u.setAttribute("type","button"),u.title=d,u.appendChild("string"==typeof p?document.createTextNode(p):p),u.addEventListener(f.CLICK,o.handleClick_.bind(o,-a),!1);var $=r+" "+ta+" "+Hb,c=o.element;return c.className=$,c.appendChild(s),c.appendChild(u),o.duration_=void 0!==n.duration?n.duration:250,o}return jo(t,e),t.prototype.handleClick_=function(e,t){t.preventDefault(),this.zoomByDelta_(e)},t.prototype.zoomByDelta_=function(e){var t=this.getMap().getView();if(t){var o=t.getZoom();if(void 0!==o){var n=t.getConstrainedZoom(o+e);this.duration_>0?(t.getAnimating()&&t.cancelAnimations(),t.animate({zoom:n,duration:this.duration_,easing:gb})):t.setZoom(n)}}},t}(sa);sg.default=Fj;var tg={};var ko=tg&&tg.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function l(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(l.prototype=r.prototype,new l)}}(),Gj=["fullscreenchange","webkitfullscreenchange","MSFullscreenChange"],Hj={ENTERFULLSCREEN:"enterfullscreen",LEAVEFULLSCREEN:"leavefullscreen"},lo=function(e){function t(t){var r=this,l=t||{};(r=e.call(this,{element:document.createElement("div"),target:l.target})||this).cssClassName_=void 0!==l.className?l.className:"ol-full-screen";var s=void 0!==l.label?l.label:"\u2922";r.labelNode_="string"==typeof s?document.createTextNode(s):s;var n=void 0!==l.labelActive?l.labelActive:"\xD7";r.labelActiveNode_="string"==typeof n?document.createTextNode(n):n,r.button_=document.createElement("button");var a=l.tipLabel?l.tipLabel:"Toggle full-screen";r.setClassName_(r.button_,ug()),r.button_.setAttribute("type","button"),r.button_.title=a,r.button_.appendChild(r.labelNode_),r.button_.addEventListener(f.CLICK,r.handleClick_.bind(r),!1);var u=r.cssClassName_+" "+ta+" "+Hb+" "+(Ij()?"":eo),c=r.element;return c.className=u,c.appendChild(r.button_),r.keys_=void 0!==l.keys&&l.keys,r.source_=l.source,r}return ko(t,e),t.prototype.handleClick_=function(e){e.preventDefault(),this.handleFullScreen_()},t.prototype.handleFullScreen_=function(){if(Ij()){var e=this.getMap();if(e)if(ug())no();else{var t=void 0;t=this.source_?"string"==typeof this.source_?document.getElementById(this.source_):this.source_:e.getTargetElement(),this.keys_?mo(t):Jj(t)}}},t.prototype.handleFullScreenChange_=function(){var e=this.getMap();ug()?(this.setClassName_(this.button_,!0),Gb(this.labelActiveNode_,this.labelNode_),this.dispatchEvent(Hj.ENTERFULLSCREEN)):(this.setClassName_(this.button_,!1),Gb(this.labelNode_,this.labelActiveNode_),this.dispatchEvent(Hj.LEAVEFULLSCREEN)),e&&e.updateSize()},t.prototype.setClassName_=function(e,t){var r=this.cssClassName_+"-true",l=this.cssClassName_+"-false",s=t?r:l;e.classList.remove(r),e.classList.remove(l),e.classList.add(s)},t.prototype.setMap=function(t){if(e.prototype.setMap.call(this,t),t)for(var r=0,l=Gj.length;r<l;++r)this.listenerKeys.push(d(document,Gj[r],this.handleFullScreenChange_,this))},t}(sa);function Ij(){var e=document.body;return!!(e.webkitRequestFullscreen||e.msRequestFullscreen&&document.msFullscreenEnabled||e.requestFullscreen&&document.fullscreenEnabled)}function ug(){return!!(document.webkitIsFullScreen||document.msFullscreenElement||document.fullscreenElement)}function Jj(e){e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()}function mo(e){e.webkitRequestFullscreen?e.webkitRequestFullscreen():Jj(e)}function no(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}tg.default=lo;var fe={};var oo=fe&&fe.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),vg="projection",Kj="coordinateFormat",po=function(t){function e(e){var r=this,o=e||{},n=document.createElement("div");return n.className=void 0!==o.className?o.className:"ol-mouse-position",(r=t.call(this,{element:n,render:o.render||Lj,target:o.target})||this).addEventListener(A(vg),r.handleProjectionChanged_),o.coordinateFormat&&r.setCoordinateFormat(o.coordinateFormat),o.projection&&r.setProjection(o.projection),r.undefinedHTML_=void 0!==o.undefinedHTML?o.undefinedHTML:"&#160;",r.renderOnMouseOut_=!!r.undefinedHTML_,r.renderedHTML_=n.innerHTML,r.mapProjection_=null,r.transform_=null,r}return oo(e,t),e.prototype.handleProjectionChanged_=function(){this.transform_=null},e.prototype.getCoordinateFormat=function(){return this.get(Kj)},e.prototype.getProjection=function(){return this.get(vg)},e.prototype.handleMouseMove=function(t){var e=this.getMap();this.updateHTML_(e.getEventPixel(t))},e.prototype.handleMouseOut=function(t){this.updateHTML_(null)},e.prototype.setMap=function(e){if(t.prototype.setMap.call(this,e),e){var r=e.getViewport();this.listenerKeys.push(d(r,Ga.POINTERMOVE,this.handleMouseMove,this)),this.renderOnMouseOut_&&this.listenerKeys.push(d(r,Ga.POINTEROUT,this.handleMouseOut,this))}},e.prototype.setCoordinateFormat=function(t){this.set(Kj,t)},e.prototype.setProjection=function(t){this.set(vg,E(t))},e.prototype.updateHTML_=function(t){var e=this.undefinedHTML_;if(t&&this.mapProjection_){if(!this.transform_){var r=this.getProjection();this.transform_=r?La(this.mapProjection_,r):Mf}var o=this.getMap().getCoordinateFromPixelInternal(t);if(o){var n=ib();n&&(this.transform_=La(this.mapProjection_,n)),this.transform_(o,o);var a=this.getCoordinateFormat();e=a?a(o):o.toString()}}this.renderedHTML_&&e===this.renderedHTML_||(this.element.innerHTML=e,this.renderedHTML_=e)},e}(sa);function Lj(t){var e=t.frameState;e?this.mapProjection_!=e.viewState.projection&&(this.mapProjection_=e.viewState.projection,this.transform_=null):this.mapProjection_=null}fe.render=Lj,fe.default=po;var ge={};var wg={};var xg={};var qo=xg&&xg.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),yg=function(t){function e(e,r,n,o){var $=t.call(this,e)||this;return $.inversePixelTransform=r,$.frameState=n,$.context=o,$}return qo(e,t),e}(T);xg.default=yg;var zg={};var ro=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,so=/^([a-z]*)$|^hsla?\(.*\)$/i;function to(r){return"string"==typeof r?r:Nj(r)}function uo(r){var $=document.createElement("div");if($.style.color=r,""!==$.style.color){document.body.appendChild($);var a=getComputedStyle($).color;return document.body.removeChild($),a}return""}var vo=function(){var r={},$=0;return function(a){var t;if(r.hasOwnProperty(a))t=r[a];else{if($>=1024){var e=0;for(var X in r)0==(3&e++)&&(delete r[X],--$)}t=wo(a),r[a]=t,++$}return t}}();function Ag(r){return Array.isArray(r)?r:vo(r)}function wo(r){var $,a,t,e,X;if(so.exec(r)&&(r=uo(r)),ro.exec(r)){var o=r.length-1,n=void 0;n=o<=4?1:2;var i=4===o||8===o;$=parseInt(r.substr(1+0*n,n),16),a=parseInt(r.substr(1+1*n,n),16),t=parseInt(r.substr(1+2*n,n),16),e=i?parseInt(r.substr(1+3*n,n),16):255,1==n&&($=($<<4)+$,a=(a<<4)+a,t=(t<<4)+t,i&&(e=(e<<4)+e)),X=[$,a,t,e/255]}else 0==r.indexOf("rgba(")?Mj(X=r.slice(5,-1).split(",").map(Number)):0==r.indexOf("rgb(")?((X=r.slice(4,-1).split(",").map(Number)).push(1),Mj(X)):q(!1,14);return X}function Mj(r){return r[0]=F(r[0]+.5|0,0,255),r[1]=F(r[1]+.5|0,0,255),r[2]=F(r[2]+.5|0,0,255),r[3]=F(r[3],0,1),r}function Nj(r){var $=r[0];$!=(0|$)&&($=$+.5|0);var a=r[1];a!=(0|a)&&(a=a+.5|0);var t=r[2];return t!=(0|t)&&(t=t+.5|0),"rgba("+$+","+a+","+t+","+(void 0===r[3]?1:r[3])+")"}var xo=function(){function e(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}return e.prototype.clear=function(){this.cache_={},this.cacheSize_=0},e.prototype.canExpireCache=function(){return this.cacheSize_>this.maxCacheSize_},e.prototype.expire=function(){if(this.canExpireCache()){var e=0;for(var t in this.cache_){var r=this.cache_[t];0!=(3&e++)||r.hasListener()||(delete this.cache_[t],--this.cacheSize_)}}},e.prototype.get=function(e,t,r){var i=Oj(e,t,r);return i in this.cache_?this.cache_[i]:null},e.prototype.set=function(e,t,r,i){var a=Oj(e,t,r);this.cache_[a]=i,++this.cacheSize_},e.prototype.setSize=function(e){this.maxCacheSize_=e,this.expire()},e}();function Oj(e,t,r){return t+":"+e+":"+(r?to(r):"null")}var he=new xo;var kc={};function yo(e,r){var t=e.canvas,$=r||{},o=$.pixelRatio||Uc,l=$.size;l&&(t.width=l[0]*o,t.height=l[1]*o,t.style.width=l[0]+"px",t.style.height=l[1]+"px");var i=[0,0,t.width,t.height],n=Xf(G(),o,o);return new ne(e,o,i,n,0)}function zo(e){var r,t=e.frameState,$=gc(e.inversePixelTransform.slice(),t.coordinateToPixelTransform),o=Xj(t.viewState.resolution,t.pixelRatio),l=ib();return l&&(r=La(l,t.viewState.projection)),new ne(e.context,t.pixelRatio,t.extent,$,t.viewState.rotation,o,r)}function Ao(e,r){var t=r.slice(0);return ca(e.inversePixelTransform.slice(),t),t}function Pj(e,r){r&&r.clear();for(var t=e.declutterItems,$=t.length-1;$>=0;--$)for(var o=t[$],l=o.items,i=0,n=l.length;i<n;i+=3)r=l[i].renderDeclutter(l[i+1],l[i+2],o.opacity,r);return t.length=0,r}var Bg={};function ua(r){return Array.isArray(r)?Nj(r):r}var Qj=function(){function t(){}return t.prototype.drawCustom=function(t,o,e){},t.prototype.drawGeometry=function(t){},t.prototype.setStyle=function(t){},t.prototype.drawCircle=function(t,o){},t.prototype.drawFeature=function(t,o){},t.prototype.drawGeometryCollection=function(t,o){},t.prototype.drawLineString=function(t,o){},t.prototype.drawMultiLineString=function(t,o){},t.prototype.drawMultiPoint=function(t,o){},t.prototype.drawMultiPolygon=function(t,o){},t.prototype.drawPoint=function(t,o){},t.prototype.drawPolygon=function(t,o){},t.prototype.drawText=function(t,o){},t.prototype.setFillStrokeStyle=function(t,o){},t.prototype.setImageStyle=function(t,o){},t.prototype.setTextStyle=function(t,o){},t}();var Rj="10px sans-serif";var Sa="#000";var lc="round";var ie=[];var je=0;var mc="round";var id=10;var jd="#000";var kd="center";var ke="middle";var nc=[0,0,0,0];var ld=1;var Ta=new X;var Bo=new Xb;Bo.setSize=function(){console.warn("labelCache is deprecated.")};var Co,le=null,Sj={};var Do=function(){var e,t,$=100,r="32px ",a=["monospace","serif"],o=a.length,n="wmytzilWMYTZIL@#/&?$%10\uF013";function s(e,$,s){for(var i=!0,x=0;x<o;++x){var p=a[x];if(t=me(e+" "+$+" "+r+p,n),s!=p){var l=me(e+" "+$+" "+r+s+","+p,n);i=i&&l!=t}}return!!i}function i(){for(var t=!0,r=Ta.getKeys(),a=0,o=r.length;a<o;++a){var n=r[a];Ta.get(n)<$&&(s.apply(this,n.split("\n"))?(Za(Sj),le=null,Co=void 0,Ta.set(n,$)):(Ta.set(n,Ta.get(n)+1,!0),t=!1))}t&&(clearInterval(e),e=void 0)}return function(t){var r=fo(t);if(r)for(var a=r.families,o=0,n=a.length;o<n;++o){var x=a[o],p=r.style+"\n"+r.weight+"\n"+x;void 0===Ta.get(p)&&(Ta.set(p,$,!0),s(r.style,r.weight,x)||(Ta.set(p,0,!0),void 0===e&&(e=setInterval(i,32))))}}}();var Eo=function(){var e,t=Sj;return function($){var r=t[$];return null==r&&(e||((e=document.createElement("div")).innerHTML="M",e.style.margin="0 !important",e.style.padding="0 !important",e.style.position="absolute !important",e.style.left="-99999px !important"),e.style.font=$,document.body.appendChild(e),r=e.offsetHeight,t[$]=r,document.body.removeChild(e)),r}}();function me(e,t){return le||(le=Z(1,1)),e!=Co&&(le.font=e,Co=le.font),le.measureText(t).width}function Tj(e,t,$){if(t in $)return $[t];var r=me(e,t);return $[t]=r,r}function Fo(e,t,$){for(var r=t.length,a=0,o=0;o<r;++o){var n=me(e,t[o]);a=Math.max(a,n),$.push(n)}return a}function Uj(e,t,$,r){0!==t&&(e.translate($,r),e.rotate(t),e.translate(-$,-r))}function Vj(e,t,$,r,a,o,n,s,i,x,p){e.save(),1!==$&&(e.globalAlpha*=$),t&&e.setTransform.apply(e,t),r.contextInstructions?(e.translate(i,x),e.scale(p,p),Go(r,e)):e.drawImage(r,a,o,n,s,i,x,n*p,s*p),e.restore()}function Go(e,t){for(var $=e.contextInstructions,r=0,a=$.length;r<a;r+=2)Array.isArray($[r+1])?CanvasRenderingContext2D.prototype[$[r]].apply(t,$[r+1]):t[$[r]]=$[r+1]}var Ho=Bg&&Bg.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),ne=function(t){function e(e,i,o,a,r,n,s){var l=t.call(this)||this;return l.context_=e,l.pixelRatio_=i,l.extent_=o,l.transform_=a,l.viewRotation_=r,l.squaredTolerance_=n,l.userTransform_=s,l.contextFillState_=null,l.contextStrokeState_=null,l.contextTextState_=null,l.fillState_=null,l.strokeState_=null,l.image_=null,l.imageAnchorX_=0,l.imageAnchorY_=0,l.imageHeight_=0,l.imageOpacity_=0,l.imageOriginX_=0,l.imageOriginY_=0,l.imageRotateWithView_=!1,l.imageRotation_=0,l.imageScale_=0,l.imageWidth_=0,l.text_="",l.textOffsetX_=0,l.textOffsetY_=0,l.textRotateWithView_=!1,l.textRotation_=0,l.textScale_=0,l.textFillState_=null,l.textStrokeState_=null,l.textState_=null,l.pixelCoordinates_=[],l.tmpLocalTransform_=G(),l}return Ho(e,t),e.prototype.drawImages_=function(t,e,i,o){if(this.image_){var a=Ab(t,e,i,2,this.transform_,this.pixelCoordinates_),r=this.context_,n=this.tmpLocalTransform_,s=r.globalAlpha;1!=this.imageOpacity_&&(r.globalAlpha=s*this.imageOpacity_);var l=this.imageRotation_;this.imageRotateWithView_&&(l+=this.viewRotation_);for(var h=0,_=a.length;h<_;h+=2){var x=a[h]-this.imageAnchorX_,f=a[h+1]-this.imageAnchorY_;if(0!==l||1!=this.imageScale_){var m=x+this.imageAnchorX_,p=f+this.imageAnchorY_;ga(n,m,p,this.imageScale_,this.imageScale_,l,-m,-p),r.setTransform.apply(r,n)}r.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,x,f,this.imageWidth_,this.imageHeight_)}0===l&&1==this.imageScale_||r.setTransform(1,0,0,1,0,0),1!=this.imageOpacity_&&(r.globalAlpha=s)}},e.prototype.drawText_=function(t,e,i,o){if(this.textState_&&""!==this.text_){this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);var a=Ab(t,e,i,o,this.transform_,this.pixelCoordinates_),r=this.context_,n=this.textRotation_;for(this.textRotateWithView_&&(n+=this.viewRotation_);e<i;e+=o){var s=a[e]+this.textOffsetX_,l=a[e+1]+this.textOffsetY_;if(0!==n||1!=this.textScale_){var h=ga(this.tmpLocalTransform_,s,l,this.textScale_,this.textScale_,n,-s,-l);r.setTransform.apply(r,h)}this.textStrokeState_&&r.strokeText(this.text_,s,l),this.textFillState_&&r.fillText(this.text_,s,l)}0===n&&1==this.textScale_||r.setTransform(1,0,0,1,0,0)}},e.prototype.moveToLineTo_=function(t,e,i,o,a){var r=this.context_,n=Ab(t,e,i,o,this.transform_,this.pixelCoordinates_);r.moveTo(n[0],n[1]);var s=n.length;a&&(s-=2);for(var l=2;l<s;l+=2)r.lineTo(n[l],n[l+1]);return a&&r.closePath(),i},e.prototype.drawRings_=function(t,e,i,o){for(var a=0,r=i.length;a<r;++a)e=this.moveToLineTo_(t,e,i[a],o,!0);return e},e.prototype.drawCircle=function(t){if(ea(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=fj(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],o=e[3]-e[1],a=Math.sqrt(i*i+o*o),r=this.context_;r.beginPath(),r.arc(e[0],e[1],a,0,2*Math.PI),this.fillState_&&r.fill(),this.strokeState_&&r.stroke()}""!==this.text_&&this.drawText_(t.getCenter(),0,2,2)}},e.prototype.setStyle=function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())},e.prototype.setTransform=function(t){this.transform_=t},e.prototype.drawGeometry=function(t){switch(t.getType()){case k.POINT:this.drawPoint(t);break;case k.LINE_STRING:this.drawLineString(t);break;case k.POLYGON:this.drawPolygon(t);break;case k.MULTI_POINT:this.drawMultiPoint(t);break;case k.MULTI_LINE_STRING:this.drawMultiLineString(t);break;case k.MULTI_POLYGON:this.drawMultiPolygon(t);break;case k.GEOMETRY_COLLECTION:this.drawGeometryCollection(t);break;case k.CIRCLE:this.drawCircle(t);}},e.prototype.drawFeature=function(t,e){var i=e.getGeometryFunction()(t);i&&ea(this.extent_,i.getExtent())&&(this.setStyle(e),this.drawGeometry(i))},e.prototype.drawGeometryCollection=function(t){for(var e=t.getGeometriesArray(),i=0,o=e.length;i<o;++i)this.drawGeometry(e[i])},e.prototype.drawPoint=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)},e.prototype.drawMultiPoint=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),""!==this.text_&&this.drawText_(e,0,e.length,i)},e.prototype.drawLineString=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),ea(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(""!==this.text_){var o=t.getFlatMidpoint();this.drawText_(o,0,2,2)}}},e.prototype.drawMultiLineString=function(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));var e=t.getExtent();if(ea(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var i=this.context_,o=t.getFlatCoordinates(),a=0,r=t.getEnds(),n=t.getStride();i.beginPath();for(var s=0,l=r.length;s<l;++s)a=this.moveToLineTo_(o,a,r[s],n,!1);i.stroke()}if(""!==this.text_){var h=t.getFlatMidpoints();this.drawText_(h,0,h.length,2)}}},e.prototype.drawPolygon=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),ea(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var i=t.getFlatInteriorPoint();this.drawText_(i,0,2,2)}}},e.prototype.drawMultiPolygon=function(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),ea(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_,i=t.getOrientedFlatCoordinates(),o=0,a=t.getEndss(),r=t.getStride();e.beginPath();for(var n=0,s=a.length;n<s;++n){var l=a[n];o=this.drawRings_(i,o,l,r)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var h=t.getFlatInteriorPoints();this.drawText_(h,0,h.length,2)}}},e.prototype.setContextFillState_=function(t){var e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})},e.prototype.setContextStrokeState_=function(t){var e=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=t.lineCap,e.lineCap=t.lineCap),e.setLineDash&&($a(i.lineDash,t.lineDash)||e.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset)),i.lineJoin!=t.lineJoin&&(i.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})},e.prototype.setContextTextState_=function(t){var e=this.context_,i=this.contextTextState_,o=t.textAlign?t.textAlign:kd;i?(i.font!=t.font&&(i.font=t.font,e.font=t.font),i.textAlign!=o&&(i.textAlign=o,e.textAlign=o),i.textBaseline!=t.textBaseline&&(i.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=o,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:o,textBaseline:t.textBaseline})},e.prototype.setFillStrokeStyle=function(t,e){if(t){var i=t.getColor();this.fillState_={fillStyle:ua(i||Sa)}}else this.fillState_=null;if(e){var o=e.getColor(),a=e.getLineCap(),r=e.getLineDash(),n=e.getLineDashOffset(),s=e.getLineJoin(),l=e.getWidth(),h=e.getMiterLimit();this.strokeState_={lineCap:void 0!==a?a:lc,lineDash:r||ie,lineDashOffset:n||je,lineJoin:void 0!==s?s:mc,lineWidth:this.pixelRatio_*(void 0!==l?l:ld),miterLimit:void 0!==h?h:id,strokeStyle:ua(o||jd)}}else this.strokeState_=null},e.prototype.setImageStyle=function(t){if(t){var e=t.getAnchor(),i=t.getImage(1),o=t.getOrigin(),a=t.getSize();this.imageAnchorX_=e[0],this.imageAnchorY_=e[1],this.imageHeight_=a[1],this.image_=i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=o[0],this.imageOriginY_=o[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation(),this.imageScale_=t.getScale()*this.pixelRatio_,this.imageWidth_=a[0]}else this.image_=null},e.prototype.setTextStyle=function(t){if(t){var e=t.getFill();if(e){var i=e.getColor();this.textFillState_={fillStyle:ua(i||Sa)}}else this.textFillState_=null;var o=t.getStroke();if(o){var a=o.getColor(),r=o.getLineCap(),n=o.getLineDash(),s=o.getLineDashOffset(),l=o.getLineJoin(),h=o.getWidth(),_=o.getMiterLimit();this.textStrokeState_={lineCap:void 0!==r?r:lc,lineDash:n||ie,lineDashOffset:s||je,lineJoin:void 0!==l?l:mc,lineWidth:void 0!==h?h:ld,miterLimit:void 0!==_?_:id,strokeStyle:ua(a||jd)}}else this.textStrokeState_=null;var x=t.getFont(),f=t.getOffsetX(),m=t.getOffsetY(),p=t.getRotateWithView(),g=t.getRotation(),$=t.getScale(),S=t.getText(),c=t.getTextAlign(),d=t.getTextBaseline();this.textState_={font:void 0!==x?x:Rj,textAlign:void 0!==c?c:kd,textBaseline:void 0!==d?d:ke},this.text_=void 0!==S?S:"",this.textOffsetX_=void 0!==f?this.pixelRatio_*f:0,this.textOffsetY_=void 0!==m?this.pixelRatio_*m:0,this.textRotateWithView_=void 0!==p&&p,this.textRotation_=void 0!==g?g:0,this.textScale_=this.pixelRatio_*(void 0!==$?$:1)}else this.text_=""},e}(Qj);Bg.default=ne;var Cg={},x={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};Cg.default=x;var y={CIRCLE:"Circle",DEFAULT:"Default",IMAGE:"Image",LINE_STRING:"LineString",POLYGON:"Polygon",TEXT:"Text"};var Io=.5,Wj={Point:Qo,LineString:No,Polygon:So,MultiPoint:Ro,MultiLineString:Oo,MultiPolygon:Po,GeometryCollection:Mo,Circle:Ko};function Jo(e,r){return parseInt(aa(e),10)-parseInt(aa(r),10)}function Xj(e,r){var t=Yj(e,r);return t*t}function Yj(e,r){return Io*e/r}function Ko(e,r,t,i){var o=t.getFill(),$=t.getStroke();if(o||$){var a=e.getBuilder(t.getZIndex(),y.CIRCLE);a.setFillStrokeStyle(o,$),a.drawCircle(r,i)}var n=t.getText();if(n){var l=e.getBuilder(t.getZIndex(),y.TEXT);l.setTextStyle(n,e.addDeclutter(!1)),l.drawText(r,i)}}function Zj(e,r,t,i,o,$){var a=!1,n=t.getImage();if(n){var l=n.getImageState();l==x.LOADED||l==x.ERROR?n.unlistenImageChange(o):(l==x.IDLE&&n.load(),l=n.getImageState(),n.listenImageChange(o),a=!0)}return Lo(e,r,t,i,$),a}function Lo(e,r,t,i,o){var $=t.getGeometryFunction()(r);if($){var a=$.simplifyTransformed(i,o);if(t.getRenderer())$j(e,a,t,r);else(0,Wj[a.getType()])(e,a,t,r)}}function $j(e,r,t,i){if(r.getType()!=k.GEOMETRY_COLLECTION)e.getBuilder(t.getZIndex(),y.DEFAULT).drawCustom(r,i,t.getRenderer());else for(var o=r.getGeometries(),$=0,a=o.length;$<a;++$)$j(e,o[$],t,i)}function Mo(e,r,t,i){var o,$,a=r.getGeometriesArray();for(o=0,$=a.length;o<$;++o){(0,Wj[a[o].getType()])(e,a[o],t,i)}}function No(e,r,t,i){var o=t.getStroke();if(o){var $=e.getBuilder(t.getZIndex(),y.LINE_STRING);$.setFillStrokeStyle(null,o),$.drawLineString(r,i)}var a=t.getText();if(a){var n=e.getBuilder(t.getZIndex(),y.TEXT);n.setTextStyle(a,e.addDeclutter(!1)),n.drawText(r,i)}}function Oo(e,r,t,i){var o=t.getStroke();if(o){var $=e.getBuilder(t.getZIndex(),y.LINE_STRING);$.setFillStrokeStyle(null,o),$.drawMultiLineString(r,i)}var a=t.getText();if(a){var n=e.getBuilder(t.getZIndex(),y.TEXT);n.setTextStyle(a,e.addDeclutter(!1)),n.drawText(r,i)}}function Po(e,r,t,i){var o=t.getFill(),$=t.getStroke();if($||o){var a=e.getBuilder(t.getZIndex(),y.POLYGON);a.setFillStrokeStyle(o,$),a.drawMultiPolygon(r,i)}var n=t.getText();if(n){var l=e.getBuilder(t.getZIndex(),y.TEXT);l.setTextStyle(n,e.addDeclutter(!1)),l.drawText(r,i)}}function Qo(e,r,t,i){var o=t.getImage();if(o){if(o.getImageState()!=x.LOADED)return;var $=e.getBuilder(t.getZIndex(),y.IMAGE);$.setImageStyle(o,e.addDeclutter(!1)),$.drawPoint(r,i)}var a=t.getText();if(a){var n=e.getBuilder(t.getZIndex(),y.TEXT);n.setTextStyle(a,e.addDeclutter(!!o)),n.drawText(r,i)}}function Ro(e,r,t,i){var o=t.getImage();if(o){if(o.getImageState()!=x.LOADED)return;var $=e.getBuilder(t.getZIndex(),y.IMAGE);$.setImageStyle(o,e.addDeclutter(!1)),$.drawMultiPoint(r,i)}var a=t.getText();if(a){var n=e.getBuilder(t.getZIndex(),y.TEXT);n.setTextStyle(a,e.addDeclutter(!!o)),n.drawText(r,i)}}function So(e,r,t,i){var o=t.getFill(),$=t.getStroke();if(o||$){var a=e.getBuilder(t.getZIndex(),y.POLYGON);a.setFillStrokeStyle(o,$),a.drawPolygon(r,i)}var n=t.getText();if(n){var l=e.getBuilder(t.getZIndex(),y.TEXT);l.setTextStyle(n,e.addDeclutter(!1)),l.drawText(r,i)}}kc.toContext=yo,kc.getVectorContext=zo,kc.getRenderPixel=Ao,kc.renderDeclutterItems=Pj;var To=zg&&zg.__extends||function(){var e=function(r,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(r,t)};return function(r,t){function o(){this.constructor=r}e(r,t),r.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),_j=function(e){function r(r){var t=e.call(this)||this;return t.map_=r,t.declutterTree_=null,t}return To(r,e),r.prototype.dispatchRenderEvent=function(e,r){h()},r.prototype.calculateMatrices2D=function(e){var r=e.viewState,t=e.coordinateToPixelTransform,o=e.pixelToCoordinateTransform;ga(t,e.size[0]/2,e.size[1]/2,1/r.resolution,-1/r.resolution,-r.rotation,-r.center[0],-r.center[1]),ic(o,t)},r.prototype.forEachFeatureAtCoordinate=function(e,r,t,o,n,a,i,c){var $,p=r.viewState;function f(e,r,t){return n.call(a,r,e?t:null)}var u=p.projection,s=e,l=[[0,0]];if(u.canWrapX()){var C=u.getExtent(),b=ka(C),R=e[0];if(R<C[0]||R>C[2])s=[R+b*Math.ceil((C[0]-R)/b),e[1]];o&&l.push([-b,0],[b,0])}var h,d=r.layerStatesArray,m=d.length;this.declutterTree_&&(h=this.declutterTree_.all().map(function(e){return e.value}));for(var v=[],y=0;y<l.length;y++)for(var _=m-1;_>=0;--_){var x=d[_],g=x.layer;if(g.hasRenderer()&&hd(x,p)&&i.call(c,g)){var j=g.getRenderer(),T=g.getSource();if(j&&T){var E=T.getWrapX()?s:e,I=f.bind(null,x.managed);v[0]=E[0]+l[y][0],v[1]=E[1]+l[y][1],$=j.forEachFeatureAtCoordinate(v,r,t,I,h)}if($)return $}}},r.prototype.forEachLayerAtPixel=function(e,r,t,o,n){return h()},r.prototype.hasFeatureAtCoordinate=function(e,r,t,o,n,a){return void 0!==this.forEachFeatureAtCoordinate(e,r,t,o,W,this,n,a)},r.prototype.getMap=function(){return this.map_},r.prototype.renderFrame=function(e){this.declutterTree_=Pj(e,this.declutterTree_)},r.prototype.scheduleExpireIconCache=function(e){he.canExpireCache()&&e.postRenderFunctions.push(Uo)},r}(Nc);function Uo(e,r){he.expire()}zg.default=_j;var Vo=wg&&wg.__extends||function(){var e=function(r,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(r,t)};return function(r,t){function n(){this.constructor=r}e(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Dg=function(e){function r(r){var t=e.call(this,r)||this;t.fontChangeListenerKey_=d(Ta,Ya.PROPERTYCHANGE,r.redrawText.bind(r)),t.element_=document.createElement("div");var n=t.element_.style;n.position="absolute",n.width="100%",n.height="100%",n.zIndex="0",t.element_.className=ta+" ol-layers";var i=r.getViewport();return i.insertBefore(t.element_,i.firstChild||null),t.children_=[],t.renderedVisible_=!0,t}return Vo(r,e),r.prototype.dispatchRenderEvent=function(e,r){var t=this.getMap();if(t.hasListener(e)){var n=new yg(e,void 0,r);t.dispatchEvent(n)}},r.prototype.disposeInternal=function(){m(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),e.prototype.disposeInternal.call(this)},r.prototype.renderFrame=function(r){if(r){this.calculateMatrices2D(r),this.dispatchRenderEvent(_a.PRECOMPOSE,r);var t=r.layerStatesArray.sort(function(e,r){return e.zIndex-r.zIndex}),n=r.viewState;this.children_.length=0;for(var i=null,a=0,s=t.length;a<s;++a){var o=t[a];if(r.layerIndex=a,hd(o,n)&&(o.sourceState==jb.READY||o.sourceState==jb.UNDEFINED)){var h=o.layer.render(r,i);h&&h!==i&&(this.children_.push(h),i=h)}}e.prototype.renderFrame.call(this,r),yj(this.element_,this.children_),this.dispatchRenderEvent(_a.POSTCOMPOSE,r),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(r)}else this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1)},r.prototype.forEachLayerAtPixel=function(e,r,t,n,i){for(var a=r.viewState,s=r.layerStatesArray,o=s.length-1;o>=0;--o){var h=s[o],$=h.layer;if($.hasRenderer()&&hd(h,a)&&i($)){var l=$.getRenderer().getDataAtPixel(e,r,t);if(l){var p=n($,l);if(p)return p}}}},r}(_j);wg.default=Dg;var md={};var V={BOTTOM_LEFT:"bottom-left",BOTTOM_CENTER:"bottom-center",BOTTOM_RIGHT:"bottom-right",CENTER_LEFT:"center-left",CENTER_CENTER:"center-center",CENTER_RIGHT:"center-right",TOP_LEFT:"top-left",TOP_CENTER:"top-center",TOP_RIGHT:"top-right"};var Wo=md&&md.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),M={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"},ak=function(t){function e(e){var i=t.call(this)||this;return i.options=e,i.id=e.id,i.insertFirst=void 0===e.insertFirst||e.insertFirst,i.stopEvent=void 0===e.stopEvent||e.stopEvent,i.element=document.createElement("div"),i.element.className=void 0!==e.className?e.className:"ol-overlay-container "+co,i.element.style.position="absolute",i.autoPan=void 0!==e.autoPan&&e.autoPan,i.autoPanAnimation=e.autoPanAnimation||{},i.autoPanMargin=void 0!==e.autoPanMargin?e.autoPanMargin:20,i.rendered={bottom_:"",left_:"",right_:"",top_:"",visible:!0},i.mapPostrenderListenerKey=null,i.addEventListener(A(M.ELEMENT),i.handleElementChanged),i.addEventListener(A(M.MAP),i.handleMapChanged),i.addEventListener(A(M.OFFSET),i.handleOffsetChanged),i.addEventListener(A(M.POSITION),i.handlePositionChanged),i.addEventListener(A(M.POSITIONING),i.handlePositioningChanged),void 0!==e.element&&i.setElement(e.element),i.setOffset(void 0!==e.offset?e.offset:[0,0]),i.setPositioning(void 0!==e.positioning?e.positioning:V.TOP_LEFT),void 0!==e.position&&i.setPosition(e.position),i}return Wo(e,t),e.prototype.getElement=function(){return this.get(M.ELEMENT)},e.prototype.getId=function(){return this.id},e.prototype.getMap=function(){return this.get(M.MAP)},e.prototype.getOffset=function(){return this.get(M.OFFSET)},e.prototype.getPosition=function(){return this.get(M.POSITION)},e.prototype.getPositioning=function(){return this.get(M.POSITIONING)},e.prototype.handleElementChanged=function(){kg(this.element);var t=this.getElement();t&&this.element.appendChild(t)},e.prototype.handleMapChanged=function(){this.mapPostrenderListenerKey&&(gd(this.element),m(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);var t=this.getMap();if(t){this.mapPostrenderListenerKey=d(t,Zb.POSTRENDER,this.render,this),this.updatePixelPosition();var e=this.stopEvent?t.getOverlayContainerStopEvent():t.getOverlayContainer();this.insertFirst?e.insertBefore(this.element,e.childNodes[0]||null):e.appendChild(this.element)}},e.prototype.render=function(){this.updatePixelPosition()},e.prototype.handleOffsetChanged=function(){this.updatePixelPosition()},e.prototype.handlePositionChanged=function(){this.updatePixelPosition(),this.get(M.POSITION)&&this.autoPan&&this.panIntoView()},e.prototype.handlePositioningChanged=function(){this.updatePixelPosition()},e.prototype.setElement=function(t){this.set(M.ELEMENT,t)},e.prototype.setMap=function(t){this.set(M.MAP,t)},e.prototype.setOffset=function(t){this.set(M.OFFSET,t)},e.prototype.setPosition=function(t){this.set(M.POSITION,t)},e.prototype.panIntoView=function(){var t=this.getMap();if(t&&t.getTargetElement()){var e=this.getRect(t.getTargetElement(),t.getSize()),i=this.getElement(),n=this.getRect(i,[wj(i),xj(i)]),o=this.autoPanMargin;if(!ra(e,n)){var r=n[0]-e[0],s=e[2]-n[2],a=n[1]-e[1],p=e[3]-n[3],$=[0,0];if(r<0?$[0]=r-o:s<0&&($[0]=Math.abs(s)+o),a<0?$[1]=a-o:p<0&&($[1]=Math.abs(p)+o),0!==$[0]||0!==$[1]){var u=t.getView().getCenterInternal(),d=t.getPixelFromCoordinateInternal(u),h=[d[0]+$[0],d[1]+$[1]];t.getView().animateInternal({center:t.getCoordinateFromPixelInternal(h),duration:this.autoPanAnimation.duration,easing:this.autoPanAnimation.easing})}}}},e.prototype.getRect=function(t,e){var i=t.getBoundingClientRect(),n=i.left+window.pageXOffset,o=i.top+window.pageYOffset;return[n,o,n+e[0],o+e[1]]},e.prototype.setPositioning=function(t){this.set(M.POSITIONING,t)},e.prototype.setVisible=function(t){this.rendered.visible!==t&&(this.element.style.display=t?"":"none",this.rendered.visible=t)},e.prototype.updatePixelPosition=function(){var t=this.getMap(),e=this.getPosition();if(t&&t.isRendered()&&e){var i=t.getPixelFromCoordinate(e),n=t.getSize();this.updateRenderedPosition(i,n)}else this.setVisible(!1)},e.prototype.updateRenderedPosition=function(t,e){var i=this.element.style,n=this.getOffset(),o=this.getPositioning();this.setVisible(!0);var r=n[0],s=n[1];if(o==V.BOTTOM_RIGHT||o==V.CENTER_RIGHT||o==V.TOP_RIGHT){""!==this.rendered.left_&&(this.rendered.left_="",i.left="");var a=Math.round(e[0]-t[0]-r)+"px";this.rendered.right_!=a&&(this.rendered.right_=a,i.right=a)}else{""!==this.rendered.right_&&(this.rendered.right_="",i.right=""),o!=V.BOTTOM_CENTER&&o!=V.CENTER_CENTER&&o!=V.TOP_CENTER||(r-=this.element.offsetWidth/2);var p=Math.round(t[0]+r)+"px";this.rendered.left_!=p&&(this.rendered.left_=p,i.left=p)}if(o==V.BOTTOM_LEFT||o==V.BOTTOM_CENTER||o==V.BOTTOM_RIGHT){""!==this.rendered.top_&&(this.rendered.top_="",i.top="");var $=Math.round(e[1]-t[1]-s)+"px";this.rendered.bottom_!=$&&(this.rendered.bottom_=$,i.bottom=$)}else{""!==this.rendered.bottom_&&(this.rendered.bottom_="",i.bottom=""),o!=V.CENTER_LEFT&&o!=V.CENTER_CENTER&&o!=V.CENTER_RIGHT||(s-=this.element.offsetHeight/2);var u=Math.round(t[1]+s)+"px";this.rendered.top_!=u&&(this.rendered.top_="top",i.top=u)}},e.prototype.getOptions=function(){return this.options},e}(X);md.default=ak;var bk=ge&&ge.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(t,i)};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),oe=.75,nd=.1,Xo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return bk(t,e),t.prototype.createRenderer=function(){return new Dg(this)},t}(qg),Yo=function(e){function t(t){var i=this,o=t||{};(i=e.call(this,{element:document.createElement("div"),render:o.render||ck,target:o.target})||this).boundHandleRotationChanged_=i.handleRotationChanged_.bind(i),i.collapsed_=void 0===o.collapsed||o.collapsed,i.collapsible_=void 0===o.collapsible||o.collapsible,i.collapsible_||(i.collapsed_=!1),i.rotateWithView_=void 0!==o.rotateWithView&&o.rotateWithView,i.viewExtent_=void 0;var r=void 0!==o.className?o.className:"ol-overviewmap",a=void 0!==o.tipLabel?o.tipLabel:"Overview map",n=void 0!==o.collapseLabel?o.collapseLabel:"\xAB";"string"==typeof n?(i.collapseLabel_=document.createElement("span"),i.collapseLabel_.textContent=n):i.collapseLabel_=n;var l=void 0!==o.label?o.label:"\xBB";"string"==typeof l?(i.label_=document.createElement("span"),i.label_.textContent=l):i.label_=l;var p=i.collapsible_&&!i.collapsed_?i.collapseLabel_:i.label_,s=document.createElement("button");s.setAttribute("type","button"),s.title=a,s.appendChild(p),s.addEventListener(f.CLICK,i.handleClick_.bind(i),!1),i.ovmapDiv_=document.createElement("div"),i.ovmapDiv_.className="ol-overviewmap-map",i.view_=o.view,i.ovmap_=new Xo({view:o.view});var $=i.ovmap_;o.layers&&o.layers.forEach(function(e){$.addLayer(e)});var v=document.createElement("div");v.className="ol-overviewmap-box",v.style.boxSizing="border-box",i.boxOverlay_=new ak({position:[0,0],positioning:V.CENTER_CENTER,element:v}),i.ovmap_.addOverlay(i.boxOverlay_);var d=r+" "+ta+" "+Hb+(i.collapsed_&&i.collapsible_?" "+be:"")+(i.collapsible_?"":" ol-uncollapsible"),c=i.element;c.className=d,c.appendChild(i.ovmapDiv_),c.appendChild(s);var _=i,h=i.boxOverlay_,x=i.boxOverlay_.getElement(),u=function(e){var t,i={clientX:(t=e).clientX,clientY:t.clientY},o=$.getEventCoordinateInternal(i);h.setPosition(o)},m=function(e){var t=$.getEventCoordinateInternal(e);_.getMap().getView().setCenterInternal(t),window.removeEventListener("mousemove",u),window.removeEventListener("mouseup",m)};return x.addEventListener("mousedown",function(){window.addEventListener("mousemove",u),window.addEventListener("mouseup",m)}),i}return bk(t,e),t.prototype.setMap=function(t){var i=this.getMap();if(t!==i){if(i){var o=i.getView();o&&this.unbindView_(o),this.ovmap_.setTarget(null)}if(e.prototype.setMap.call(this,t),t){this.ovmap_.setTarget(this.ovmapDiv_),this.listenerKeys.push(d(t,Ya.PROPERTYCHANGE,this.handleMapPropertyChange_,this));var r=t.getView();r&&(this.bindView_(r),r.isDef()&&(this.ovmap_.updateSize(),this.resetExtent_()))}}},t.prototype.handleMapPropertyChange_=function(e){if(e.key===s.VIEW){var t=e.oldValue;t&&this.unbindView_(t);var i=this.getMap().getView();this.bindView_(i)}},t.prototype.bindView_=function(e){if(!this.view_){var t=new Zd({projection:e.getProjection()});this.ovmap_.setView(t)}e.addEventListener(A(Y.ROTATION),this.boundHandleRotationChanged_),this.handleRotationChanged_()},t.prototype.unbindView_=function(e){e.removeEventListener(A(Y.ROTATION),this.boundHandleRotationChanged_)},t.prototype.handleRotationChanged_=function(){this.rotateWithView_&&this.ovmap_.getView().setRotation(this.getMap().getView().getRotation())},t.prototype.validateExtent_=function(){var e=this.getMap(),t=this.ovmap_;if(e.isRendered()&&t.isRendered()){var i=e.getSize(),o=e.getView().calculateExtentInternal(i);if(!this.viewExtent_||!db(o,this.viewExtent_)){this.viewExtent_=o;var r=t.getSize(),a=t.getView().calculateExtentInternal(r),n=t.getPixelFromCoordinateInternal(fb(o)),l=t.getPixelFromCoordinateInternal(xb(o)),p=Math.abs(n[0]-l[0]),s=Math.abs(n[1]-l[1]),$=r[0],v=r[1];p<$*nd||s<v*nd||p>$*oe||s>v*oe?this.resetExtent_():ra(a,o)||this.recenter_()}}},t.prototype.resetExtent_=function(){if(0!==oe&&0!==nd){var e=this.getMap(),t=this.ovmap_,i=e.getSize(),o=e.getView().calculateExtentInternal(i),r=t.getView(),a=Math.log(oe/nd)/Math.LN2,n=1/(Math.pow(2,a/2)*nd);Df(o,n),r.fitInternal(Fb(o))}},t.prototype.recenter_=function(){var e=this.getMap(),t=this.ovmap_,i=e.getView();t.getView().setCenterInternal(i.getCenterInternal())},t.prototype.updateBox_=function(){var e=this.getMap(),t=this.ovmap_;if(e.isRendered()&&t.isRendered()){var i=e.getSize(),o=e.getView(),r=t.getView(),a=this.rotateWithView_?0:-o.getRotation(),n=this.boxOverlay_,l=this.boxOverlay_.getElement(),p=o.getCenterInternal(),s=o.getResolution(),$=r.getResolution(),v=i[0]*s/$,d=i[1]*s/$;if(n.setPosition(p),l){l.style.width=v+"px",l.style.height=d+"px";var c="rotate("+a+"rad)";l.style.transform=c}}},t.prototype.handleClick_=function(e){e.preventDefault(),this.handleToggle_()},t.prototype.handleToggle_=function(){this.element.classList.toggle(be),this.collapsed_?Gb(this.collapseLabel_,this.label_):Gb(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_;var e=this.ovmap_;if(!this.collapsed_){if(e.isRendered())return this.viewExtent_=void 0,void e.render();e.updateSize(),this.resetExtent_(),Vb(e,Zb.POSTRENDER,function(e){this.updateBox_()},this)}},t.prototype.getCollapsible=function(){return this.collapsible_},t.prototype.setCollapsible=function(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),!e&&this.collapsed_&&this.handleToggle_())},t.prototype.setCollapsed=function(e){this.collapsible_&&this.collapsed_!==e&&this.handleToggle_()},t.prototype.getCollapsed=function(){return this.collapsed_},t.prototype.getRotateWithView=function(){return this.rotateWithView_},t.prototype.setRotateWithView=function(e){this.rotateWithView_!==e&&(this.rotateWithView_=e,0!==this.getMap().getView().getRotation()&&(this.rotateWithView_?this.handleRotationChanged_():this.ovmap_.getView().setRotation(0),this.viewExtent_=void 0,this.validateExtent_(),this.updateBox_()))},t.prototype.getOverviewMap=function(){return this.ovmap_},t}(sa);function ck(e){this.validateExtent_(),this.updateBox_()}ge.render=ck,ge.default=Yo;var od={};var Zo=od&&od.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function s(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(s.prototype=r.prototype,new s)}}(),Eg="units",kb={DEGREES:"degrees",IMPERIAL:"imperial",NAUTICAL:"nautical",METRIC:"metric",US:"us"};od.Units=kb;var $o=[1,2,5],_o=function(e){function t(t){var r=this,s=t||{},i=void 0!==s.className?s.className:s.bar?"ol-scale-bar":"ol-scale-line";return(r=e.call(this,{element:document.createElement("div"),render:s.render||dk,target:s.target})||this).innerElement_=document.createElement("div"),r.innerElement_.className=i+"-inner",r.element.className=i+" "+ta,r.element.appendChild(r.innerElement_),r.viewState_=null,r.minWidth_=void 0!==s.minWidth?s.minWidth:64,r.renderedVisible_=!1,r.renderedWidth_=void 0,r.renderedHTML_="",r.addEventListener(A(Eg),r.handleUnitsChanged_),r.setUnits(s.units||kb.METRIC),r.scaleBar_=s.bar||!1,r.scaleBarSteps_=s.steps||4,r.scaleBarText_=s.text||!1,r}return Zo(t,e),t.prototype.getUnits=function(){return this.get(Eg)},t.prototype.handleUnitsChanged_=function(){this.updateElement_()},t.prototype.setUnits=function(e){this.set(Eg,e)},t.prototype.updateElement_=function(){var e=this.viewState_;if(e){var t=e.center,r=e.projection,s=this.getUnits(),i=s==kb.DEGREES?O.DEGREES:O.METERS,n=Pi(r,e.resolution,t,i),a=this.minWidth_*n,o="";if(s==kb.DEGREES){var l=ma[O.DEGREES];(a*=l)<l/60?(o="\u2033",n*=3600):a<l?(o="\u2032",n*=60):o="\xB0"}else s==kb.IMPERIAL?a<.9144?(o="in",n/=.0254):a<1609.344?(o="ft",n/=.3048):(o="mi",n/=1609.344):s==kb.NAUTICAL?(n/=1852,o="nm"):s==kb.METRIC?a<.001?(o="\u03BCm",n*=1e6):a<1?(o="mm",n*=1e3):a<1e3?o="m":(o="km",n/=1e3):s==kb.US?a<.9144?(o="in",n*=39.37):a<1609.344?(o="ft",n/=.30480061):(o="mi",n/=1609.3472):q(!1,33);for(var $,p,d,c,h=3*Math.floor(Math.log(this.minWidth_*n)/Math.log(10));;){d=Math.floor(h/3);var _=Math.pow(10,d);if($=$o[(h%3+3)%3]*_,p=Math.round($/n),isNaN(p))return this.element.style.display="none",void(this.renderedVisible_=!1);if(p>=this.minWidth_)break;++h}c=this.scaleBar_?this.createScaleBar(p,$,o):$.toFixed(d<0?-d:0)+" "+o,this.renderedHTML_!=c&&(this.innerElement_.innerHTML=c,this.renderedHTML_=c),this.renderedWidth_!=p&&(this.innerElement_.style.width=p+"px",this.renderedWidth_=p),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)},t.prototype.createScaleBar=function(e,t,r){for(var s="1 : "+Math.round(this.getScaleForResolution()).toLocaleString(),i=[],n=e/this.scaleBarSteps_,a="#ffffff",o=0;o<this.scaleBarSteps_;o++)0===o&&i.push(this.createMarker("absolute",o)),i.push("<div><div class=\"ol-scale-singlebar\" style=\"width: "+n+"px;background-color: "+a+";\"></div>"+this.createMarker("relative",o)+(o%2==0||2===this.scaleBarSteps_?this.createStepText(o,e,!1,t,r):"")+"</div>"),o===this.scaleBarSteps_-1&&i.push(this.createStepText(o+1,e,!0,t,r)),a="#ffffff"===a?"#000000":"#ffffff";return"<div style=\"display: flex;\">"+(this.scaleBarText_?"<div class=\"ol-scale-text\" style=\"width: "+e+"px;\">"+s+"</div>":"")+i.join("")+"</div>"},t.prototype.createMarker=function(e,t){return"<div class=\"ol-scale-step-marker\" style=\"position: "+e+";top: "+("absolute"===e?3:-10)+"px;\"></div>"},t.prototype.createStepText=function(e,t,r,s,i){var n=(0===e?0:Math.round(s/this.scaleBarSteps_*e*100)/100)+(0===e?"":" "+i);return"<div class=\"ol-scale-step-text\" style=\"margin-left: "+(0===e?-3:t/this.scaleBarSteps_*-1)+"px;text-align: "+(0===e?"left":"center")+"; min-width: "+(0===e?0:t/this.scaleBarSteps_*2)+"px;left: "+(r?t+"px":"unset")+";\">"+n+"</div>"},t.prototype.getScaleForResolution=function(){var e=this.getMap().getView().getResolution(),t=this.viewState_.projection.getMetersPerUnit();return parseFloat(e.toString())*t*39.37*(25.4/.28)},t}(sa);function dk(e){var t=e.frameState;this.viewState_=t?t.viewState:null,this.updateElement_()}od.render=dk,od.default=_o;var pe={};var ap=pe&&pe.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),pd={VERTICAL:0,HORIZONTAL:1},bp=function(t){function e(e){var i=this,r=e||{};(i=t.call(this,{element:document.createElement("div"),render:r.render||ek})||this).dragListenerKeys_=[],i.currentResolution_=void 0,i.direction_=pd.VERTICAL,i.dragging_,i.heightLimit_=0,i.widthLimit_=0,i.startX_,i.startY_,i.thumbSize_=null,i.sliderInitialized_=!1,i.duration_=void 0!==r.duration?r.duration:200;var n=void 0!==r.className?r.className:"ol-zoomslider",o=document.createElement("button");o.setAttribute("type","button"),o.className=n+"-thumb "+ta;var a=i.element;return a.className=n+" "+ta+" "+Hb,a.appendChild(o),a.addEventListener(Ga.POINTERDOWN,i.handleDraggerStart_.bind(i),!1),a.addEventListener(Ga.POINTERMOVE,i.handleDraggerDrag_.bind(i),!1),a.addEventListener(Ga.POINTERUP,i.handleDraggerEnd_.bind(i),!1),a.addEventListener(f.CLICK,i.handleContainerClick_.bind(i),!1),o.addEventListener(f.CLICK,ii,!1),i}return ap(e,t),e.prototype.setMap=function(e){t.prototype.setMap.call(this,e),e&&e.render()},e.prototype.initSlider_=function(){var t=this.element,e=t.offsetWidth,i=t.offsetHeight,r=t.firstElementChild,n=getComputedStyle(r),o=r.offsetWidth+parseFloat(n.marginRight)+parseFloat(n.marginLeft),a=r.offsetHeight+parseFloat(n.marginTop)+parseFloat(n.marginBottom);this.thumbSize_=[o,a],e>i?(this.direction_=pd.HORIZONTAL,this.widthLimit_=e-o):(this.direction_=pd.VERTICAL,this.heightLimit_=i-a),this.sliderInitialized_=!0},e.prototype.handleContainerClick_=function(t){var e=this.getMap().getView(),i=this.getRelativePosition_(t.offsetX-this.thumbSize_[0]/2,t.offsetY-this.thumbSize_[1]/2),r=this.getResolutionForPosition_(i),n=e.getConstrainedZoom(e.getZoomForResolution(r));e.animateInternal({zoom:n,duration:this.duration_,easing:gb})},e.prototype.handleDraggerStart_=function(t){if(!this.dragging_&&t.target===this.element.firstElementChild){var e=this.element.firstElementChild;if(this.getMap().getView().beginInteraction(),this.startX_=t.clientX-parseFloat(e.style.left),this.startY_=t.clientY-parseFloat(e.style.top),this.dragging_=!0,0===this.dragListenerKeys_.length){var i=this.handleDraggerDrag_,r=this.handleDraggerEnd_;this.dragListenerKeys_.push(d(document,Ga.POINTERMOVE,i,this),d(document,Ga.POINTERUP,r,this))}}},e.prototype.handleDraggerDrag_=function(t){if(this.dragging_){var e=t.clientX-this.startX_,i=t.clientY-this.startY_,r=this.getRelativePosition_(e,i);this.currentResolution_=this.getResolutionForPosition_(r),this.getMap().getView().setResolution(this.currentResolution_)}},e.prototype.handleDraggerEnd_=function(t){this.dragging_&&(this.getMap().getView().endInteraction(),this.dragging_=!1,this.startX_=void 0,this.startY_=void 0,this.dragListenerKeys_.forEach(m),this.dragListenerKeys_.length=0)},e.prototype.setThumbPosition_=function(t){var e=this.getPositionForResolution_(t),i=this.element.firstElementChild;this.direction_==pd.HORIZONTAL?i.style.left=this.widthLimit_*e+"px":i.style.top=this.heightLimit_*e+"px"},e.prototype.getRelativePosition_=function(t,e){var i;return i=this.direction_===pd.HORIZONTAL?t/this.widthLimit_:e/this.heightLimit_,F(i,0,1)},e.prototype.getResolutionForPosition_=function(t){return this.getMap().getView().getResolutionForValueFunction()(1-t)},e.prototype.getPositionForResolution_=function(t){var e=this.getMap().getView().getValueForResolutionFunction();return F(1-e(t),0,1)},e}(sa);function ek(t){if(t.frameState){this.sliderInitialized_||this.initSlider_();var e=t.frameState.viewState.resolution;this.currentResolution_=e,this.setThumbPosition_(e)}}pe.render=ek,pe.default=bp;var Fg={};var cp=Fg&&Fg.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),dp=function(t){function e(e){var n=this,o=e||{};(n=t.call(this,{element:document.createElement("div"),target:o.target})||this).extent=o.extent?o.extent:null;var r=void 0!==o.className?o.className:"ol-zoom-extent",i=void 0!==o.label?o.label:"E",a=void 0!==o.tipLabel?o.tipLabel:"Fit to extent",b=document.createElement("button");b.setAttribute("type","button"),b.title=a,b.appendChild("string"==typeof i?document.createTextNode(i):i),b.addEventListener(f.CLICK,n.handleClick_.bind(n),!1);var $=r+" "+ta+" "+Hb,l=n.element;return l.className=$,l.appendChild(b),n}return cp(e,t),e.prototype.handleClick_=function(t){t.preventDefault(),this.handleZoomToExtent()},e.prototype.handleZoomToExtent=function(){var t=this.getMap().getView(),e=this.extent?this.extent:t.getProjection().getExtent();t.fitInternal(Fb(e))},e}(sa);Fg.default=dp;function ep(t){var o=t||{},r=new K,e=new fk(-.005,.05,100);return(void 0===o.altShiftDragRotate||o.altShiftDragRotate)&&r.push(new ok),(void 0===o.doubleClickZoom||o.doubleClickZoom)&&r.push(new hk({delta:o.zoomDelta,duration:o.zoomDuration})),(void 0===o.dragPan||o.dragPan)&&r.push(new nk({condition:o.onFocusOnly?se:void 0,kinetic:e})),(void 0===o.pinchRotate||o.pinchRotate)&&r.push(new wk),(void 0===o.pinchZoom||o.pinchZoom)&&r.push(new xk({duration:o.zoomDuration})),(void 0===o.keyboard||o.keyboard)&&(r.push(new tk),r.push(new uk({delta:o.zoomDelta,duration:o.zoomDuration}))),(void 0===o.mouseWheelZoom||o.mouseWheelZoom)&&r.push(new vk({condition:o.onFocusOnly?se:void 0,duration:o.zoomDuration})),(void 0===o.shiftDragZoom||o.shiftDragZoom)&&r.push(new sk({duration:o.zoomDuration})),r}var Gg={},fk=function(){function t(t,i,n){this.decay_=t,this.minVelocity_=i,this.delay_=n,this.points_=[],this.angle_=0,this.initialVelocity_=0}return t.prototype.begin=function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0},t.prototype.update=function(t,i){this.points_.push(t,i,Date.now())},t.prototype.end=function(){if(this.points_.length<6)return!1;var t=Date.now()-this.delay_,i=this.points_.length-3;if(this.points_[i+2]<t)return!1;for(var n=i-3;n>0&&this.points_[n+2]>t;)n-=3;var e=this.points_[i+2]-this.points_[n+2];if(e<1e3/60)return!1;var s=this.points_[i]-this.points_[n],o=this.points_[i+1]-this.points_[n+1];return this.angle_=Math.atan2(o,s),this.initialVelocity_=Math.sqrt(s*s+o*o)/e,this.initialVelocity_>this.minVelocity_},t.prototype.getDistance=function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_},t.prototype.getAngle=function(){return this.angle_},t}();Gg.default=fk;var Hg={};var qd={};var qe={ACTIVE:"active"};var fp=qd&&qd.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),lb=function(t){function e(e){var r=t.call(this)||this;return e.handleEvent&&(r.handleEvent=e.handleEvent),r.map_=null,r.setActive(!0),r}return fp(e,t),e.prototype.getActive=function(){return this.get(qe.ACTIVE)},e.prototype.getMap=function(){return this.map_},e.prototype.handleEvent=function(t){return!0},e.prototype.setActive=function(t){this.set(qe.ACTIVE,t)},e.prototype.setMap=function(t){this.map_=t},e}(X);function gk(t,e,r){var n=t.getCenterInternal();if(n){var o=[n[0]+e[0],n[1]+e[1]];t.animateInternal({duration:void 0!==r?r:250,easing:Ki,center:t.getConstrainedCenter(o)})}}function re(t,e,r,n){var o=t.getZoom();if(void 0!==o){var a=t.getConstrainedZoom(o+e),c=t.getResolutionForZoom(a);t.getAnimating()&&t.cancelAnimations(),t.animate({resolution:c,anchor:r,duration:void 0!==n?n:250,easing:gb})}}qd.pan=gk,qd.zoomByDelta=re,qd.default=lb;var gp=Hg&&Hg.__extends||function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function o(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),hk=function(t){function n(n){var e=t.call(this,{handleEvent:hp})||this,o=n||{};return e.delta_=o.delta?o.delta:1,e.duration_=void 0!==o.duration?o.duration:250,e}return gp(n,t),n}(lb);function hp(t){var n=!1;if(t.type==j.DBLCLICK){var e=t.originalEvent,o=t.map,r=t.coordinate,a=e.shiftKey?-this.delta_:this.delta_,$=o.getView();re($,a,r,this.duration_),t.preventDefault(),n=!0}return!n}Hg.default=hk;var Ig={};var ip=function(e){var t=e.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey};var jp=function(e){var t=e.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey};var se=function(e){return e.target.getTargetElement()===document.activeElement};var Jg=W;var ik=function(e){var t=e.originalEvent;return 0==t.button&&!(Gm&&Hm&&t.ctrlKey)};var jk=vb;var kk=function(e){return e.type==j.SINGLECLICK};var Kg=function(e){var t=e.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey};var te=function(e){var t=e.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey};var lk=function(e){var t=e.originalEvent.target.tagName;return"INPUT"!==t&&"SELECT"!==t&&"TEXTAREA"!==t};var oc=function(e){var t=e.pointerEvent;return q(void 0!==t,56),"mouse"==t.pointerType};var mk=function(e){var t=e.pointerEvent;return q(void 0!==t,56),t.isPrimary&&0===t.button};var ue={};var kp=ue&&ue.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),$=function(e){function t(t){var n=this,r=t||{};return n=e.call(this,r)||this,r.handleDownEvent&&(n.handleDownEvent=r.handleDownEvent),r.handleDragEvent&&(n.handleDragEvent=r.handleDragEvent),r.handleMoveEvent&&(n.handleMoveEvent=r.handleMoveEvent),r.handleUpEvent&&(n.handleUpEvent=r.handleUpEvent),r.stopDown&&(n.stopDown=r.stopDown),n.handlingDownUpSequence=!1,n.trackedPointers_={},n.targetPointers=[],n}return kp(t,e),t.prototype.getPointerCount=function(){return this.targetPointers.length},t.prototype.handleDownEvent=function(e){return!1},t.prototype.handleDragEvent=function(e){},t.prototype.handleEvent=function(e){if(!e.pointerEvent)return!0;var t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence){if(e.type==j.POINTERDRAG)this.handleDragEvent(e);else if(e.type==j.POINTERUP){var n=this.handleUpEvent(e);this.handlingDownUpSequence=n&&this.targetPointers.length>0}}else if(e.type==j.POINTERDOWN){var r=this.handleDownEvent(e);this.handlingDownUpSequence=r,t=this.stopDown(r)}else e.type==j.POINTERMOVE&&this.handleMoveEvent(e);return!t},t.prototype.handleMoveEvent=function(e){},t.prototype.handleUpEvent=function(e){return!1},t.prototype.stopDown=function(e){return e},t.prototype.updateTrackedPointers_=function(e){if(lp(e)){var t=e.pointerEvent,n=t.pointerId.toString();e.type==j.POINTERUP?delete this.trackedPointers_[n]:e.type==j.POINTERDOWN?this.trackedPointers_[n]=t:n in this.trackedPointers_&&(this.trackedPointers_[n]=t),this.targetPointers=Ed(this.trackedPointers_)}},t}(lb);function ve(e){for(var t=e.length,n=0,r=0,o=0;o<t;o++)n+=e[o].clientX,r+=e[o].clientY;return[n/t,r/t]}function lp(e){var t=e.type;return t===j.POINTERDOWN||t===j.POINTERDRAG||t===j.POINTERUP}ue.centroid=ve,ue.default=$;var mp=Ig&&Ig.__extends||function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function i(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}}(),nk=function(t){function n(n){var e=t.call(this,{stopDown:vb})||this,i=n||{};return e.kinetic_=i.kinetic,e.lastCentroid=null,e.lastPointersCount_,e.panning_=!1,e.condition_=i.condition?i.condition:np,e.noKinetic_=!1,e}return mp(n,t),n.prototype.conditionInternal_=function(t){var n=!0;return t.map.getTargetElement().hasAttribute("tabindex")&&(n=se(t)),n&&this.condition_(t)},n.prototype.handleDragEvent=function(t){this.panning_||(this.panning_=!0,this.getMap().getView().beginInteraction());var n=this.targetPointers,e=ve(n);if(n.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(e[0],e[1]),this.lastCentroid){var i=[this.lastCentroid[0]-e[0],e[1]-this.lastCentroid[1]],r=t.map.getView();Hi(i,r.getResolution()),Md(i,r.getRotation()),r.adjustCenterInternal(i)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=e,this.lastPointersCount_=n.length,t.originalEvent.preventDefault()},n.prototype.handleUpEvent=function(t){var n=t.map,e=n.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var i=this.kinetic_.getDistance(),r=this.kinetic_.getAngle(),o=e.getCenterInternal(),a=n.getPixelFromCoordinateInternal(o),s=n.getCoordinateFromPixelInternal([a[0]-i*Math.cos(r),a[1]-i*Math.sin(r)]);e.animateInternal({center:e.getConstrainedCenter(s),duration:500,easing:gb})}return this.panning_&&(this.panning_=!1,e.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0},n.prototype.handleDownEvent=function(t){if(this.targetPointers.length>0&&this.conditionInternal_(t)){var n=t.map.getView();return this.lastCentroid=null,n.getAnimating()&&n.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1},n}($);function np(t){return Kg(t)&&mk(t)}Ig.default=nk;var Lg={};var op=Lg&&Lg.__extends||function(){var t=function(n,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var o in n)n.hasOwnProperty(o)&&(t[o]=n[o])})(n,o)};return function(n,o){function e(){this.constructor=n}t(n,o),n.prototype=null===o?Object.create(o):(e.prototype=o.prototype,new e)}}(),ok=function(t){function n(n){var o=this,e=n||{};return(o=t.call(this,{stopDown:vb})||this).condition_=e.condition?e.condition:jp,o.lastAngle_=void 0,o.duration_=void 0!==e.duration?e.duration:250,o}return op(n,t),n.prototype.handleDragEvent=function(t){if(oc(t)){var n=t.map,o=n.getView();if(o.getConstraints().rotation!==Ff){var e=n.getSize(),r=t.pixel,i=Math.atan2(e[1]/2-r[1],r[0]-e[0]/2);if(void 0!==this.lastAngle_){var a=i-this.lastAngle_;o.adjustRotationInternal(-a)}this.lastAngle_=i}}},n.prototype.handleUpEvent=function(t){return!oc(t)||(t.map.getView().endInteraction(this.duration_),!1)},n.prototype.handleDownEvent=function(t){return!!oc(t)&&!(!ik(t)||!this.condition_(t))&&(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0)},n}($);Lg.default=ok;var Mg={};var Ng={};var Og={};var pp=Og&&Og.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),pk=function(t){function e(e){var r=t.call(this)||this;return r.geometry_=null,r.element_=document.createElement("div"),r.element_.style.position="absolute",r.element_.className="ol-box "+e,r.map_=null,r.startPixel_=null,r.endPixel_=null,r}return pp(e,t),e.prototype.disposeInternal=function(){this.setMap(null)},e.prototype.render_=function(){var t=this.startPixel_,e=this.endPixel_,r=this.element_.style;r.left=Math.min(t[0],e[0])+"px",r.top=Math.min(t[1],e[1])+"px",r.width=Math.abs(e[0]-t[0])+"px",r.height=Math.abs(e[1]-t[1])+"px"},e.prototype.setMap=function(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var e=this.element_.style;e.left="inherit",e.top="inherit",e.width="inherit",e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)},e.prototype.setPixels=function(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()},e.prototype.createOrUpdateGeometry=function(){var t=this.startPixel_,e=this.endPixel_,r=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);r[4]=r[0].slice(),this.geometry_?this.geometry_.setCoordinates([r]):this.geometry_=new na([r])},e.prototype.getGeometry=function(){return this.geometry_},e}(Nc);Og.default=pk;var qk=Ng&&Ng.__extends||function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function o(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),Pg={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend"},Qg=function(t){function n(n,e,o){var r=t.call(this,n)||this;return r.coordinate=e,r.mapBrowserEvent=o,r}return qk(n,t),n}(T),rk=function(t){function n(n){var e=t.call(this)||this,o=n||{};return e.box_=new pk(o.className||"ol-dragbox"),e.minArea_=void 0!==o.minArea?o.minArea:64,e.onBoxEnd_=o.onBoxEnd?o.onBoxEnd:Da,e.startPixel_=null,e.condition_=o.condition?o.condition:ik,e.boxEndCondition_=o.boxEndCondition?o.boxEndCondition:e.defaultBoxEndCondition,e}return qk(n,t),n.prototype.defaultBoxEndCondition=function(t,n,e){var o=e[0]-n[0],r=e[1]-n[1];return o*o+r*r>=this.minArea_},n.prototype.getGeometry=function(){return this.box_.getGeometry()},n.prototype.handleDragEvent=function(t){this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new Qg(Pg.BOXDRAG,t.coordinate,t))},n.prototype.handleUpEvent=function(t){return this.box_.setMap(null),this.boxEndCondition_(t,this.startPixel_,t.pixel)&&(this.onBoxEnd_(t),this.dispatchEvent(new Qg(Pg.BOXEND,t.coordinate,t))),!1},n.prototype.handleDownEvent=function(t){return!!this.condition_(t)&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new Qg(Pg.BOXSTART,t.coordinate,t)),!0)},n}($);Ng.default=rk;var qp=Mg&&Mg.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),sk=function(t){function e(e){var o=this,r=e||{},n=r.condition?r.condition:te;return(o=t.call(this,{condition:n,className:r.className||"ol-dragzoom",minArea:r.minArea,onBoxEnd:rp})||this).duration_=void 0!==r.duration?r.duration:200,o.out_=void 0!==r.out&&r.out,o}return qp(e,t),e}(rk);function rp(){var t=this.getMap(),e=t.getView(),o=t.getSize(),r=this.getGeometry().getExtent();if(this.out_){var n=e.calculateExtentInternal(o),i=xi([t.getPixelFromCoordinateInternal(eb(r)),t.getPixelFromCoordinateInternal(yb(r))]),a=e.getResolutionForExtentInternal(i,o);Df(n,1/a),r=n}var u=e.getConstrainedResolution(e.getResolutionForExtentInternal(r,o)),$=e.getConstrainedCenter(ac(r),u);e.animateInternal({resolution:u,center:$,duration:this.duration_,easing:gb})}Mg.default=sk;var Rg={};var Ib={LEFT:37,UP:38,RIGHT:39,DOWN:40};var sp=Rg&&Rg.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),tk=function(t){function e(e){var o=t.call(this,{handleEvent:tp})||this,r=e||{};return o.defaultCondition_=function(t){return Kg(t)&&lk(t)},o.condition_=void 0!==r.condition?r.condition:o.defaultCondition_,o.duration_=void 0!==r.duration?r.duration:100,o.pixelDelta_=void 0!==r.pixelDelta?r.pixelDelta:128,o}return sp(e,t),e}(lb);function tp(t){var e=!1;if(t.type==f.KEYDOWN){var o=t.originalEvent.keyCode;if(this.condition_(t)&&(o==Ib.DOWN||o==Ib.LEFT||o==Ib.RIGHT||o==Ib.UP)){var r=t.map.getView(),n=r.getResolution()*this.pixelDelta_,i=0,$=0;o==Ib.DOWN?$=-n:o==Ib.LEFT?i=-n:o==Ib.RIGHT?i=n:$=n;var s=[i,$];Md(s,r.getRotation()),gk(r,s,this.duration_),t.preventDefault(),e=!0}}return!e}Rg.default=tk;var Sg={};var up=Sg&&Sg.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),uk=function(t){function e(e){var r=t.call(this,{handleEvent:vp})||this,n=e||{};return r.condition_=n.condition?n.condition:lk,r.delta_=n.delta?n.delta:1,r.duration_=void 0!==n.duration?n.duration:100,r}return up(e,t),e}(lb);function vp(t){var e=!1;if(t.type==f.KEYDOWN||t.type==f.KEYPRESS){var r=t.originalEvent.charCode;if(this.condition_(t)&&(r=="+".charCodeAt(0)||r=="-".charCodeAt(0))){var n=t.map,o=r=="+".charCodeAt(0)?this.delta_:-this.delta_,i=n.getView();re(i,o,void 0,this.duration_),t.preventDefault(),e=!0}}return!e}Sg.default=uk;var we={};var wp=we&&we.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),xe={TRACKPAD:"trackpad",WHEEL:"wheel"};we.Mode=xe;var vk=function(t){function e(e){var o=this,i=e||{};return(o=t.call(this,i)||this).totalDelta_=0,o.lastDelta_=0,o.maxDelta_=void 0!==i.maxDelta?i.maxDelta:1,o.duration_=void 0!==i.duration?i.duration:250,o.timeout_=void 0!==i.timeout?i.timeout:80,o.useAnchor_=void 0===i.useAnchor||i.useAnchor,o.condition_=i.condition?i.condition:Jg,o.lastAnchor_=null,o.startTime_=void 0,o.timeoutId_,o.mode_=void 0,o.trackpadEventGap_=400,o.trackpadTimeoutId_,o.deltaPerZoom_=300,o}return wp(e,t),e.prototype.conditionInternal_=function(t){var e=!0;return t.map.getTargetElement().hasAttribute("tabindex")&&(e=se(t)),e&&this.condition_(t)},e.prototype.endInteraction_=function(){this.trackpadTimeoutId_=void 0,this.getMap().getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)},e.prototype.handleEvent=function(t){if(!this.conditionInternal_(t))return!0;if(t.type!==f.WHEEL)return!0;t.preventDefault();var e,o=t.map,i=t.originalEvent;if(this.useAnchor_&&(this.lastAnchor_=t.coordinate),t.type==f.WHEEL&&(e=i.deltaY,Fm&&i.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(e/=Uc),i.deltaMode===WheelEvent.DOM_DELTA_LINE&&(e*=40)),0===e)return!1;this.lastDelta_=e;var r=Date.now();void 0===this.startTime_&&(this.startTime_=r),(!this.mode_||r-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(e)<4?xe.TRACKPAD:xe.WHEEL);var a=o.getView();if(this.mode_===xe.TRACKPAD&&!a.getConstrainResolution())return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(a.getAnimating()&&a.cancelAnimations(),a.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),a.adjustZoom(-e/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=r,!1;this.totalDelta_+=e;var n=Math.max(this.timeout_-(r-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,o),n),!1},e.prototype.handleWheelZoom_=function(t){var e=t.getView();e.getAnimating()&&e.cancelAnimations();var o=-F(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;e.getConstrainResolution()&&(o=o?o>0?1:-1:0),re(e,o,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0},e.prototype.setMouseAnchor=function(t){this.useAnchor_=t,t||(this.lastAnchor_=null)},e}(lb);we.default=vk;var Tg={};var xp=Tg&&Tg.__extends||function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),wk=function(t){function n(n){var e=this,r=n||{},o=r;return o.stopDown||(o.stopDown=vb),(e=t.call(this,o)||this).anchor_=null,e.lastAngle_=void 0,e.rotating_=!1,e.rotationDelta_=0,e.threshold_=void 0!==r.threshold?r.threshold:.3,e.duration_=void 0!==r.duration?r.duration:250,e}return xp(n,t),n.prototype.handleDragEvent=function(t){var n=0,e=this.targetPointers[0],r=this.targetPointers[1],o=Math.atan2(r.clientY-e.clientY,r.clientX-e.clientX);if(void 0!==this.lastAngle_){var i=o-this.lastAngle_;this.rotationDelta_+=i,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),n=i}this.lastAngle_=o;var a=t.map,s=a.getView();if(s.getConstraints().rotation!==Ff){var l=a.getViewport().getBoundingClientRect(),h=ve(this.targetPointers);h[0]-=l.left,h[1]-=l.top,this.anchor_=a.getCoordinateFromPixelInternal(h),this.rotating_&&(a.render(),s.adjustRotationInternal(n,this.anchor_))}},n.prototype.handleUpEvent=function(t){return!(this.targetPointers.length<2)||(t.map.getView().endInteraction(this.duration_),!1)},n.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var n=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||n.getView().beginInteraction(),!0}return!1},n}($);Tg.default=wk;var Ug={};var yp=Ug&&Ug.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),xk=function(t){function e(e){var n=this,r=e||{},o=r;return o.stopDown||(o.stopDown=vb),(n=t.call(this,o)||this).anchor_=null,n.duration_=void 0!==r.duration?r.duration:400,n.lastDistance_=void 0,n.lastScaleDelta_=1,n}return yp(e,t),e.prototype.handleDragEvent=function(t){var e=1,n=this.targetPointers[0],r=this.targetPointers[1],o=n.clientX-r.clientX,i=n.clientY-r.clientY,a=Math.sqrt(o*o+i*i);void 0!==this.lastDistance_&&(e=this.lastDistance_/a),this.lastDistance_=a;var s=t.map,l=s.getView();1!=e&&(this.lastScaleDelta_=e);var c=s.getViewport().getBoundingClientRect(),u=ve(this.targetPointers);u[0]-=c.left,u[1]-=c.top,this.anchor_=s.getCoordinateFromPixelInternal(u),s.render(),l.adjustResolutionInternal(e,this.anchor_)},e.prototype.handleUpEvent=function(t){if(this.targetPointers.length<2){var e=t.map.getView(),n=this.lastScaleDelta_>1?1:-1;return e.endInteraction(this.duration_,n),!1}return!0},e.prototype.handleDownEvent=function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1},e}($);Ug.default=xk;var Vg={};var yk=Vg&&Vg.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function c(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(c.prototype=r.prototype,new c)}}(),zp={ADD_FEATURES:"addfeatures"},Ap=function(t){function e(e,r,c,n){var o=t.call(this,e)||this;return o.features=c,o.file=r,o.projection=n,o}return yk(e,t),e}(T),Bp=function(t){function e(e){var r=this,c=e||{};return(r=t.call(this,{handleEvent:W})||this).formatConstructors_=c.formatConstructors?c.formatConstructors:[],r.projection_=c.projection?E(c.projection):null,r.dropListenKeys_=null,r.source_=c.source||null,r.target=c.target?c.target:null,r}return yk(e,t),e.prototype.handleResult_=function(t,e){var r=e.target.result,c=this.getMap(),n=this.projection_;n||(n=c.getView().getProjection());for(var o=this.formatConstructors_,i=[],s=0,$=o.length;s<$;++s){var a=new o[s];if((i=this.tryReadFeatures_(a,r,{featureProjection:n}))&&i.length>0)break}this.source_&&(this.source_.clear(),this.source_.addFeatures(i)),this.dispatchEvent(new Ap(zp.ADD_FEATURES,t,i,n))},e.prototype.registerListeners_=function(){var t=this.getMap();if(t){var e=this.target?this.target:t.getViewport();this.dropListenKeys_=[d(e,f.DROP,Cp,this),d(e,f.DRAGENTER,Wg,this),d(e,f.DRAGOVER,Wg,this),d(e,f.DROP,Wg,this)]}},e.prototype.setActive=function(e){!this.getActive()&&e&&this.registerListeners_(),this.getActive()&&!e&&this.unregisterListeners_(),t.prototype.setActive.call(this,e)},e.prototype.setMap=function(e){this.unregisterListeners_(),t.prototype.setMap.call(this,e),this.getActive()&&this.registerListeners_()},e.prototype.tryReadFeatures_=function(t,e,r){try{return t.readFeatures(e,r)}catch(c){return null}},e.prototype.unregisterListeners_=function(){this.dropListenKeys_&&(this.dropListenKeys_.forEach(m),this.dropListenKeys_=null)},e}(lb);function Cp(t){for(var e=t.dataTransfer.files,r=0,c=e.length;r<c;++r){var n=e.item(r),o=new FileReader;o.addEventListener(f.LOAD,this.handleResult_.bind(this,n)),o.readAsText(n)}}function Wg(t){t.stopPropagation(),t.preventDefault(),t.dataTransfer.dropEffect="copy"}Vg.default=Bp;var Xg={};var Dp=Xg&&Xg.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),Ep=function(t){function e(e){var n=this,i=e||{};return(n=t.call(this,i)||this).condition_=i.condition?i.condition:te,n.lastAngle_=void 0,n.lastMagnitude_=void 0,n.lastScaleDelta_=0,n.duration_=void 0!==i.duration?i.duration:400,n}return Dp(e,t),e.prototype.handleDragEvent=function(t){if(oc(t)){var e=t.map,n=e.getSize(),i=t.pixel,o=i[0]-n[0]/2,a=n[1]/2-i[1],r=Math.atan2(a,o),s=Math.sqrt(o*o+a*a),l=e.getView();if(void 0!==this.lastAngle_){var u=this.lastAngle_-r;l.adjustRotationInternal(u)}this.lastAngle_=r,void 0!==this.lastMagnitude_&&l.adjustResolutionInternal(this.lastMagnitude_/s),void 0!==this.lastMagnitude_&&(this.lastScaleDelta_=this.lastMagnitude_/s),this.lastMagnitude_=s}},e.prototype.handleUpEvent=function(t){if(!oc(t))return!0;var e=t.map.getView(),n=this.lastScaleDelta_>1?1:-1;return e.endInteraction(this.duration_,n),this.lastScaleDelta_=0,!1},e.prototype.handleDownEvent=function(t){return!!oc(t)&&!!this.condition_(t)&&(t.map.getView().beginInteraction(),this.lastAngle_=void 0,this.lastMagnitude_=void 0,!0)},e}($);Xg.default=Ep;var rd={};var pc={};var Fp=pc&&pc.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),va=function(e){function t(t){var r=e.call(this)||this;if(r.id_=void 0,r.geometryName_="geometry",r.style_=null,r.styleFunction_=void 0,r.geometryChangeKey_=null,r.addEventListener(A(r.geometryName_),r.handleGeometryChanged_),t)if("function"==typeof t.getSimplifiedGeometry){var n=t;r.setGeometry(n)}else{var o=t;r.setProperties(o)}return r}return Fp(t,e),t.prototype.clone=function(){var e=new t(this.getProperties());e.setGeometryName(this.getGeometryName());var r=this.getGeometry();r&&e.setGeometry(r.clone());var n=this.getStyle();return n&&e.setStyle(n),e},t.prototype.getGeometry=function(){return this.get(this.geometryName_)},t.prototype.getId=function(){return this.id_},t.prototype.getGeometryName=function(){return this.geometryName_},t.prototype.getStyle=function(){return this.style_},t.prototype.getStyleFunction=function(){return this.styleFunction_},t.prototype.handleGeometryChange_=function(){this.changed()},t.prototype.handleGeometryChanged_=function(){this.geometryChangeKey_&&(m(this.geometryChangeKey_),this.geometryChangeKey_=null);var e=this.getGeometry();e&&(this.geometryChangeKey_=d(e,f.CHANGE,this.handleGeometryChange_,this)),this.changed()},t.prototype.setGeometry=function(e){this.set(this.geometryName_,e)},t.prototype.setStyle=function(e){this.style_=e,this.styleFunction_=e?zk(e):void 0,this.changed()},t.prototype.setId=function(e){this.id_=e,this.changed()},t.prototype.setGeometryName=function(e){this.removeEventListener(A(this.geometryName_),this.handleGeometryChanged_),this.geometryName_=e,this.addEventListener(A(this.geometryName_),this.handleGeometryChanged_),this.handleGeometryChanged_()},t}(X);function zk(e){return"function"==typeof e?e:(Array.isArray(e)?t=e:(q("function"==typeof e.getZIndex,41),t=[e]),function(){return t});var t}pc.createStyleFunction=zk,pc.default=va;var Yg={};var Gp=Yg&&Yg.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),ye=function(t){function e(e,r,o){var i=t.call(this)||this;if(void 0!==o&&void 0===r)i.setFlatCoordinates(o,e);else{var s=r||0;i.setCenterAndRadius(e,s,o)}return i}return Gp(e,t),e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),void 0,this.layout)},e.prototype.closestPointXY=function(t,e,r,o){var i=this.flatCoordinates,s=t-i[0],n=e-i[1],a=s*s+n*n;if(a<o){if(0===a)for(var p=0;p<this.stride;++p)r[p]=i[p];else{var d=this.getRadius()/Math.sqrt(a);r[0]=i[0]+d*s,r[1]=i[1]+d*n;for(p=2;p<this.stride;++p)r[p]=i[p]}return r.length=this.stride,a}return o},e.prototype.containsXY=function(t,e){var r=this.flatCoordinates,o=t-r[0],i=e-r[1];return o*o+i*i<=this.getRadiusSquared_()},e.prototype.getCenter=function(){return this.flatCoordinates.slice(0,this.stride)},e.prototype.computeExtent=function(t){var e=this.flatCoordinates,r=e[this.stride]-e[0];return Ia(e[0]-r,e[1]-r,e[0]+r,e[1]+r,t)},e.prototype.getRadius=function(){return Math.sqrt(this.getRadiusSquared_())},e.prototype.getRadiusSquared_=function(){var t=this.flatCoordinates[this.stride]-this.flatCoordinates[0],e=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return t*t+e*e},e.prototype.getType=function(){return k.CIRCLE},e.prototype.intersectsExtent=function(t){var e=this.getExtent();if(ea(t,e)){var r=this.getCenter();return t[0]<=r[0]&&t[2]>=r[0]||t[1]<=r[1]&&t[3]>=r[1]||Af(t,this.intersectsCoordinate.bind(this))}return!1},e.prototype.setCenter=function(t){var e=this.stride,r=this.flatCoordinates[e]-this.flatCoordinates[0],o=t.slice();o[e]=o[0]+r;for(var i=1;i<e;++i)o[e+i]=t[i];this.setFlatCoordinates(this.layout,o),this.changed()},e.prototype.setCenterAndRadius=function(t,e,r){this.setLayout(r,t,0),this.flatCoordinates||(this.flatCoordinates=[]);var o=this.flatCoordinates,i=jj(o,0,t,this.stride);o[i++]=o[0]+e;for(var s=1,n=this.stride;s<n;++s)o[i++]=o[s];o.length=i,this.changed()},e.prototype.getCoordinates=function(){return null},e.prototype.setCoordinates=function(t,e){},e.prototype.setRadius=function(t){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+t,this.changed()},e.prototype.rotate=function(t,e){var r=this.getCenter(),o=this.getStride();this.setCenter(Li(r,0,r.length,o,t,e,r)),this.changed()},e.prototype.translate=function(t,e){var r=this.getCenter(),o=this.getStride();this.setCenter(Mi(r,0,r.length,o,t,e,r)),this.changed()},e}(Pa);ye.prototype.transform,Yg.default=ye;var sd={};function Ak(r,e,t,i,n,$){var o=NaN,l=NaN,a=(t-e)/i;if(1===a)o=r[e],l=r[e+1];else if(2==a)o=(1-n)*r[e]+n*r[e+i],l=(1-n)*r[e+1]+n*r[e+i+1];else if(0!==a){for(var u=r[e],p=r[e+1],f=0,s=[0],H=e+i;H<t;H+=i){var R=r[H],T=r[H+1];f+=Math.sqrt((R-u)*(R-u)+(T-p)*(T-p)),s.push(f),u=R,p=T}var V=n*f,v=gi(s,V);if(v<0){var c=(V-s[-v-2])/(s[-v-1]-s[-v-2]),g=e+(-v-2)*i;o=wb(r[g],r[g+i],c),l=wb(r[g+1],r[g+i+1],c)}else o=r[e+v*i],l=r[e+v*i+1]}return $?($[0]=o,$[1]=l,$):[o,l]}function Zg(r,e,t,i,n,$){if(t==e)return null;var o;if(n<r[e+i-1])return $?((o=r.slice(e,e+i))[i-1]=n,o):null;if(r[t-1]<n)return $?((o=r.slice(t-i,t))[i-1]=n,o):null;if(n==r[e+i-1])return r.slice(e,e+i);for(var l=e/i,a=t/i;l<a;){var u=l+a>>1;n<r[(u+1)*i-1]?a=u:l=u+1}var p=r[l*i-1];if(n==p)return r.slice((l-1)*i,(l-1)*i+i);var f=(n-p)/(r[(l+1)*i-1]-p);o=[];for(var s=0;s<i-1;++s)o.push(wb(r[(l-1)*i+s],r[l*i+s],f));return o.push(n),o}function Hp(r,e,t,i,n,$,o){if(o)return Zg(r,e,t[t.length-1],i,n,$);var l;if(n<r[i-1])return $?((l=r.slice(0,i))[i-1]=n,l):null;if(r[r.length-1]<n)return $?((l=r.slice(r.length-i))[i-1]=n,l):null;for(var a=0,u=t.length;a<u;++a){var p=t[a];if(e!=p){if(n<r[e+i-1])return null;if(n<=r[p-1])return Zg(r,e,p,i,n,!1);e=p}}return null}function Bk(n,t,r,e){for(var $=n[t],o=n[t+1],i=0,g=t+e;g<r;g+=e){var a=n[g],h=n[g+1];i+=Math.sqrt((a-$)*(a-$)+(h-o)*(h-o)),$=a,o=h}return i}var Ip=sd&&sd.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}(),mb=function(t){function e(e,i){var o=t.call(this)||this;return o.flatMidpoint_=null,o.flatMidpointRevision_=-1,o.maxDelta_=-1,o.maxDeltaRevision_=-1,void 0===i||Array.isArray(e[0])?o.setCoordinates(e,i):o.setFlatCoordinates(i,e),o}return Ip(e,t),e.prototype.appendCoordinate=function(t){this.flatCoordinates?v(this.flatCoordinates,t):this.flatCoordinates=t.slice(),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,i,o){return o<bb(this.getExtent(),t,e)?o:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt($f(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ag(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,i,o))},e.prototype.forEachSegment=function(t){return oj(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.getCoordinateAtM=function(t,e){if(this.layout!=l.XYM&&this.layout!=l.XYZM)return null;var i=void 0!==e&&e;return Zg(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i)},e.prototype.getCoordinates=function(){return ed(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getCoordinateAt=function(t,e){return Ak(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e)},e.prototype.getLength=function(){return Bk(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getFlatMidpoint=function(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[];return i.length=dg(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,i,0),new e(i,l.XY)},e.prototype.getType=function(){return k.LINE_STRING},e.prototype.intersectsExtent=function(t){return Yd(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Wd(this.flatCoordinates,0,t,this.stride),this.changed()},e}(Pa);sd.default=mb;var $g={};var Jp=$g&&$g.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),ze=function(t){function e(e,r,i){var o=t.call(this)||this;if(o.ends_=[],o.maxDelta_=-1,o.maxDeltaRevision_=-1,Array.isArray(e[0]))o.setCoordinates(e,r);else if(void 0!==r&&i)o.setFlatCoordinates(r,e),o.ends_=i;else{for(var s=o.getLayout(),n=e,a=[],l=[],$=0,p=n.length;$<p;++$){var d=n[$];0===$&&(s=d.getLayout()),v(a,d.getFlatCoordinates()),l.push(a.length)}o.setFlatCoordinates(s,a),o.ends_=l}return o}return Jp(e,t),e.prototype.appendLineString=function(t){this.flatCoordinates?v(this.flatCoordinates,t.getFlatCoordinates().slice()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout,this.ends_.slice())},e.prototype.closestPointXY=function(t,e,r,i){return i<bb(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(_f(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),bg(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,r,i))},e.prototype.getCoordinateAtM=function(t,e,r){if(this.layout!=l.XYM&&this.layout!=l.XYZM||0===this.flatCoordinates.length)return null;var i=void 0!==e&&e,o=void 0!==r&&r;return Hp(this.flatCoordinates,0,this.ends_,this.stride,t,i,o)},e.prototype.getCoordinates=function(){return Xd(this.flatCoordinates,0,this.ends_,this.stride)},e.prototype.getEnds=function(){return this.ends_},e.prototype.getLineString=function(t){return t<0||this.ends_.length<=t?null:new mb(this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t]),this.layout)},e.prototype.getLineStrings=function(){for(var t=this.flatCoordinates,e=this.ends_,r=this.layout,i=[],o=0,s=0,n=e.length;s<n;++s){var a=e[s],l=new mb(t.slice(o,a),r);i.push(l),o=a}return i},e.prototype.getFlatMidpoints=function(){for(var t=[],e=this.flatCoordinates,r=0,i=this.ends_,o=this.stride,s=0,n=i.length;s<n;++s){var a=i[s],l=Ak(e,r,a,o,.5);v(t,l),r=a}return t},e.prototype.getSimplifiedGeometryInternal=function(t){var r=[],i=[];return r.length=Fn(this.flatCoordinates,0,this.ends_,this.stride,t,r,0,i),new e(r,l.XY,i)},e.prototype.getType=function(){return k.MULTI_LINE_STRING},e.prototype.intersectsExtent=function(t){return Nn(this.flatCoordinates,0,this.ends_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var r=cg(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===r.length?0:r[r.length-1],this.changed()},e}(Pa);$g.default=ze;var _g={};var Kp=_g&&_g.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),Ae=function(t){function e(e,r){var o=t.call(this)||this;return r&&!Array.isArray(e[0])?o.setFlatCoordinates(r,e):o.setCoordinates(e,r),o}return Kp(e,t),e.prototype.appendPoint=function(t){this.flatCoordinates?v(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.changed()},e.prototype.clone=function(){return new e(this.flatCoordinates.slice(),this.layout)},e.prototype.closestPointXY=function(t,e,r,o){if(o<bb(this.getExtent(),t,e))return o;for(var i=this.flatCoordinates,n=this.stride,s=0,a=i.length;s<a;s+=n){var l=ab(t,e,i[s],i[s+1]);if(l<o){o=l;for(var d=0;d<n;++d)r[d]=i[s+d];r.length=n}}return o},e.prototype.getCoordinates=function(){return ed(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},e.prototype.getPoint=function(t){var e=this.flatCoordinates?this.flatCoordinates.length/this.stride:0;return t<0||e<=t?null:new Qa(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)},e.prototype.getPoints=function(){for(var t=this.flatCoordinates,e=this.layout,r=this.stride,o=[],i=0,n=t.length;i<n;i+=r){var s=new Qa(t.slice(i,i+r),e);o.push(s)}return o},e.prototype.getType=function(){return k.MULTI_POINT},e.prototype.intersectsExtent=function(t){for(var e=this.flatCoordinates,r=this.stride,o=0,i=e.length;o<i;o+=r){var n=e[o],s=e[o+1];if(Hd(t,n,s))return!0}return!1},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Wd(this.flatCoordinates,0,t,this.stride),this.changed()},e}(Pa);_g.default=Ae;var ah={};function Lp(r,e,t,$){for(var j=[],n=da(),a=0,i=t.length;a<i;++a){var m=t[a];n=wf(r,e,m[0],$),j.push((n[0]+n[2])/2,(n[1]+n[3])/2),e=m[m.length-1]}return j}var Mp=ah&&ah.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),bh=function(t){function e(e,i,r){var o=t.call(this)||this;if(o.endss_=[],o.flatInteriorPointsRevision_=-1,o.flatInteriorPoints_=null,o.maxDelta_=-1,o.maxDeltaRevision_=-1,o.orientedRevision_=-1,o.orientedFlatCoordinates_=null,!r&&!Array.isArray(e[0])){for(var s=o.getLayout(),n=e,a=[],l=[],$=0,h=n.length;$<h;++$){var d=n[$];0===$&&(s=d.getLayout());for(var p=a.length,u=d.getEnds(),f=0,c=u.length;f<c;++f)u[f]+=p;v(a,d.getFlatCoordinates()),l.push(u)}i=s,e=a,r=l}return void 0!==i&&r?(o.setFlatCoordinates(i,e),o.endss_=r):o.setCoordinates(e,i),o}return Mp(e,t),e.prototype.appendPolygon=function(t){var e;if(this.flatCoordinates){var i=this.flatCoordinates.length;v(this.flatCoordinates,t.getFlatCoordinates());for(var r=0,o=(e=t.getEnds().slice()).length;r<o;++r)e[r]+=i}else this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();this.endss_.push(e),this.changed()},e.prototype.clone=function(){for(var t=this.endss_.length,i=new Array(t),r=0;r<t;++r)i[r]=this.endss_[r].slice();return new e(this.flatCoordinates.slice(),this.layout,i)},e.prototype.closestPointXY=function(t,e,i,r){return r<bb(this.getExtent(),t,e)?r:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Cn(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Dn(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,e,i,r))},e.prototype.containsXY=function(t,e){return Ln(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)},e.prototype.getArea=function(){return Bn(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)},e.prototype.getCoordinates=function(t){var e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),rj(e,0,this.endss_,this.stride,t)):e=this.flatCoordinates,kj(e,0,this.endss_,this.stride)},e.prototype.getEndss=function(){return this.endss_},e.prototype.getFlatInteriorPoints=function(){if(this.flatInteriorPointsRevision_!=this.getRevision()){var t=Lp(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=Mn(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_},e.prototype.getInteriorPoints=function(){return new Ae(this.getFlatInteriorPoints().slice(),l.XYM)},e.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;Qn(t,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=rj(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},e.prototype.getSimplifiedGeometryInternal=function(t){var i=[],r=[];return i.length=Hn(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),i,0,r),new e(i,l.XY,r)},e.prototype.getPolygon=function(t){if(t<0||this.endss_.length<=t)return null;var e;if(0===t)e=0;else{var i=this.endss_[t-1];e=i[i.length-1]}var r=this.endss_[t].slice(),o=r[r.length-1];if(0!==e)for(var s=0,n=r.length;s<n;++s)r[s]-=e;return new na(this.flatCoordinates.slice(e,o),this.layout,r)},e.prototype.getPolygons=function(){for(var t=this.layout,e=this.flatCoordinates,i=this.endss_,r=[],o=0,s=0,n=i.length;s<n;++s){var a=i[s].slice(),l=a[a.length-1];if(0!==o)for(var $=0,h=a.length;$<h;++$)a[$]-=o;var d=new na(e.slice(o,l),t,a);r.push(d),o=l}return r},e.prototype.getType=function(){return k.MULTI_POLYGON},e.prototype.intersectsExtent=function(t){return Pn(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)},e.prototype.setCoordinates=function(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);var i=En(this.flatCoordinates,0,t,this.stride,this.endss_);if(0===i.length)this.flatCoordinates.length=0;else{var r=i[i.length-1];this.flatCoordinates.length=0===r.length?0:r[r.length-1]}this.changed()},e}(Pa);ah.default=bh;var td={};var ch={};var qc={};var dh={};var eh={};var Ck=function(){function t(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.displacement_=t.displacement}return t.prototype.clone=function(){return new t({opacity:this.getOpacity(),scale:this.getScale(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()})},t.prototype.getOpacity=function(){return this.opacity_},t.prototype.getRotateWithView=function(){return this.rotateWithView_},t.prototype.getRotation=function(){return this.rotation_},t.prototype.getScale=function(){return this.scale_},t.prototype.getDisplacement=function(){return this.displacement_},t.prototype.getAnchor=function(){return h()},t.prototype.getImage=function(t){return h()},t.prototype.getHitDetectionImage=function(t){return h()},t.prototype.getImageState=function(){return h()},t.prototype.getImageSize=function(){return h()},t.prototype.getHitDetectionImageSize=function(){return h()},t.prototype.getOrigin=function(){return h()},t.prototype.getSize=function(){return h()},t.prototype.setOpacity=function(t){this.opacity_=t},t.prototype.setRotateWithView=function(t){this.rotateWithView_=t},t.prototype.setRotation=function(t){this.rotation_=t},t.prototype.setScale=function(t){this.scale_=t},t.prototype.listenImageChange=function(t){h()},t.prototype.load=function(){h()},t.prototype.unlistenImageChange=function(t){h()},t}();var Np=eh&&eh.__extends||function(){var t=function(i,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])})(i,e)};return function(i,e){function s(){this.constructor=i}t(i,e),i.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)}}(),Dk=function(t){function i(i){var e=this,s=void 0!==i.rotateWithView&&i.rotateWithView;return(e=t.call(this,{opacity:1,rotateWithView:s,rotation:void 0!==i.rotation?i.rotation:0,scale:1,displacement:void 0!==i.displacement?i.displacement:[0,0]})||this).canvas_=null,e.hitDetectionCanvas_=null,e.fill_=void 0!==i.fill?i.fill:null,e.origin_=[0,0],e.points_=i.points,e.radius_=void 0!==i.radius?i.radius:i.radius1,e.radius2_=i.radius2,e.angle_=void 0!==i.angle?i.angle:0,e.stroke_=void 0!==i.stroke?i.stroke:null,e.anchor_=null,e.size_=null,e.imageSize_=null,e.hitDetectionImageSize_=null,e.render(),e}return Np(i,t),i.prototype.clone=function(){var t=new i({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice()});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},i.prototype.getAnchor=function(){return this.anchor_},i.prototype.getAngle=function(){return this.angle_},i.prototype.getFill=function(){return this.fill_},i.prototype.getHitDetectionImage=function(t){return this.hitDetectionCanvas_},i.prototype.getImage=function(t){return this.canvas_},i.prototype.getImageSize=function(){return this.imageSize_},i.prototype.getHitDetectionImageSize=function(){return this.hitDetectionImageSize_},i.prototype.getImageState=function(){return x.LOADED},i.prototype.getOrigin=function(){return this.origin_},i.prototype.getPoints=function(){return this.points_},i.prototype.getRadius=function(){return this.radius_},i.prototype.getRadius2=function(){return this.radius2_},i.prototype.getSize=function(){return this.size_},i.prototype.getStroke=function(){return this.stroke_},i.prototype.listenImageChange=function(t){},i.prototype.load=function(){},i.prototype.unlistenImageChange=function(t){},i.prototype.render=function(){var t,i=lc,e=mc,s=0,r=null,o=0,n=0;this.stroke_&&(null===(t=this.stroke_.getColor())&&(t=jd),t=ua(t),void 0===(n=this.stroke_.getWidth())&&(n=ld),r=this.stroke_.getLineDash(),o=this.stroke_.getLineDashOffset(),void 0===(e=this.stroke_.getLineJoin())&&(e=mc),void 0===(i=this.stroke_.getLineCap())&&(i=lc),void 0===(s=this.stroke_.getMiterLimit())&&(s=id));var a=2*(this.radius_+n)+1,l={strokeStyle:t,strokeWidth:n,size:a,lineCap:i,lineDash:r,lineDashOffset:o,lineJoin:e,miterLimit:s},h=Z(a,a);this.canvas_=h.canvas;var u=a=this.canvas_.width,p=this.getDisplacement();this.draw_(l,h,0,0),this.createHitDetectionCanvas_(l),this.anchor_=[a/2-p[0],a/2+p[1]],this.size_=[a,a],this.imageSize_=[u,u]},i.prototype.draw_=function(t,i,e,s){var r,o,n;i.setTransform(1,0,0,1,0,0),i.translate(e,s),i.beginPath();var a=this.points_;if(a===1/0)i.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var l=void 0!==this.radius2_?this.radius2_:this.radius_;for(l!==this.radius_&&(a*=2),r=0;r<=a;r++)o=2*r*Math.PI/a-Math.PI/2+this.angle_,n=r%2==0?this.radius_:l,i.lineTo(t.size/2+n*Math.cos(o),t.size/2+n*Math.sin(o))}if(this.fill_){var h=this.fill_.getColor();null===h&&(h=Sa),i.fillStyle=ua(h),i.fill()}this.stroke_&&(i.strokeStyle=t.strokeStyle,i.lineWidth=t.strokeWidth,i.setLineDash&&t.lineDash&&(i.setLineDash(t.lineDash),i.lineDashOffset=t.lineDashOffset),i.lineCap=t.lineCap,i.lineJoin=t.lineJoin,i.miterLimit=t.miterLimit,i.stroke()),i.closePath()},i.prototype.createHitDetectionCanvas_=function(t){if(this.hitDetectionImageSize_=[t.size,t.size],this.hitDetectionCanvas_=this.canvas_,this.fill_){var i=this.fill_.getColor(),e=0;if("string"==typeof i&&(i=Ag(i)),null===i?e=1:Array.isArray(i)&&(e=4===i.length?i[3]:1),0===e){var s=Z(t.size,t.size);this.hitDetectionCanvas_=s.canvas,this.drawHitDetectionCanvas_(t,s,0,0)}}},i.prototype.drawHitDetectionCanvas_=function(t,i,e,s){i.setTransform(1,0,0,1,0,0),i.translate(e,s),i.beginPath();var r=this.points_;if(r===1/0)i.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var o=void 0!==this.radius2_?this.radius2_:this.radius_;o!==this.radius_&&(r*=2);var n=void 0,a=void 0,l=void 0;for(n=0;n<=r;n++)l=2*n*Math.PI/r-Math.PI/2+this.angle_,a=n%2==0?this.radius_:o,i.lineTo(t.size/2+a*Math.cos(l),t.size/2+a*Math.sin(l))}i.fillStyle=Sa,i.fill(),this.stroke_&&(i.strokeStyle=t.strokeStyle,i.lineWidth=t.strokeWidth,t.lineDash&&(i.setLineDash(t.lineDash),i.lineDashOffset=t.lineDashOffset),i.stroke()),i.closePath()},i}(Ck);eh.default=Dk;var Op=dh&&dh.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function s(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(s.prototype=r.prototype,new s)}}(),fh=function(t){function e(e){var r=e||{};return t.call(this,{points:1/0,fill:r.fill,radius:r.radius,stroke:r.stroke,displacement:void 0!==r.displacement?r.displacement:[0,0]})||this}return Op(e,t),e.prototype.clone=function(){var t=new e({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),displacement:this.getDisplacement().slice()});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},e.prototype.setRadius=function(t){this.radius_=t,this.render()},e}(Dk);dh.default=fh;var gh={},nb=function(){function o(o){var r=o||{};this.color_=void 0!==r.color?r.color:null}return o.prototype.clone=function(){var r=this.getColor();return new o({color:Array.isArray(r)?r.slice():r||void 0})},o.prototype.getColor=function(){return this.color_},o.prototype.setColor=function(o){this.color_=o},o}();gh.default=nb;var hh={},ob=function(){function t(t){var i=t||{};this.color_=void 0!==i.color?i.color:null,this.lineCap_=i.lineCap,this.lineDash_=void 0!==i.lineDash?i.lineDash:null,this.lineDashOffset_=i.lineDashOffset,this.lineJoin_=i.lineJoin,this.miterLimit_=i.miterLimit,this.width_=i.width}return t.prototype.clone=function(){var i=this.getColor();return new t({color:Array.isArray(i)?i.slice():i||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},t.prototype.getColor=function(){return this.color_},t.prototype.getLineCap=function(){return this.lineCap_},t.prototype.getLineDash=function(){return this.lineDash_},t.prototype.getLineDashOffset=function(){return this.lineDashOffset_},t.prototype.getLineJoin=function(){return this.lineJoin_},t.prototype.getMiterLimit=function(){return this.miterLimit_},t.prototype.getWidth=function(){return this.width_},t.prototype.setColor=function(t){this.color_=t},t.prototype.setLineCap=function(t){this.lineCap_=t},t.prototype.setLineDash=function(t){this.lineDash_=t},t.prototype.setLineDashOffset=function(t){this.lineDashOffset_=t},t.prototype.setLineJoin=function(t){this.lineJoin_=t},t.prototype.setMiterLimit=function(t){this.miterLimit_=t},t.prototype.setWidth=function(t){this.width_=t},t}();hh.default=ob;var _=function(){function t(t){var e=t||{};this.geometry_=null,this.geometryFunction_=Hk,void 0!==e.geometry&&this.setGeometry(e.geometry),this.fill_=void 0!==e.fill?e.fill:null,this.image_=void 0!==e.image?e.image:null,this.renderer_=void 0!==e.renderer?e.renderer:null,this.stroke_=void 0!==e.stroke?e.stroke:null,this.text_=void 0!==e.text?e.text:null,this.zIndex_=e.zIndex}return t.prototype.clone=function(){var e=this.getGeometry();return e&&"object"==typeof e&&(e=e.clone()),new t({geometry:e,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})},t.prototype.getRenderer=function(){return this.renderer_},t.prototype.setRenderer=function(t){this.renderer_=t},t.prototype.getGeometry=function(){return this.geometry_},t.prototype.getGeometryFunction=function(){return this.geometryFunction_},t.prototype.getFill=function(){return this.fill_},t.prototype.setFill=function(t){this.fill_=t},t.prototype.getImage=function(){return this.image_},t.prototype.setImage=function(t){this.image_=t},t.prototype.getStroke=function(){return this.stroke_},t.prototype.setStroke=function(t){this.stroke_=t},t.prototype.getText=function(){return this.text_},t.prototype.setText=function(t){this.text_=t},t.prototype.getZIndex=function(){return this.zIndex_},t.prototype.setGeometry=function(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=Hk,this.geometry_=t},t.prototype.setZIndex=function(t){this.zIndex_=t},t}();function Ek(t){var e;if("function"==typeof t)e=t;else{var r;if(Array.isArray(t))r=t;else q("function"==typeof t.getZIndex,41),r=[t];e=function(){return r}}return e}qc.toFunction=Ek;var Fk=null;function Gk(t,e){if(!Fk){var r=new nb({color:"rgba(255,255,255,0.4)"}),o=new ob({color:"#3399CC",width:1.25});Fk=[new _({image:new fh({fill:r,stroke:o,radius:5}),fill:r,stroke:o})]}return Fk}function rc(){var t={},e=[255,255,255,1],r=[0,153,255,1];return t[k.POLYGON]=[new _({fill:new nb({color:[255,255,255,.5]})})],t[k.MULTI_POLYGON]=t[k.POLYGON],t[k.LINE_STRING]=[new _({stroke:new ob({color:e,width:5})}),new _({stroke:new ob({color:r,width:3})})],t[k.MULTI_LINE_STRING]=t[k.LINE_STRING],t[k.CIRCLE]=t[k.POLYGON].concat(t[k.LINE_STRING]),t[k.POINT]=[new _({image:new fh({radius:6,fill:new nb({color:r}),stroke:new ob({color:e,width:1.5})}),zIndex:1/0})],t[k.MULTI_POINT]=t[k.POINT],t[k.GEOMETRY_COLLECTION]=t[k.POLYGON].concat(t[k.LINE_STRING],t[k.POINT]),t}function Hk(t){return t.getGeometry()}qc.createDefaultStyle=Gk,qc.createEditingStyle=rc,qc.default=_;var Pp=ch&&ch.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Ik={RENDER_ORDER:"renderOrder"},ih=function(t){function e(e){var r=this,n=e||{},i=L({},n);return delete i.style,delete i.renderBuffer,delete i.updateWhileAnimating,delete i.updateWhileInteracting,(r=t.call(this,i)||this).declutter_=void 0!==n.declutter&&n.declutter,r.renderBuffer_=void 0!==n.renderBuffer?n.renderBuffer:100,r.style_=null,r.styleFunction_=void 0,r.setStyle(n.style),r.updateWhileAnimating_=void 0!==n.updateWhileAnimating&&n.updateWhileAnimating,r.updateWhileInteracting_=void 0!==n.updateWhileInteracting&&n.updateWhileInteracting,r}return Pp(e,t),e.prototype.getDeclutter=function(){return this.declutter_},e.prototype.getFeatures=function(e){return t.prototype.getFeatures.call(this,e)},e.prototype.getRenderBuffer=function(){return this.renderBuffer_},e.prototype.getRenderOrder=function(){return this.get(Ik.RENDER_ORDER)},e.prototype.getStyle=function(){return this.style_},e.prototype.getStyleFunction=function(){return this.styleFunction_},e.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_},e.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_},e.prototype.setRenderOrder=function(t){this.set(Ik.RENDER_ORDER,t)},e.prototype.setStyle=function(t){this.style_=void 0!==t?t:Gk,this.styleFunction_=null===t?void 0:Ek(this.style_),this.changed()},e}(de);ch.default=ih;var jh={};var kh={};var ba={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Be=[ba.FILL];var pb=[ba.STROKE];var Jb=[ba.BEGIN_PATH];var Jk=[ba.CLOSE_PATH];var Qp=kh&&kh.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),sc=function(t){function e(e,i,n,r){var o=t.call(this)||this;return o.tolerance=e,o.maxExtent=i,o.pixelRatio=r,o.maxLineWidth=0,o.resolution=n,o.beginGeometryInstruction1_=null,o.beginGeometryInstruction2_=null,o.bufferedMaxExtent_=null,o.instructions=[],o.coordinates=[],o.tmpCoordinate_=[],o.hitDetectionInstructions=[],o.state={},o}return Qp(e,t),e.prototype.applyPixelRatio=function(t){var e=this.pixelRatio;return 1==e?t:t.map(function(t){return t*e})},e.prototype.appendFlatCoordinates=function(t,e,i,n,r,o){var s=this.coordinates.length,a=this.getBufferedMaxExtent();o&&(e+=n);var u,$,l,p=t[e],c=t[e+1],h=this.tmpCoordinate_,d=!0;for(u=e+n;u<i;u+=n)h[0]=t[u],h[1]=t[u+1],(l=Id(a,h))!==$?(d&&(this.coordinates[s++]=p,this.coordinates[s++]=c),this.coordinates[s++]=h[0],this.coordinates[s++]=h[1],d=!1):l===J.INTERSECTING?(this.coordinates[s++]=h[0],this.coordinates[s++]=h[1],d=!1):d=!0,p=h[0],c=h[1],$=l;return(r&&d||u===e+n)&&(this.coordinates[s++]=p,this.coordinates[s++]=c),s},e.prototype.drawCustomCoordinates_=function(t,e,i,n,r){for(var o=0,s=i.length;o<s;++o){var a=i[o],u=this.appendFlatCoordinates(t,e,a,n,!1,!1);r.push(u),e=a}return e},e.prototype.drawCustom=function(t,e,i){this.beginGeometry(t,e);var n,r,o,s,a,u=t.getType(),$=t.getStride(),l=this.coordinates.length;if(u==k.MULTI_POLYGON){n=(t=t).getOrientedFlatCoordinates(),s=[];var p=t.getEndss();a=0;for(var c=0,h=p.length;c<h;++c){var d=[];a=this.drawCustomCoordinates_(n,a,p[c],$,d),s.push(d)}this.instructions.push([ba.CUSTOM,l,s,t,i,kj])}else u==k.POLYGON||u==k.MULTI_LINE_STRING?(o=[],n=u==k.POLYGON?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),a=this.drawCustomCoordinates_(n,0,t.getEnds(),$,o),this.instructions.push([ba.CUSTOM,l,o,t,i,Xd])):u==k.LINE_STRING||u==k.MULTI_POINT?(n=t.getFlatCoordinates(),r=this.appendFlatCoordinates(n,0,n.length,$,!1,!1),this.instructions.push([ba.CUSTOM,l,r,t,i,ed])):u==k.POINT&&(n=t.getFlatCoordinates(),this.coordinates.push(n[0],n[1]),r=this.coordinates.length,this.instructions.push([ba.CUSTOM,l,r,t,i]));this.endGeometry(e)},e.prototype.beginGeometry=function(t,e){var i=t.getExtent();this.beginGeometryInstruction1_=[ba.BEGIN_GEOMETRY,e,0,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[ba.BEGIN_GEOMETRY,e,0,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)},e.prototype.finish=function(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}},e.prototype.reverseHitDetectionInstructions=function(){var t,e=this.hitDetectionInstructions;e.reverse();var i,n,r=e.length,o=-1;for(t=0;t<r;++t)(n=(i=e[t])[0])==ba.END_GEOMETRY?o=t:n==ba.BEGIN_GEOMETRY&&(i[2]=t,hi(this.hitDetectionInstructions,o,t),o=-1)},e.prototype.setFillStrokeStyle=function(t,e){var i=this.state;if(t){var n=t.getColor();i.fillStyle=ua(n||Sa)}else i.fillStyle=void 0;if(e){var r=e.getColor();i.strokeStyle=ua(r||jd);var o=e.getLineCap();i.lineCap=void 0!==o?o:lc;var s=e.getLineDash();i.lineDash=s?s.slice():ie;var a=e.getLineDashOffset();i.lineDashOffset=a||je;var u=e.getLineJoin();i.lineJoin=void 0!==u?u:mc;var $=e.getWidth();i.lineWidth=void 0!==$?$:ld;var l=e.getMiterLimit();i.miterLimit=void 0!==l?l:id,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0},e.prototype.createFill=function(t){var e=t.fillStyle,i=[ba.SET_FILL_STYLE,e];return"string"!=typeof e&&i.push(!0),i},e.prototype.applyStroke=function(t){this.instructions.push(this.createStroke(t))},e.prototype.createStroke=function(t){return[ba.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]},e.prototype.updateFillStyle=function(t,e){var i=t.fillStyle;"string"==typeof i&&t.currentFillStyle==i||(void 0!==i&&this.instructions.push(e.call(this,t)),t.currentFillStyle=i)},e.prototype.updateStrokeStyle=function(t,e){var i=t.strokeStyle,n=t.lineCap,r=t.lineDash,o=t.lineDashOffset,s=t.lineJoin,a=t.lineWidth,u=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=n||r!=t.currentLineDash&&!$a(t.currentLineDash,r)||t.currentLineDashOffset!=o||t.currentLineJoin!=s||t.currentLineWidth!=a||t.currentMiterLimit!=u)&&(void 0!==i&&e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=n,t.currentLineDash=r,t.currentLineDashOffset=o,t.currentLineJoin=s,t.currentLineWidth=a,t.currentMiterLimit=u)},e.prototype.endGeometry=function(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;var e=[ba.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)},e.prototype.getBufferedMaxExtent=function(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=vf(this.maxExtent),this.maxLineWidth>0)){var t=this.resolution*(this.maxLineWidth+1)/2;_b(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_},e}(Qj);kh.default=sc;var lh={};var Rp=lh&&lh.__extends||function(){var t=function(i,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])})(i,o)};return function(i,o){function e(){this.constructor=i}t(i,o),i.prototype=null===o?Object.create(o):(e.prototype=o.prototype,new e)}}(),Kk=function(t){function i(i,o,e,h){var s=t.call(this,i,o,e,h)||this;return s.declutterGroups_=null,s.hitDetectionImage_=null,s.image_=null,s.anchorX_=void 0,s.anchorY_=void 0,s.height_=void 0,s.opacity_=void 0,s.originX_=void 0,s.originY_=void 0,s.rotateWithView_=void 0,s.rotation_=void 0,s.scale_=void 0,s.width_=void 0,s}return Rp(i,t),i.prototype.drawCoordinates_=function(t,i,o,e){return this.appendFlatCoordinates(t,i,o,e,!1,!1)},i.prototype.drawPoint=function(t,i){if(this.image_){this.beginGeometry(t,i);var o=t.getFlatCoordinates(),e=t.getStride(),h=this.coordinates.length,s=this.drawCoordinates_(o,0,o.length,e);this.instructions.push([ba.DRAW_IMAGE,h,s,this.image_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.width_]),this.hitDetectionInstructions.push([ba.DRAW_IMAGE,h,s,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_]),this.endGeometry(i)}},i.prototype.drawMultiPoint=function(t,i){if(this.image_){this.beginGeometry(t,i);var o=t.getFlatCoordinates(),e=t.getStride(),h=this.coordinates.length,s=this.drawCoordinates_(o,0,o.length,e);this.instructions.push([ba.DRAW_IMAGE,h,s,this.image_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.width_]),this.hitDetectionInstructions.push([ba.DRAW_IMAGE,h,s,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroups_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_]),this.endGeometry(i)}},i.prototype.finish=function(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,t.prototype.finish.call(this)},i.prototype.setImageStyle=function(t,i){var o=t.getAnchor(),e=t.getSize(),h=t.getHitDetectionImage(1),s=t.getImage(1),r=t.getOrigin();this.anchorX_=o[0],this.anchorY_=o[1],this.declutterGroups_=i,this.hitDetectionImage_=h,this.image_=s,this.height_=e[1],this.opacity_=t.getOpacity(),this.originX_=r[0],this.originY_=r[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScale(),this.width_=e[0]},i}(sc);lh.default=Kk;var mh={};var Sp=mh&&mh.__extends||function(){var t=function(i,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])})(i,e)};return function(i,e){function n(){this.constructor=i}t(i,e),i.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}(),Lk=function(t){function i(i,e,n,o){return t.call(this,i,e,n,o)||this}return Sp(i,t),i.prototype.drawFlatCoordinates_=function(t,i,e,n){var o=this.coordinates.length,r=this.appendFlatCoordinates(t,i,e,n,!1,!1),s=[ba.MOVE_TO_LINE_TO,o,r];return this.instructions.push(s),this.hitDetectionInstructions.push(s),e},i.prototype.drawLineString=function(t,i){var e=this.state,n=e.strokeStyle,o=e.lineWidth;if(void 0!==n&&void 0!==o){this.updateStrokeStyle(e,this.applyStroke),this.beginGeometry(t,i),this.hitDetectionInstructions.push([ba.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash,e.lineDashOffset],Jb);var r=t.getFlatCoordinates(),s=t.getStride();this.drawFlatCoordinates_(r,0,r.length,s),this.hitDetectionInstructions.push(pb),this.endGeometry(i)}},i.prototype.drawMultiLineString=function(t,i){var e=this.state,n=e.strokeStyle,o=e.lineWidth;if(void 0!==n&&void 0!==o){this.updateStrokeStyle(e,this.applyStroke),this.beginGeometry(t,i),this.hitDetectionInstructions.push([ba.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash,e.lineDashOffset],Jb);for(var r=t.getEnds(),s=t.getFlatCoordinates(),u=t.getStride(),a=0,h=0,p=r.length;h<p;++h)a=this.drawFlatCoordinates_(s,a,r[h],u);this.hitDetectionInstructions.push(pb),this.endGeometry(i)}},i.prototype.finish=function(){var i=this.state;return null!=i.lastStroke&&i.lastStroke!=this.coordinates.length&&this.instructions.push(pb),this.reverseHitDetectionInstructions(),this.state=null,t.prototype.finish.call(this)},i.prototype.applyStroke=function(i){null!=i.lastStroke&&i.lastStroke!=this.coordinates.length&&(this.instructions.push(pb),i.lastStroke=this.coordinates.length),i.lastStroke=0,t.prototype.applyStroke.call(this,i),this.instructions.push(Jb)},i}(sc);mh.default=Lk;var nh={};var Tp=nh&&nh.__extends||function(){var t=function(i,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])})(i,e)};return function(i,e){function s(){this.constructor=i}t(i,e),i.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)}}(),oh=function(t){function i(i,e,s,o){return t.call(this,i,e,s,o)||this}return Tp(i,t),i.prototype.drawFlatCoordinatess_=function(t,i,e,s){var o=this.state,n=void 0!==o.fillStyle,r=void 0!==o.strokeStyle,l=e.length;this.instructions.push(Jb),this.hitDetectionInstructions.push(Jb);for(var h=0;h<l;++h){var a=e[h],$=this.coordinates.length,u=this.appendFlatCoordinates(t,i,a,s,!0,!r),d=[ba.MOVE_TO_LINE_TO,$,u];this.instructions.push(d),this.hitDetectionInstructions.push(d),r&&(this.instructions.push(Jk),this.hitDetectionInstructions.push(Jk)),i=a}return n&&(this.instructions.push(Be),this.hitDetectionInstructions.push(Be)),r&&(this.instructions.push(pb),this.hitDetectionInstructions.push(pb)),i},i.prototype.drawCircle=function(t,i){var e=this.state,s=e.fillStyle,o=e.strokeStyle;if(void 0!==s||void 0!==o){this.setFillStrokeStyles_(),this.beginGeometry(t,i),void 0!==e.fillStyle&&this.hitDetectionInstructions.push([ba.SET_FILL_STYLE,Sa]),void 0!==e.strokeStyle&&this.hitDetectionInstructions.push([ba.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash,e.lineDashOffset]);var n=t.getFlatCoordinates(),r=t.getStride(),l=this.coordinates.length;this.appendFlatCoordinates(n,0,n.length,r,!1,!1);var h=[ba.CIRCLE,l];this.instructions.push(Jb,h),this.hitDetectionInstructions.push(Jb,h),void 0!==e.fillStyle&&(this.instructions.push(Be),this.hitDetectionInstructions.push(Be)),void 0!==e.strokeStyle&&(this.instructions.push(pb),this.hitDetectionInstructions.push(pb)),this.endGeometry(i)}},i.prototype.drawPolygon=function(t,i){var e=this.state,s=e.fillStyle,o=e.strokeStyle;if(void 0!==s||void 0!==o){this.setFillStrokeStyles_(),this.beginGeometry(t,i),void 0!==e.fillStyle&&this.hitDetectionInstructions.push([ba.SET_FILL_STYLE,Sa]),void 0!==e.strokeStyle&&this.hitDetectionInstructions.push([ba.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash,e.lineDashOffset]);var n=t.getEnds(),r=t.getOrientedFlatCoordinates(),l=t.getStride();this.drawFlatCoordinatess_(r,0,n,l),this.endGeometry(i)}},i.prototype.drawMultiPolygon=function(t,i){var e=this.state,s=e.fillStyle,o=e.strokeStyle;if(void 0!==s||void 0!==o){this.setFillStrokeStyles_(),this.beginGeometry(t,i),void 0!==e.fillStyle&&this.hitDetectionInstructions.push([ba.SET_FILL_STYLE,Sa]),void 0!==e.strokeStyle&&this.hitDetectionInstructions.push([ba.SET_STROKE_STYLE,e.strokeStyle,e.lineWidth,e.lineCap,e.lineJoin,e.miterLimit,e.lineDash,e.lineDashOffset]);for(var n=t.getEndss(),r=t.getOrientedFlatCoordinates(),l=t.getStride(),h=0,a=0,$=n.length;a<$;++a)h=this.drawFlatCoordinatess_(r,h,n[a],l);this.endGeometry(i)}},i.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.state=null;var i=this.tolerance;if(0!==i)for(var e=this.coordinates,s=0,o=e.length;s<o;++s)e[s]=Db(e[s],i);return t.prototype.finish.call(this)},i.prototype.setFillStrokeStyles_=function(){var t=this.state;void 0!==t.fillStyle&&this.updateFillStyle(t,this.createFill),void 0!==t.strokeStyle&&this.updateStrokeStyle(t,this.applyStroke)},i}(sc);nh.default=oh;var Ce={};function Up(t,r,i,$,a){var n,o,h,d,c,e,u,v,p,s=i,x=i,g=0,k=0,m=i;for(n=i;n<$;n+=a){var C=r[n],f=r[n+1];void 0!==d&&(v=C-d,p=f-c,h=Math.sqrt(v*v+p*p),void 0!==e&&(k+=o,Math.acos((e*v+u*p)/(o*h))>t&&(k>g&&(g=k,s=m,x=n),k=0,m=n-a)),o=h,e=v,u=p),d=C,c=f}return(k+=h)>g?[m,n]:[s,x]}var Mk={POINT:"point",LINE:"line"};var Vp=Ce&&Ce.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),tc={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};Ce.TEXT_ALIGN=tc;var Nk=function(t){function e(e,i,r,s){var o=t.call(this,e,i,r,s)||this;return o.declutterGroups_,o.labels_=null,o.text_="",o.textOffsetX_=0,o.textOffsetY_=0,o.textRotateWithView_=void 0,o.textRotation_=0,o.textFillState_=null,o.fillStates={},o.textStrokeState_=null,o.strokeStates={},o.textState_={},o.textStates={},o.textKey_="",o.fillKey_="",o.strokeKey_="",o}return Vp(e,t),e.prototype.finish=function(){var e=t.prototype.finish.call(this);return e.textStates=this.textStates,e.fillStates=this.fillStates,e.strokeStates=this.strokeStates,e},e.prototype.drawText=function(t,e){var i=this.textFillState_,r=this.textStrokeState_,s=this.textState_;if(""!==this.text_&&s&&(i||r)){var o,l,a=this.coordinates.length,n=t.getType(),$=null,h=2,p=2;if(s.placement===Mk.LINE){if(!ea(this.getBufferedMaxExtent(),t.getExtent()))return;var u=void 0;if($=t.getFlatCoordinates(),p=t.getStride(),n==k.LINE_STRING)u=[$.length];else if(n==k.MULTI_LINE_STRING)u=t.getEnds();else if(n==k.POLYGON)u=t.getEnds().slice(0,1);else if(n==k.MULTI_POLYGON){var f=t.getEndss();for(u=[],o=0,l=f.length;o<l;++o)u.push(f[o][0])}this.beginGeometry(t,e);for(var v=s.textAlign,d=0,c=void 0,_=0,x=u.length;_<x;++_){if(null==v){var g=Up(s.maxAngle,$,d,u[_],p);d=g[0],c=g[1]}else c=u[_];for(o=d;o<c;o+=p)this.coordinates.push($[o],$[o+1]);h=this.coordinates.length,d=u[_];var G=this.declutterGroups_?0===_?this.declutterGroups_[0]:[].concat(this.declutterGroups_[0]):null;this.drawChars_(a,h,G),a=h}this.endGeometry(e)}else{var S=null;switch(s.overflow||(S=[]),n){case k.POINT:case k.MULTI_POINT:h=($=t.getFlatCoordinates()).length;break;case k.LINE_STRING:$=t.getFlatMidpoint();break;case k.CIRCLE:$=t.getCenter();break;case k.MULTI_LINE_STRING:h=($=t.getFlatMidpoints()).length;break;case k.POLYGON:$=t.getFlatInteriorPoint(),s.overflow||S.push($[2]/this.resolution),p=3;break;case k.MULTI_POLYGON:var y=t.getFlatInteriorPoints();for($=[],o=0,l=y.length;o<l;o+=3)s.overflow||S.push(y[o+2]/this.resolution),$.push(y[o],y[o+1]);if(0==(h=$.length))return;}h=this.appendFlatCoordinates($,0,h,p,!1,!1),this.saveTextStates_(),(s.backgroundFill||s.backgroundStroke)&&(this.setFillStrokeStyle(s.backgroundFill,s.backgroundStroke),s.backgroundFill&&(this.updateFillStyle(this.state,this.createFill),this.hitDetectionInstructions.push(this.createFill(this.state))),s.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e);var m=this.pixelRatio;this.instructions.push([ba.DRAW_IMAGE,a,h,null,NaN,NaN,this.declutterGroups_,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,1,NaN,s.padding==nc?nc:s.padding.map(function(t){return t*m}),!!s.backgroundFill,!!s.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,S]),this.hitDetectionInstructions.push([ba.DRAW_IMAGE,a,h,null,NaN,NaN,this.declutterGroups_,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,1/this.pixelRatio,NaN,s.padding,!!s.backgroundFill,!!s.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,S]),this.endGeometry(e)}}},e.prototype.saveTextStates_=function(){var t=this.textStrokeState_,e=this.textState_,i=this.textFillState_,r=this.strokeKey_;t&&(r in this.strokeStates||(this.strokeStates[r]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));var s=this.textKey_;s in this.textStates||(this.textStates[s]={font:e.font,textAlign:e.textAlign||kd,textBaseline:e.textBaseline||ke,scale:e.scale});var o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))},e.prototype.drawChars_=function(t,e,i){var r=this.textStrokeState_,s=this.textState_,o=this.strokeKey_,l=this.textKey_,a=this.fillKey_;this.saveTextStates_();var n=this.pixelRatio,$=tc[s.textBaseline],h=this.textOffsetY_*n,p=this.text_,u=s.scale,f=r?r.lineWidth*u/2:0;this.instructions.push([ba.DRAW_CHARS,t,e,$,i,s.overflow,a,s.maxAngle,n,h,o,f*n,p,l,1]),this.hitDetectionInstructions.push([ba.DRAW_CHARS,t,e,$,i,s.overflow,a,s.maxAngle,1,h,o,f,p,l,1/n])},e.prototype.setTextStyle=function(t,e){var i,r,s;if(t){this.declutterGroups_=e;var o=t.getFill();o?((r=this.textFillState_)||(r={},this.textFillState_=r),r.fillStyle=ua(o.getColor()||Sa)):(r=null,this.textFillState_=r);var l=t.getStroke();if(l){(s=this.textStrokeState_)||(s={},this.textStrokeState_=s);var a=l.getLineDash(),n=l.getLineDashOffset(),$=l.getWidth(),h=l.getMiterLimit();s.lineCap=l.getLineCap()||lc,s.lineDash=a?a.slice():ie,s.lineDashOffset=void 0===n?je:n,s.lineJoin=l.getLineJoin()||mc,s.lineWidth=void 0===$?ld:$,s.miterLimit=void 0===h?id:h,s.strokeStyle=ua(l.getColor()||jd)}else s=null,this.textStrokeState_=s;i=this.textState_;var p=t.getFont()||Rj;Do(p);var u=t.getScale();i.overflow=t.getOverflow(),i.font=p,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.textBaseline=t.getTextBaseline()||ke,i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||nc,i.scale=void 0===u?1:u;var f=t.getOffsetX(),v=t.getOffsetY(),d=t.getRotateWithView(),c=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===f?0:f,this.textOffsetY_=void 0===v?0:v,this.textRotateWithView_=void 0!==d&&d,this.textRotation_=void 0===c?0:c,this.strokeKey_=s?("string"==typeof s.strokeStyle?s.strokeStyle:aa(s.strokeStyle))+s.lineCap+s.lineDashOffset+"|"+s.lineWidth+s.lineJoin+s.miterLimit+"["+s.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.textBaseline||"?"),this.fillKey_=r?"string"==typeof r.fillStyle?r.fillStyle:"|"+aa(r.fillStyle):""}else this.text_=""},e}(sc);Ce.default=Nk;var Wp={Circle:oh,Default:sc,Image:Kk,LineString:Lk,Polygon:oh,Text:Nk},Xp=function(){function e(e,r,t,i,u){this.declutter_=u,this.declutterGroups_=null,this.tolerance_=e,this.maxExtent_=r,this.pixelRatio_=i,this.resolution_=t,this.buildersByZIndex_={}}return e.prototype.addDeclutter=function(e){var r=null;return this.declutter_&&(e?(r=this.declutterGroups_)[0][4]++:(r=[da()],this.declutterGroups_=r,r[0].push(1))),r},e.prototype.finish=function(){var e={};for(var r in this.buildersByZIndex_){e[r]=e[r]||{};var t=this.buildersByZIndex_[r];for(var i in t){var u=t[i].finish();e[r][i]=u}}return e},e.prototype.getBuilder=function(e,r){var t=void 0!==e?e.toString():"0",i=this.buildersByZIndex_[t];void 0===i&&(i={},this.buildersByZIndex_[t]=i);var u=i[r];void 0===u&&(u=new(0,Wp[r])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),i[r]=u);return u},e}();function Yp(t,a,r,h,o,$,e,x,M,p,m){for(var n,P,i=[],v=t[a]>t[r-h],w=o.length,l=t[a],s=t[a+1],I=t[a+=h],f=t[a+1],u=0,d=Math.sqrt(Math.pow(I-l,2)+Math.pow(f-s,2)),q=!1,O=0;O<w;++O){for(var T=o[n=v?w-O-1:O],c=x*M(p,T,m),b=$+c/2;a<r-h&&u+d<b;)l=I,s=f,I=t[a+=h],f=t[a+1],u+=d,d=Math.sqrt(Math.pow(I-l,2)+Math.pow(f-s,2));var g=b-u,j=Math.atan2(f-s,I-l);if(v&&(j+=j>0?-Math.PI:Math.PI),void 0!==P){var k=j-P;if(q=q||0!==k,k+=k>Math.PI?-2*Math.PI:k<-Math.PI?2*Math.PI:0,Math.abs(k)>e)return null}P=j;var y=g/d,z=wb(l,I,y),A=wb(s,f,y);i[n]=[z,A,c/2,j,T],$+=c}return q?i:[[i[0][0],i[0][1],i[0][2],i[0][3],o]]}var ph,De={},Lt=arguments[0];!function(t,i){"object"==typeof De?De=i():"function"==typeof ph&&ph.amd?ph(i):(t=t||self).RBush=i()}(De,function(){function t(t,r,e,a,o){!function t(n,r,e,a,o){for(;a>e;){if(a-e>600){var h=a-e+1,s=r-e+1,l=Math.log(h),f=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*f*(h-f)/h)*(s-h/2<0?-1:1),m=Math.max(e,Math.floor(r-s*f/h+u)),c=Math.min(a,Math.floor(r+(h-s)*f/h+u));t(n,r,m,c,o)}var p=n[r],d=e,x=a;for(i(n,e,r),o(n[a],p)>0&&i(n,e,a);d<x;){for(i(n,d,x),d++,x--;o(n[d],p)<0;)d++;for(;o(n[x],p)>0;)x--}0===o(n[e],p)?i(n,e,x):i(n,++x,a),x<=r&&(e=x+1),r<=x&&(a=x-1)}}(t,r,e||0,a||t.length-1,o||n)}function i(t,i,n){var r=t[i];t[i]=t[n],t[n]=r}function n(t,i){return t<i?-1:t>i?1:0}var r=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function e(t,i,n){if(!n)return i.indexOf(t);for(var r=0;r<i.length;r++)if(n(t,i[r]))return r;return-1}function a(t,i){o(t,0,t.children.length,i,t)}function o(t,i,n,r,e){e||(e=p(null)),e.minX=1/0,e.minY=1/0,e.maxX=-1/0,e.maxY=-1/0;for(var a=i;a<n;a++){var o=t.children[a];h(e,t.leaf?r(o):o)}return e}function h(t,i){return t.minX=Math.min(t.minX,i.minX),t.minY=Math.min(t.minY,i.minY),t.maxX=Math.max(t.maxX,i.maxX),t.maxY=Math.max(t.maxY,i.maxY),t}function s(t,i){return t.minX-i.minX}function l(t,i){return t.minY-i.minY}function f(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function u(t){return t.maxX-t.minX+(t.maxY-t.minY)}function m(t,i){return t.minX<=i.minX&&t.minY<=i.minY&&i.maxX<=t.maxX&&i.maxY<=t.maxY}function c(t,i){return i.minX<=t.maxX&&i.minY<=t.maxY&&i.maxX>=t.minX&&i.maxY>=t.minY}function p(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function d(i,n,r,e,a){for(var o=[n,r];o.length;)if(!((r=o.pop())-(n=o.pop())<=e)){var h=n+Math.ceil((r-n)/e/2)*e;t(i,h,n,r,a),o.push(n,h,h,r)}}return r.prototype.all=function(){return this._all(this.data,[])},r.prototype.search=function(t){var i=this.data,n=[];if(!c(t,i))return n;for(var r=this.toBBox,e=[];i;){for(var a=0;a<i.children.length;a++){var o=i.children[a],h=i.leaf?r(o):o;c(t,h)&&(i.leaf?n.push(o):m(t,h)?this._all(o,n):e.push(o))}i=e.pop()}return n},r.prototype.collides=function(t){var i=this.data;if(!c(t,i))return!1;for(var n=[];i;){for(var r=0;r<i.children.length;r++){var e=i.children[r],a=i.leaf?this.toBBox(e):e;if(c(t,a)){if(i.leaf||m(t,a))return!0;n.push(e)}}i=n.pop()}return!1},r.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var i=0;i<t.length;i++)this.insert(t[i]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length){if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}}else this.data=n;return this},r.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},r.prototype.clear=function(){return this.data=p([]),this},r.prototype.remove=function(t,i){if(!t)return this;for(var n,r,a,o=this.data,h=this.toBBox(t),s=[],l=[];o||s.length;){if(o||(o=s.pop(),r=s[s.length-1],n=l.pop(),a=!0),o.leaf){var f=e(t,o.children,i);if(-1!==f)return o.children.splice(f,1),s.push(o),this._condense(s),this}a||o.leaf||!m(o,h)?r?(n++,o=r.children[n],a=!1):o=null:(s.push(o),l.push(n),n=0,r=o,o=o.children[0])}return this},r.prototype.toBBox=function(t){return t},r.prototype.compareMinX=function(t,i){return t.minX-i.minX},r.prototype.compareMinY=function(t,i){return t.minY-i.minY},r.prototype.toJSON=function(){return this.data},r.prototype.fromJSON=function(t){return this.data=t,this},r.prototype._all=function(t,i){for(var n=[];t;)t.leaf?i.push.apply(i,t.children):n.push.apply(n,t.children),t=n.pop();return i},r.prototype._build=function(t,i,n,r){var e,o=n-i+1,h=this._maxEntries;if(o<=h)return a(e=p(t.slice(i,n+1)),this.toBBox),e;r||(r=Math.ceil(Math.log(o)/Math.log(h)),h=Math.ceil(o/Math.pow(h,r-1))),(e=p([])).leaf=!1,e.height=r;var s=Math.ceil(o/h),l=s*Math.ceil(Math.sqrt(h));d(t,i,n,l,this.compareMinX);for(var f=i;f<=n;f+=l){var u=Math.min(f+l-1,n);d(t,f,u,s,this.compareMinY);for(var m=f;m<=u;m+=s){var c=Math.min(m+s-1,u);e.children.push(this._build(t,m,c,r-1))}}return a(e,this.toBBox),e},r.prototype._chooseSubtree=function(t,i,n,r){for(;r.push(i),!i.leaf&&r.length-1!==n;){for(var e=1/0,a=1/0,o=void 0,h=0;h<i.children.length;h++){var s=i.children[h],l=f(s),u=(m=t,c=s,(Math.max(c.maxX,m.maxX)-Math.min(c.minX,m.minX))*(Math.max(c.maxY,m.maxY)-Math.min(c.minY,m.minY))-l);u<a?(a=u,e=l<e?l:e,o=s):u===a&&l<e&&(e=l,o=s)}i=o||i.children[0]}var m,c;return i},r.prototype._insert=function(t,i,n){var r=n?t:this.toBBox(t),e=[],a=this._chooseSubtree(r,this.data,i,e);for(a.children.push(t),h(a,r);i>=0&&e[i].children.length>this._maxEntries;)this._split(e,i),i--;this._adjustParentBBoxes(r,e,i)},r.prototype._split=function(t,i){var n=t[i],r=n.children.length,e=this._minEntries;this._chooseSplitAxis(n,e,r);var o=this._chooseSplitIndex(n,e,r),h=p(n.children.splice(o,n.children.length-o));h.height=n.height,h.leaf=n.leaf,a(n,this.toBBox),a(h,this.toBBox),i?t[i-1].children.push(h):this._splitRoot(n,h)},r.prototype._splitRoot=function(t,i){this.data=p([t,i]),this.data.height=t.height+1,this.data.leaf=!1,a(this.data,this.toBBox)},r.prototype._chooseSplitIndex=function(t,i,n){for(var r,e,a,h,s,l,u,m=1/0,c=1/0,p=i;p<=n-i;p++){var d=o(t,0,p,this.toBBox),x=o(t,p,n,this.toBBox),v=(e=d,a=x,h=void 0,s=void 0,l=void 0,u=void 0,h=Math.max(e.minX,a.minX),s=Math.max(e.minY,a.minY),l=Math.min(e.maxX,a.maxX),u=Math.min(e.maxY,a.maxY),Math.max(0,l-h)*Math.max(0,u-s)),M=f(d)+f(x);v<m?(m=v,r=p,c=M<c?M:c):v===m&&M<c&&(c=M,r=p)}return r||n-i},r.prototype._chooseSplitAxis=function(t,i,n){var r=t.leaf?this.compareMinX:s,e=t.leaf?this.compareMinY:l;this._allDistMargin(t,i,n,r)<this._allDistMargin(t,i,n,e)&&t.children.sort(r)},r.prototype._allDistMargin=function(t,i,n,r){t.children.sort(r);for(var e=this.toBBox,a=o(t,0,i,e),s=o(t,n-i,n,e),l=u(a)+u(s),f=i;f<n-i;f++){var m=t.children[f];h(a,t.leaf?e(m):m),l+=u(a)}for(var c=n-i-1;c>=i;c--){var p=t.children[c];h(s,t.leaf?e(p):p),l+=u(s)}return l},r.prototype._adjustParentBBoxes=function(t,i,n){for(var r=n;r>=0;r--)h(i[r],t)},r.prototype._condense=function(t){for(var i=t.length-1,n=void 0;i>=0;i--)0===t[i].children.length?i>0?(n=t[i-1].children).splice(n.indexOf(t[i]),1):this.clear():a(t[i],this.toBBox)},r});var Kb=da(),ud=G(),Ua=[],wa=[],xa=[],Va=[],Zp=function(){function t(t,i,e,r){this.overlaps=e,this.pixelRatio=i,this.resolution=t,this.alignFill_,this.declutterItems=[],this.instructions=r.instructions,this.coordinates=r.coordinates,this.coordinateCache_={},this.renderedTransform_=G(),this.hitDetectionInstructions=r.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=r.fillStates||{},this.strokeStates=r.strokeStates||{},this.textStates=r.textStates||{},this.widths_={},this.labels_={}}return t.prototype.createLabel=function(t,i,e,r){var a=t+i+e+r;if(this.labels_[a])return this.labels_[a];var $=r?this.strokeStates[r]:null,s=e?this.fillStates[e]:null,o=this.textStates[i],n=this.pixelRatio,l=o.scale*n,p=tc[o.textAlign||kd],h=r&&$.lineWidth?$.lineWidth:0,T=t.split("\n"),L=T.length,v=[],m=Fo(o.font,T,v),u=Eo(o.font),c=u*L,Z=m+h,f=[],d={width:Math.ceil((Z+2)*l),height:Math.ceil((c+h)*l),contextInstructions:f};1!=l&&f.push("scale",[l,l]),f.push("font",o.font),r&&(f.push("strokeStyle",$.strokeStyle),f.push("lineWidth",h),f.push("lineCap",$.lineCap),f.push("lineJoin",$.lineJoin),f.push("miterLimit",$.miterLimit),CanvasRenderingContext2D.prototype.setLineDash&&(f.push("setLineDash",[$.lineDash]),f.push("lineDashOffset",$.lineDashOffset))),e&&f.push("fillStyle",s.fillStyle),f.push("textBaseline","middle"),f.push("textAlign","center");var x,_=.5-p,g=p*Z+_*h;if(r)for(x=0;x<L;++x)f.push("strokeText",[T[x],g+_*v[x],.5*(h+u)+x*u]);if(e)for(x=0;x<L;++x)f.push("fillText",[T[x],g+_*v[x],.5*(h+u)+x*u]);return this.labels_[a]=d,d},t.prototype.replayTextBackground_=function(t,i,e,r,a,$,s){t.beginPath(),t.moveTo.apply(t,i),t.lineTo.apply(t,e),t.lineTo.apply(t,r),t.lineTo.apply(t,a),t.lineTo.apply(t,i),$&&(this.alignFill_=$[2],this.fill_(t)),s&&(this.setStrokeStyle_(t,s),t.stroke())},t.prototype.replayImageOrLabel_=function(t,i,e,r,a,$,s,o,n,l,p,h,T,L,v,m,u,c){var Z=u||c;i-=a*=T,e-=$*=T;var f=v+l>r.width?r.width-l:v,d=o+p>r.height?r.height-p:o,x=m[3]+f*T+m[1],_=m[0]+d*T+m[2],g=i-m[3],y=e-m[0];(Z||0!==h)&&(Ua[0]=g,Va[0]=g,Ua[1]=y,wa[1]=y,wa[0]=g+x,xa[0]=wa[0],xa[1]=y+_,Va[1]=xa[1]);var I=null;if(0!==h){var b=i+a,S=e+$;I=ga(ud,b,S,1,1,h,-b,-S),ca(ud,Ua),ca(ud,wa),ca(ud,xa),ca(ud,Va),Ia(Math.min(Ua[0],wa[0],xa[0],Va[0]),Math.min(Ua[1],wa[1],xa[1],Va[1]),Math.max(Ua[0],wa[0],xa[0],Va[0]),Math.max(Ua[1],wa[1],xa[1],Va[1]),Kb)}else Ia(g,y,g+x,y+_,Kb);var k=t.canvas,C=c?c[2]*T/2:0,E=Kb[0]-C<=k.width&&Kb[2]+C>=0&&Kb[1]-C<=k.height&&Kb[3]+C>=0;if(L&&(i=Math.round(i),e=Math.round(e)),s){if(!E&&1==s[4])return;xf(s,Kb);var w=E?[t,I?I.slice(0):null,n,r,l,p,f,d,i,e,T]:null;w&&(Z&&w.push(u,c,Ua.slice(0),wa.slice(0),xa.slice(0),Va.slice(0)),s.push(w))}else E&&(Z&&this.replayTextBackground_(t,Ua,wa,xa,Va,u,c),Vj(t,I,n,r,l,p,f,d,i,e,T))},t.prototype.fill_=function(t){if(this.alignFill_){var i=ca(this.renderedTransform_,[0,0]),e=512*this.pixelRatio;t.save(),t.translate(i[0]%e,i[1]%e),t.rotate(this.viewRotation_)}t.fill(),this.alignFill_&&t.restore()},t.prototype.setStrokeStyle_=function(t,i){t.strokeStyle=i[1],t.lineWidth=i[2],t.lineCap=i[3],t.lineJoin=i[4],t.miterLimit=i[5],t.setLineDash&&(t.lineDashOffset=i[7],t.setLineDash(i[6]))},t.prototype.renderDeclutter=function(t,i,e,r){if(t&&t.length>5){var a=t[4];if(1==a||a==t.length-5){var $={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:i};var $tMOH$$interop$default=Cd(De);if(r||(r=new $tMOH$$interop$default.d(9)),!r.collides($)){r.insert($);for(var s=5,o=t.length;s<o;++s){var n=t[s],l=n[0],p=l.globalAlpha;p!==e&&(l.globalAlpha=e),n.length>11&&this.replayTextBackground_(n[0],n[13],n[14],n[15],n[16],n[11],n[12]),Vj.apply(void 0,n),p!==e&&(l.globalAlpha=p)}}t.length=5,cb(t)}}return r},t.prototype.drawLabelWithPointPlacement_=function(t,i,e,r){var a=this.textStates[i],$=this.createLabel(t,i,r,e),s=this.strokeStates[e],o=this.pixelRatio,n=tc[a.textAlign||kd],l=tc[a.textBaseline||ke],p=s&&s.lineWidth?s.lineWidth:0;return{label:$,anchorX:n*($.width/o-2*a.scale)+2*(.5-n)*p,anchorY:l*$.height/o+2*(.5-l)*p}},t.prototype.execute_=function(t,i,e,r,a,$){var s;this.declutterItems.length=0,this.pixelCoordinates_&&$a(i,this.renderedTransform_)?s=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),s=Ab(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),_i(this.renderedTransform_,i));for(var o,n,l,p,h,T,L,v,m,u,c,Z,f,d,x,_,g,y=0,I=e.length,b=0,S=0,k=0,C=null,E=null,w=this.coordinateCache_,R=this.viewRotation_,A=Math.round(1e12*Math.atan2(-i[1],i[0]))/1e12,O={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:R},M=this.instructions!=e||this.overlaps?0:200;y<I;){var D=e[y];switch(D[0]){case ba.BEGIN_GEOMETRY:(x=D[1]).getGeometry()?void 0===$||ea($,D[3])?++y:y=D[2]+1:y=D[2];break;case ba.BEGIN_PATH:S>M&&(this.fill_(t),S=0),k>M&&(t.stroke(),k=0),S||k||(t.beginPath(),p=NaN,h=NaN),++y;break;case ba.CIRCLE:var P=s[b=D[1]],q=s[b+1],W=s[b+2]-P,N=s[b+3]-q,j=Math.sqrt(W*W+N*N);t.moveTo(P+j,q),t.arc(P,q,j,0,2*Math.PI,!0),++y;break;case ba.CLOSE_PATH:t.closePath(),++y;break;case ba.CUSTOM:b=D[1],o=D[2];var B=D[3],G=D[4],F=6==D.length?D[5]:void 0;O.geometry=B,O.feature=x,y in w||(w[y]=[]);var X=w[y];F?F(s,b,o,2,X):(X[0]=s[b],X[1]=s[b+1],X.length=2),G(X,O),++y;break;case ba.DRAW_IMAGE:b=D[1],o=D[2],u=D[3],n=D[4],l=D[5],m=a?null:D[6];var Y=D[7],H=D[8],U=D[9],J=D[10],K=D[11],V=D[12],z=D[13],Q=D[14];if(!u&&D.length>=19){c=D[18],Z=D[19],f=D[20],d=D[21];var tt=this.drawLabelWithPointPlacement_(c,Z,f,d);u=tt.label,D[3]=u;var it=D[22];n=(tt.anchorX-it)*this.pixelRatio,D[4]=n;var et=D[23];l=(tt.anchorY-et)*this.pixelRatio,D[5]=l,Y=u.height,D[7]=Y,Q=u.width,D[14]=Q}var rt=void 0;D.length>24&&(rt=D[24]);var at=void 0,$t=void 0,st=void 0;D.length>16?(at=D[15],$t=D[16],st=D[17]):(at=nc,$t=!1,st=!1),K&&A?V+=R:K||A||(V-=R);for(var ot=0,nt=0;b<o;b+=2)if(!(rt&&rt[ot++]<Q/this.pixelRatio)){if(m){var lt=Math.floor(nt);m.length<lt+1&&((v=da()).push(m[0][4]),m.push(v)),v=m[lt]}this.replayImageOrLabel_(t,s[b],s[b+1],u,n,l,v,Y,H,U,J,V,z,r,Q,at,$t?C:null,st?E:null),v&&(nt===Math.floor(nt)&&this.declutterItems.push(this,v,x),nt+=1/v[4])}++y;break;case ba.DRAW_CHARS:var pt=D[1],ht=D[2],Tt=D[3];v=a?null:D[4];var Lt=D[5];d=D[6];var vt=D[7],mt=D[8],ut=D[9];f=D[10];var ct=D[11];c=D[12],Z=D[13];var Zt=D[14],ft=this.textStates[Z],dt=ft.font,xt=ft.scale*mt,_t=void 0;dt in this.widths_?_t=this.widths_[dt]:(_t={},this.widths_[dt]=_t);var gt=Bk(s,pt,ht,2),yt=xt*Tj(dt,c,_t);if(Lt||yt<=gt){var It=this.textStates[Z].textAlign,bt=(gt-yt)*tc[It],St=Yp(s,pt,ht,2,c,bt,vt,xt,Tj,dt,_t);if(St){var kt=void 0,Ct=void 0,Et=void 0,wt=void 0,Rt=void 0;if(f)for(kt=0,Ct=St.length;kt<Ct;++kt)Et=(Rt=St[kt])[4],wt=this.createLabel(Et,Z,"",f),n=Rt[2]+ct,l=Tt*wt.height+2*(.5-Tt)*ct-ut,this.replayImageOrLabel_(t,Rt[0],Rt[1],wt,n,l,v,wt.height,1,0,0,Rt[3],Zt,!1,wt.width,nc,null,null);if(d)for(kt=0,Ct=St.length;kt<Ct;++kt)Et=(Rt=St[kt])[4],wt=this.createLabel(Et,Z,d,""),n=Rt[2],l=Tt*wt.height-ut,this.replayImageOrLabel_(t,Rt[0],Rt[1],wt,n,l,v,wt.height,1,0,0,Rt[3],Zt,!1,wt.width,nc,null,null)}}this.declutterItems.push(this,v,x),++y;break;case ba.END_GEOMETRY:if(void 0!==a){var At=a(x=D[1]);if(At)return At}++y;break;case ba.FILL:M?S++:this.fill_(t),++y;break;case ba.MOVE_TO_LINE_TO:for(b=D[1],o=D[2],_=s[b],L=(g=s[b+1])+.5|0,(T=_+.5|0)===p&&L===h||(t.moveTo(_,g),p=T,h=L),b+=2;b<o;b+=2)T=(_=s[b])+.5|0,L=(g=s[b+1])+.5|0,b!=o-2&&T===p&&L===h||(t.lineTo(_,g),p=T,h=L);++y;break;case ba.SET_FILL_STYLE:C=D,this.alignFill_=D[2],S&&(this.fill_(t),S=0,k&&(t.stroke(),k=0)),t.fillStyle=D[1],++y;break;case ba.SET_STROKE_STYLE:E=D,k&&(t.stroke(),k=0),this.setStrokeStyle_(t,D),++y;break;case ba.STROKE:M?k++:t.stroke(),++y;break;default:++y;}}S&&this.fill_(t),k&&t.stroke()},t.prototype.execute=function(t,i,e,r){this.viewRotation_=e,this.execute_(t,i,this.instructions,r,void 0,void 0)},t.prototype.executeHitDetection=function(t,i,e,r,a){return this.viewRotation_=e,this.execute_(t,i,this.hitDetectionInstructions,!0,r,a)},t}();var qh=[y.POLYGON,y.CIRCLE,y.LINE_STRING,y.IMAGE,y.TEXT,y.DEFAULT],$p=function(){function r(r,t,e,i,o,$){this.maxExtent_=r,this.overlaps_=i,this.pixelRatio_=e,this.resolution_=t,this.renderBuffer_=$,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=G(),this.createExecutors_(o)}return r.prototype.clip=function(r,t){var e=this.getClipCoords(t);r.beginPath(),r.moveTo(e[0],e[1]),r.lineTo(e[2],e[3]),r.lineTo(e[4],e[5]),r.lineTo(e[6],e[7]),r.clip()},r.prototype.createExecutors_=function(r){for(var t in r){var e=this.executorsByZIndex_[t];void 0===e&&(e={},this.executorsByZIndex_[t]=e);var i=r[t];for(var o in i){var $=i[o];e[o]=new Zp(this.resolution_,this.pixelRatio_,this.overlaps_,$)}}},r.prototype.hasExecutors=function(r){for(var t in this.executorsByZIndex_)for(var e=this.executorsByZIndex_[t],i=0,o=r.length;i<o;++i)if(r[i]in e)return!0;return!1},r.prototype.forEachFeatureAtCoordinate=function(r,t,e,i,o,$){var s=2*(i=Math.round(i))+1,a=ga(this.hitDetectionTransform_,i+.5,i+.5,1/t,-1/t,-e,-r[0],-r[1]);this.hitDetectionContext_||(this.hitDetectionContext_=Z(s,s));var n,l=this.hitDetectionContext_;l.canvas.width!==s||l.canvas.height!==s?(l.canvas.width=s,l.canvas.height=s):l.clearRect(0,0,s,s),void 0!==this.renderBuffer_&&(n=da(),Jd(n,r),_b(n,t*(this.renderBuffer_+i),n));var c,C=_p(i);function p(r){for(var t=l.getImageData(0,0,s,s).data,e=0;e<s;e++)for(var i=0;i<s;i++)if(C[e][i]&&t[4*(i*s+e)+3]>0){var a=void 0;return(!$||c!=y.IMAGE&&c!=y.TEXT||-1!==$.indexOf(r))&&(a=o(r)),a||void l.clearRect(0,0,s,s)}}var u,f,j,v,d,h=Object.keys(this.executorsByZIndex_).map(Number);for(h.sort(Ea),u=h.length-1;u>=0;--u){var x=h[u].toString();for(j=this.executorsByZIndex_[x],f=qh.length-1;f>=0;--f)if(void 0!==(v=j[c=qh[f]])&&(d=v.executeHitDetection(l,a,e,p,n)))return d}},r.prototype.getClipCoords=function(r){var t=this.maxExtent_;if(!t)return null;var e=t[0],i=t[1],o=t[2],$=t[3],s=[e,i,e,$,o,$,o,i];return Ab(s,0,8,2,r,s),s},r.prototype.isEmpty=function(){return Lc(this.executorsByZIndex_)},r.prototype.execute=function(r,t,e,i,o,$){var s=Object.keys(this.executorsByZIndex_).map(Number);s.sort(Ea),this.maxExtent_&&(r.save(),this.clip(r,t));var a,n,l,c,C,p,u=o||qh;for(a=0,n=s.length;a<n;++a){var f=s[a].toString();for(C=this.executorsByZIndex_[f],l=0,c=u.length;l<c;++l){var j=u[l];if(void 0!==(p=C[j]))if(!$||j!=y.IMAGE&&j!=y.TEXT)p.execute(r,t,e,i);else{var v=$[f];v?v.push(p,t.slice(0)):$[f]=[p,t.slice(0)]}}}this.maxExtent_&&r.restore()},r}(),rh={0:[[!0]]};function qb(r,t,e){var i,o=Math.floor(r.length/2);if(t>=o)for(i=o;i<t;i++)r[i][e]=!0;else if(t<o)for(i=t+1;i<o;i++)r[i][e]=!0}function _p(r){if(void 0!==rh[r])return rh[r];for(var t=2*r+1,e=new Array(t),i=0;i<t;i++)e[i]=new Array(t);for(var o=r,$=0,s=0;o>=$;)qb(e,r+o,r+$),qb(e,r+$,r+o),qb(e,r-$,r+o),qb(e,r-o,r+$),qb(e,r-o,r-$),qb(e,r-$,r-o),qb(e,r+$,r-o),qb(e,r+o,r-$),2*((s+=1+2*++$)-o)+1>0&&(s+=1-2*(o-=1));return rh[r]=e,e}function aq(r,t,e,i,o,$){for(var s=Object.keys(r).map(Number).sort(Ea),a=0,n=s.length;a<n;++a)for(var l=r[s[a].toString()],c=void 0,C=0,p=l.length;C<p;){var u=l[C++];u!==c&&(c=u,$.push({items:u.declutterItems,opacity:i}));var f=l[C++];u.execute(t,f,e,o)}}var sh={};var th={};var bq=th&&th.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function a(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(a.prototype=r.prototype,new a)}}(),uh=function(t){function e(e){var r=t.call(this)||this;return r.boundHandleImageChange_=r.handleImageChange_.bind(r),r.layer_=e,r}return bq(e,t),e.prototype.getFeatures=function(t){return h()},e.prototype.prepareFrame=function(t){return h()},e.prototype.renderFrame=function(t,e){return h()},e.prototype.loadedTileCallback=function(t,e,r){t[e]||(t[e]={}),t[e][r.tileCoord.toString()]=r},e.prototype.createLoadedTileFinder=function(t,e,r){return function(a,o){var n=this.loadedTileCallback.bind(this,r,a);return t.forEachLoadedTile(e,a,o,n)}.bind(this)},e.prototype.forEachFeatureAtCoordinate=function(t,e,r,a,o){},e.prototype.getDataAtPixel=function(t,e,r){return h()},e.prototype.getLayer=function(){return this.layer_},e.prototype.handleFontsChanged=function(){},e.prototype.handleImageChange_=function(t){t.target.getState()===x.LOADED&&this.renderIfReadyAndVisible()},e.prototype.loadImage=function(t){var e=t.getState();return e!=x.LOADED&&e!=x.ERROR&&t.addEventListener(f.CHANGE,this.boundHandleImageChange_),e==x.IDLE&&(t.load(),e=t.getState()),e==x.LOADED},e.prototype.renderIfReadyAndVisible=function(){var t=this.getLayer();t.getVisible()&&t.getSourceState()==jb.READY&&t.changed()},e}(jf);th.default=uh;var cq=sh&&sh.__extends||function(){var t=function(r,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])})(r,e)};return function(r,e){function o(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),vh=function(t){function r(r){var e=t.call(this,r)||this;return e.container=null,e.renderedResolution,e.tempTransform_=G(),e.pixelTransform=G(),e.inversePixelTransform=G(),e.context=null,e.containerReused=!1,e.createTransformStringCanvas_=Z(1,1).canvas,e}return cq(r,t),r.prototype.useContainer=function(t,r,e){var o,n,a=this.getLayer().getClassName();t&&""===t.style.opacity&&t.className===a&&(s=t.firstElementChild)instanceof HTMLCanvasElement&&(n=s.getContext("2d"));if(n&&n.canvas.style.transform===r?(this.container=t,this.context=n,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),!this.container){(o=document.createElement("div")).className=a;var i=o.style;i.position="absolute",i.width="100%",i.height="100%";var s=(n=Z()).canvas;o.appendChild(s),(i=s.style).position="absolute",i.left="0",i.transformOrigin="top left",this.container=o,this.context=n}},r.prototype.clip=function(t,r,e){var o=r.pixelRatio,n=r.size[0]*o/2,a=r.size[1]*o/2,i=r.viewState.rotation,s=fb(e),$=yb(e),p=xb(e),m=eb(e);ca(r.coordinateToPixelTransform,s),ca(r.coordinateToPixelTransform,$),ca(r.coordinateToPixelTransform,p),ca(r.coordinateToPixelTransform,m),t.save(),Uj(t,-i,n,a),t.beginPath(),t.moveTo(s[0]*o,s[1]*o),t.lineTo($[0]*o,$[1]*o),t.lineTo(p[0]*o,p[1]*o),t.lineTo(m[0]*o,m[1]*o),t.clip(),Uj(t,i,n,a)},r.prototype.clipUnrotated=function(t,r,e){var o=fb(e),n=yb(e),a=xb(e),i=eb(e);ca(r.coordinateToPixelTransform,o),ca(r.coordinateToPixelTransform,n),ca(r.coordinateToPixelTransform,a),ca(r.coordinateToPixelTransform,i);var s=this.inversePixelTransform;ca(s,o),ca(s,n),ca(s,a),ca(s,i),t.save(),t.beginPath(),t.moveTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(n[0]),Math.round(n[1])),t.lineTo(Math.round(a[0]),Math.round(a[1])),t.lineTo(Math.round(i[0]),Math.round(i[1])),t.clip()},r.prototype.dispatchRenderEvent_=function(t,r,e){var o=this.getLayer();if(o.hasListener(t)){var n=new yg(t,this.inversePixelTransform,e,r);o.dispatchEvent(n)}},r.prototype.preRender=function(t,r){this.dispatchRenderEvent_(_a.PRERENDER,t,r)},r.prototype.postRender=function(t,r){this.dispatchRenderEvent_(_a.POSTRENDER,t,r)},r.prototype.getRenderTransform=function(t,r,e,o,n,a,i){var s=n/2,$=a/2,p=o/r,m=-p,c=-t[0]+i,l=-t[1];return ga(this.tempTransform_,s,$,p,m,-e,c,l)},r.prototype.getDataAtPixel=function(t,r,e){var o,n=ca(this.inversePixelTransform,t.slice()),a=this.context;try{o=a.getImageData(Math.round(n[0]),Math.round(n[1]),1,1).data}catch(i){return"SecurityError"===i.name?new Uint8Array:o}return 0===o[3]?null:o},r.prototype.createTransformString=function(t){return this.createTransformStringCanvas_.style.transform=Vd(t),this.createTransformStringCanvas_.style.transform},r}(uh);sh.default=vh;function dq(e,t,r,a,o,i,n){var s=e[0]/2,$=e[1]/2,c=Z(s,$);c.imageSmoothingEnabled=!1;for(var m=c.canvas,g=new ne(c,.5,o,null,n),p=r.length,h=Math.floor(16777215/p),l={},S=1;S<=p;++S){var U=r[S-1],v=U.getStyleFunction()||a;if(a){var F=v(U,i);if(F){Array.isArray(F)||(F=[F]);for(var d="#"+("000000"+(S*h).toString(16)).slice(-6),u=0,y=F.length;u<y;++u){var I=F[u],f=I.clone(),x=f.getFill();x&&x.setColor(d);var C=f.getStroke();C&&C.setColor(d),f.setText(void 0);var D=I.getImage();if(D){var w=D.getImageSize(),T=document.createElement("canvas");T.width=w[0],T.height=w[1];var G=T.getContext("2d",{alpha:!1});G.fillStyle=d;var j=G.canvas;G.fillRect(0,0,j.width,j.height);var q=w?w[0]:j.width,E=w?w[1]:j.height;Z(q,E).drawImage(j,0,0),f.setImage(new Fe({img:j,imgSize:w,anchor:D.getAnchor(),anchorXUnits:Q.PIXELS,anchorYUnits:Q.PIXELS,offset:D.getOrigin(),size:D.getSize(),opacity:D.getOpacity(),scale:D.getScale(),rotation:D.getRotation(),rotateWithView:D.getRotateWithView()}))}var b=Number(f.getZIndex());(R=l[b])||(R={},l[b]=R,R[k.POLYGON]=[],R[k.CIRCLE]=[],R[k.LINE_STRING]=[],R[k.POINT]=[]);var A=f.getGeometryFunction()(U);A&&ea(o,A.getExtent())&&R[A.getType().replace("Multi","")].push(A,f)}}}}for(var N=Object.keys(l).map(Number).sort(Ea),O=(S=0,N.length);S<O;++S){var R=l[N[S]];for(var L in R){var M=R[L];for(u=0,y=M.length;u<y;u+=2){g.setStyle(M[u+1]);for(var z=0,P=t.length;z<P;++z)g.setTransform(t[z]),g.drawGeometry(M[u])}}}return document.body.appendChild(c.canvas),c.getImageData(0,0,m.width,m.height)}function eq(e,t,r){var a=[];if(r){var o=4*(Math.round(e[0]/2)+Math.round(e[1]/2)*r.width),i=r.data[o],n=r.data[o+1],s=r.data[o+2]+256*(n+256*i),$=Math.floor(16777215/t.length);s&&s%$==0&&a.push(t[s/$-1])}return a}var wh={};var Q={FRACTION:"fraction",PIXELS:"pixels"};var Ee={};var uc={};var vd={};var fq=vd&&vd.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),Ok=function(t){function e(e,r,o,n){var i=t.call(this)||this;return i.extent=e,i.pixelRatio_=o,i.resolution=r,i.state=n,i}return fq(e,t),e.prototype.changed=function(){this.dispatchEvent(f.CHANGE)},e.prototype.getExtent=function(){return this.extent},e.prototype.getImage=function(){return h()},e.prototype.getPixelRatio=function(){return this.pixelRatio_},e.prototype.getResolution=function(){return this.resolution},e.prototype.getState=function(){return this.state},e.prototype.load=function(){h()},e}(Xb);vd.default=Ok;var gq=uc&&uc.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),hq=function(t){function e(e,n,i,r,o,a){var $=t.call(this,e,n,i,x.IDLE)||this;return $.src_=r,$.image_=new Image,null!==o&&($.image_.crossOrigin=o),$.unlisten_=null,$.state=x.IDLE,$.imageLoadFunction_=a,$}return gq(e,t),e.prototype.getImage=function(){return this.image_},e.prototype.handleImageError_=function(){this.state=x.ERROR,this.unlistenImage_(),this.changed()},e.prototype.handleImageLoad_=function(){void 0===this.resolution&&(this.resolution=Ja(this.extent)/this.image_.height),this.state=x.LOADED,this.unlistenImage_(),this.changed()},e.prototype.load=function(){this.state!=x.IDLE&&this.state!=x.ERROR||(this.state=x.LOADING,this.changed(),this.imageLoadFunction_(this,this.src_),this.unlisten_=xh(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},e.prototype.setImage=function(t){this.image_=t},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e}(Ok);function xh(t,e,n){var i=t;if(i.src&&oi){var r=i.decode(),o=!0;return r.then(function(){o&&e()}).catch(function(t){o&&("EncodingError"===t.name&&"Invalid image type."===t.message?e():n())}),function(){o=!1}}var a=[Vb(i,f.LOAD,e),Vb(i,f.ERROR,n)];return function(){a.forEach(m)}}uc.listenImage=xh,uc.default=hq;var iq=Ee&&Ee.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),Pk=function(t){function e(e,i,r,a,n,s){var o=t.call(this)||this;return o.hitDetectionImage_=null,o.image_=e||new Image,null!==a&&(o.image_.crossOrigin=a),o.canvas_=s?document.createElement("canvas"):null,o.color_=s,o.unlisten_=null,o.imageState_=n,o.size_=r,o.src_=i,o.tainted_,o}return iq(e,t),e.prototype.isTainted_=function(){if(void 0===this.tainted_&&this.imageState_===x.LOADED){this.tainted_=!1;var t=Z(1,1);try{t.drawImage(this.image_,0,0),t.getImageData(0,0,1,1)}catch(e){this.tainted_=!0}}return!0===this.tainted_},e.prototype.dispatchChangeEvent_=function(){this.dispatchEvent(f.CHANGE)},e.prototype.handleImageError_=function(){this.imageState_=x.ERROR,this.unlistenImage_(),this.dispatchChangeEvent_()},e.prototype.handleImageLoad_=function(){this.imageState_=x.LOADED,this.size_&&(this.image_.width=this.size_[0],this.image_.height=this.size_[1]),this.size_=[this.image_.width,this.image_.height],this.unlistenImage_(),this.replaceColor_(),this.dispatchChangeEvent_()},e.prototype.getImage=function(t){return this.canvas_?this.canvas_:this.image_},e.prototype.getImageState=function(){return this.imageState_},e.prototype.getHitDetectionImage=function(t){if(!this.hitDetectionImage_)if(this.isTainted_()){var e=this.size_[0],i=this.size_[1],r=Z(e,i);r.fillRect(0,0,e,i),this.hitDetectionImage_=r.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_},e.prototype.getSize=function(){return this.size_},e.prototype.getSrc=function(){return this.src_},e.prototype.load=function(){if(this.imageState_==x.IDLE){this.imageState_=x.LOADING;try{this.image_.src=this.src_}catch(t){this.handleImageError_()}this.unlisten_=xh(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this))}},e.prototype.replaceColor_=function(){if(this.color_&&!this.isTainted_()){this.canvas_.width=this.image_.width,this.canvas_.height=this.image_.height;var t=this.canvas_.getContext("2d");t.drawImage(this.image_,0,0);for(var e=t.getImageData(0,0,this.image_.width,this.image_.height),i=e.data,r=this.color_[0]/255,a=this.color_[1]/255,n=this.color_[2]/255,s=0,o=i.length;s<o;s+=4)i[s]*=r,i[s+1]*=a,i[s+2]*=n;t.putImageData(e,0,0)}},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e}(Xb);function Qk(t,e,i,r,a,n){var s=he.get(e,r,n);return s||(s=new Pk(t,e,i,r,a,n),he.set(e,r,n,s)),s}Ee.get=Qk,Ee.default=Pk;var I={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"};var jq=wh&&wh.__extends||function(){var i=function(t,o){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var o in t)t.hasOwnProperty(o)&&(i[o]=t[o])})(t,o)};return function(t,o){function r(){this.constructor=t}i(t,o),t.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),Fe=function(i){function t(t){var o=this,r=t||{},n=void 0!==r.opacity?r.opacity:1,e=void 0!==r.rotation?r.rotation:0,s=void 0!==r.scale?r.scale:1,c=void 0!==r.rotateWithView&&r.rotateWithView;(o=i.call(this,{opacity:n,rotation:e,scale:s,displacement:void 0!==r.displacement?r.displacement:[0,0],rotateWithView:c})||this).anchor_=void 0!==r.anchor?r.anchor:[.5,.5],o.normalizedAnchor_=null,o.anchorOrigin_=void 0!==r.anchorOrigin?r.anchorOrigin:I.TOP_LEFT,o.anchorXUnits_=void 0!==r.anchorXUnits?r.anchorXUnits:Q.FRACTION,o.anchorYUnits_=void 0!==r.anchorYUnits?r.anchorYUnits:Q.FRACTION,o.crossOrigin_=void 0!==r.crossOrigin?r.crossOrigin:null;var a=void 0!==r.img?r.img:null,l=void 0!==r.imgSize?r.imgSize:null,h=r.src;q(!(void 0!==h&&a),4),q(!a||a&&l,5),void 0!==h&&0!==h.length||!a||(h=a.src||aa(a)),q(void 0!==h&&h.length>0,6);var $=void 0!==r.src?x.IDLE:x.LOADED;return o.color_=void 0!==r.color?Ag(r.color):null,o.iconImage_=Qk(a,h,l,o.crossOrigin_,$,o.color_),o.offset_=void 0!==r.offset?r.offset:[0,0],o.offsetOrigin_=void 0!==r.offsetOrigin?r.offsetOrigin:I.TOP_LEFT,o.origin_=null,o.size_=void 0!==r.size?r.size:null,o}return jq(t,i),t.prototype.clone=function(){return new t({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,crossOrigin:this.crossOrigin_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,src:this.getSrc(),offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,size:null!==this.size_?this.size_.slice():void 0,opacity:this.getOpacity(),scale:this.getScale(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})},t.prototype.getAnchor=function(){if(this.normalizedAnchor_)return this.normalizedAnchor_;var i=this.anchor_,t=this.getSize();if(this.anchorXUnits_==Q.FRACTION||this.anchorYUnits_==Q.FRACTION){if(!t)return null;i=this.anchor_.slice(),this.anchorXUnits_==Q.FRACTION&&(i[0]*=t[0]),this.anchorYUnits_==Q.FRACTION&&(i[1]*=t[1])}if(this.anchorOrigin_!=I.TOP_LEFT){if(!t)return null;i===this.anchor_&&(i=this.anchor_.slice()),this.anchorOrigin_!=I.TOP_RIGHT&&this.anchorOrigin_!=I.BOTTOM_RIGHT||(i[0]=-i[0]+t[0]),this.anchorOrigin_!=I.BOTTOM_LEFT&&this.anchorOrigin_!=I.BOTTOM_RIGHT||(i[1]=-i[1]+t[1])}return this.normalizedAnchor_=i,this.normalizedAnchor_},t.prototype.setAnchor=function(i){this.anchor_=i,this.normalizedAnchor_=null},t.prototype.getColor=function(){return this.color_},t.prototype.getImage=function(i){return this.iconImage_.getImage(i)},t.prototype.getImageSize=function(){return this.iconImage_.getSize()},t.prototype.getHitDetectionImageSize=function(){return this.getImageSize()},t.prototype.getImageState=function(){return this.iconImage_.getImageState()},t.prototype.getHitDetectionImage=function(i){return this.iconImage_.getHitDetectionImage(i)},t.prototype.getOrigin=function(){if(this.origin_)return this.origin_;var i=this.offset_,t=this.getDisplacement();if(this.offsetOrigin_!=I.TOP_LEFT){var o=this.getSize(),r=this.iconImage_.getSize();if(!o||!r)return null;i=i.slice(),this.offsetOrigin_!=I.TOP_RIGHT&&this.offsetOrigin_!=I.BOTTOM_RIGHT||(i[0]=r[0]-o[0]-i[0]),this.offsetOrigin_!=I.BOTTOM_LEFT&&this.offsetOrigin_!=I.BOTTOM_RIGHT||(i[1]=r[1]-o[1]-i[1])}return i[0]+=t[0],i[1]+=t[1],this.origin_=i,this.origin_},t.prototype.getSrc=function(){return this.iconImage_.getSrc()},t.prototype.getSize=function(){return this.size_?this.size_:this.iconImage_.getSize()},t.prototype.listenImageChange=function(i){this.iconImage_.addEventListener(f.CHANGE,i)},t.prototype.load=function(){this.iconImage_.load()},t.prototype.unlistenImageChange=function(i){this.iconImage_.removeEventListener(f.CHANGE,i)},t}(Ck);wh.default=Fe;var yh={};var kq="#333",zh=function(){function t(t){var e=t||{};this.font_=e.font,this.rotation_=e.rotation,this.rotateWithView_=e.rotateWithView,this.scale_=e.scale,this.text_=e.text,this.textAlign_=e.textAlign,this.textBaseline_=e.textBaseline,this.fill_=void 0!==e.fill?e.fill:new nb({color:kq}),this.maxAngle_=void 0!==e.maxAngle?e.maxAngle:Math.PI/4,this.placement_=void 0!==e.placement?e.placement:Mk.POINT,this.overflow_=!!e.overflow,this.stroke_=void 0!==e.stroke?e.stroke:null,this.offsetX_=void 0!==e.offsetX?e.offsetX:0,this.offsetY_=void 0!==e.offsetY?e.offsetY:0,this.backgroundFill_=e.backgroundFill?e.backgroundFill:null,this.backgroundStroke_=e.backgroundStroke?e.backgroundStroke:null,this.padding_=void 0===e.padding?null:e.padding}return t.prototype.clone=function(){return new t({font:this.getFont(),placement:this.getPlacement(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:this.getScale(),text:this.getText(),textAlign:this.getTextAlign(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()})},t.prototype.getOverflow=function(){return this.overflow_},t.prototype.getFont=function(){return this.font_},t.prototype.getMaxAngle=function(){return this.maxAngle_},t.prototype.getPlacement=function(){return this.placement_},t.prototype.getOffsetX=function(){return this.offsetX_},t.prototype.getOffsetY=function(){return this.offsetY_},t.prototype.getFill=function(){return this.fill_},t.prototype.getRotateWithView=function(){return this.rotateWithView_},t.prototype.getRotation=function(){return this.rotation_},t.prototype.getScale=function(){return this.scale_},t.prototype.getStroke=function(){return this.stroke_},t.prototype.getText=function(){return this.text_},t.prototype.getTextAlign=function(){return this.textAlign_},t.prototype.getTextBaseline=function(){return this.textBaseline_},t.prototype.getBackgroundFill=function(){return this.backgroundFill_},t.prototype.getBackgroundStroke=function(){return this.backgroundStroke_},t.prototype.getPadding=function(){return this.padding_},t.prototype.setOverflow=function(t){this.overflow_=t},t.prototype.setFont=function(t){this.font_=t},t.prototype.setMaxAngle=function(t){this.maxAngle_=t},t.prototype.setOffsetX=function(t){this.offsetX_=t},t.prototype.setOffsetY=function(t){this.offsetY_=t},t.prototype.setPlacement=function(t){this.placement_=t},t.prototype.setRotateWithView=function(t){this.rotateWithView_=t},t.prototype.setFill=function(t){this.fill_=t},t.prototype.setRotation=function(t){this.rotation_=t},t.prototype.setScale=function(t){this.scale_=t},t.prototype.setStroke=function(t){this.stroke_=t},t.prototype.setText=function(t){this.text_=t},t.prototype.setTextAlign=function(t){this.textAlign_=t},t.prototype.setTextBaseline=function(t){this.textBaseline_=t},t.prototype.setBackgroundFill=function(t){this.backgroundFill_=t},t.prototype.setBackgroundStroke=function(t){this.backgroundStroke_=t},t.prototype.setPadding=function(t){this.padding_=t},t}();yh.default=zh;var lq=jh&&jh.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function a(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(a.prototype=r.prototype,new a)}}(),Rk=function(e){function t(t){var r=e.call(this,t)||this;return r.boundHandleStyleImageChange_=r.handleStyleImageChange_.bind(r),r.animatingOrInteracting_,r.dirty_=!1,r.hitDetectionImageData_=null,r.renderedFeatures_=null,r.renderedRevision_=-1,r.renderedResolution_=NaN,r.renderedExtent_=da(),r.renderedRotation_,r.renderedCenter_=null,r.renderedProjection_=null,r.renderedRenderOrder_=null,r.replayGroup_=null,r.replayGroupChanged=!0,r}return lq(t,e),t.prototype.useContainer=function(t,r,a){a<1&&(t=null),e.prototype.useContainer.call(this,t,r,a)},t.prototype.renderFrame=function(e,t){var r=e.pixelRatio,a=e.layerStatesArray[e.layerIndex];bj(this.pixelTransform,1/r,1/r),ic(this.inversePixelTransform,this.pixelTransform);var i=Vd(this.pixelTransform);this.useContainer(t,i,a.opacity);var n=this.context,o=n.canvas,s=this.replayGroup_;if(!s||s.isEmpty())return!this.containerReused&&o.width>0&&(o.width=0),this.container;var $=Math.round(e.size[0]*r),d=Math.round(e.size[1]*r);o.width!=$||o.height!=d?(o.width=$,o.height=d,o.style.transform!==i&&(o.style.transform=i)):this.containerReused||n.clearRect(0,0,$,d),this.preRender(n,e);var p=e.extent,u=e.viewState,h=u.center,c=u.resolution,l=u.projection,g=u.rotation,m=l.getExtent(),C=this.getLayer().getSource(),f=!1;if(a.extent){var v=Oa(a.extent,l);(f=!ra(v,e.extent)&&ea(v,e.extent))&&this.clip(n,e,v)}var _=e.viewHints,y=!(_[H.ANIMATING]||_[H.INTERACTING]),Q=this.getRenderTransform(h,c,g,r,$,d,0),x=this.getLayer().getDeclutter()?{}:null;if(s.execute(n,Q,g,y,void 0,x),C.getWrapX()&&l.canWrapX()&&!ra(m,p)){for(var R=p[0],I=ka(m),E=0,w=void 0;R<m[0];){w=I*--E;var T=this.getRenderTransform(h,c,g,r,$,d,w);s.execute(n,T,g,y,void 0,x),R+=I}for(E=0,R=p[2];R>m[2];){w=I*++E;var j=this.getRenderTransform(h,c,g,r,$,d,w);s.execute(n,j,g,y,void 0,x),R-=I}}if(x){var F=e.viewHints,G=!(F[H.ANIMATING]||F[H.INTERACTING]);aq(x,n,g,1,G,e.declutterItems)}f&&n.restore(),this.postRender(n,e);var S=a.opacity,A=this.container;return S!==parseFloat(A.style.opacity)&&(A.style.opacity=1===S?"":S),this.container},t.prototype.getFeatures=function(e){return new Promise(function(t,r){if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){var a=[this.context.canvas.width,this.context.canvas.height];ca(this.pixelTransform,a);var i=this.renderedCenter_,n=this.renderedResolution_,o=this.renderedRotation_,s=this.renderedProjection_,$=this.renderedExtent_,d=this.getLayer(),p=[],u=a[0]/2,h=a[1]/2;p.push(this.getRenderTransform(i,n,o,.5,u,h,0).slice());var c=d.getSource(),l=s.getExtent();if(c.getWrapX()&&s.canWrapX()&&!ra(l,$)){for(var g=$[0],m=ka(l),C=0,f=void 0;g<l[0];)f=m*--C,p.push(this.getRenderTransform(i,n,o,.5,u,h,f).slice()),g+=m;for(C=0,g=$[2];g>l[2];)f=m*++C,p.push(this.getRenderTransform(i,n,o,.5,u,h,f).slice()),g-=m}this.hitDetectionImageData_=dq(a,p,this.renderedFeatures_,d.getStyleFunction(),$,n,o)}t(eq(e,this.renderedFeatures_,this.hitDetectionImageData_))}.bind(this))},t.prototype.forEachFeatureAtCoordinate=function(e,t,r,a,i){if(this.replayGroup_){var n=t.viewState.resolution,o=t.viewState.rotation,s=this.getLayer(),$={};return this.replayGroup_.forEachFeatureAtCoordinate(e,n,o,r,function(e){var t=aa(e);if(!(t in $))return $[t]=!0,a(e,s)},s.getDeclutter()?i:null)}},t.prototype.handleFontsChanged=function(){var e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()},t.prototype.handleStyleImageChange_=function(e){this.renderIfReadyAndVisible()},t.prototype.prepareFrame=function(e){var t=this.getLayer(),r=t.getSource();if(!r)return!1;var a=e.viewHints[H.ANIMATING],i=e.viewHints[H.INTERACTING],n=t.getUpdateWhileAnimating(),o=t.getUpdateWhileInteracting();if(!this.dirty_&&!n&&a||!o&&i)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;var s=e.extent,$=e.viewState,d=$.projection,p=$.resolution,u=e.pixelRatio,h=t.getRevision(),c=t.getRenderBuffer(),l=t.getRenderOrder();void 0===l&&(l=Jo);var g=$.center.slice(),m=_b(s,c*p),C=$.projection.getExtent();if(r.getWrapX()&&$.projection.canWrapX()&&!ra(C,e.extent)){var f=ka(C),v=Math.max(ka(m)/2,f);m[0]=C[0]-v,m[2]=C[2]+v;var _=Math.floor((g[0]-C[0])/f);g[0]-=_*f}if(!this.dirty_&&this.renderedResolution_==p&&this.renderedRevision_==h&&this.renderedRenderOrder_==l&&ra(this.renderedExtent_,m))return this.replayGroupChanged=!1,!0;this.replayGroup_=null,this.dirty_=!1;var y,Q=new Xp(Yj(p,u),m,p,u,t.getDeclutter()),x=ib();x?(r.loadFeatures(fc(m,d),p,x),y=La(x,d)):r.loadFeatures(m,p,d);var R=Xj(p,u),I=function(e){var r,a=e.getStyleFunction()||t.getStyleFunction();if(a&&(r=a(e,p)),r){var i=this.renderFeature(e,R,r,Q,y);this.dirty_=this.dirty_||i}}.bind(this),E=fc(m,d),w=r.getFeaturesInExtent(E);l&&w.sort(l);for(var T=0,j=w.length;T<j;++T)I(w[T]);this.renderedFeatures_=w;var F=Q.finish(),G=new $p(m,p,u,r.getOverlaps(),F,t.getRenderBuffer());return this.renderedResolution_=p,this.renderedRevision_=h,this.renderedRenderOrder_=l,this.renderedExtent_=m,this.renderedRotation_=$.rotation,this.renderedCenter_=g,this.renderedProjection_=d,this.replayGroup_=G,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0},t.prototype.renderFeature=function(e,t,r,a,i){if(!r)return!1;var n=!1;if(Array.isArray(r))for(var o=0,s=r.length;o<s;++o)n=Zj(a,e,r[o],t,this.boundHandleStyleImageChange_,i)||n;else n=Zj(a,e,r,t,this.boundHandleStyleImageChange_,i);return n},t}(vh);jh.default=Rk;var mq=td&&td.__extends||function(){var e=function(r,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(r,t)};return function(r,t){function o(){this.constructor=r}e(r,t),r.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),vc=function(e){function r(r){return e.call(this,r)||this}return mq(r,e),r.prototype.createRenderer=function(){return new Rk(this)},r}(ih);td.default=vc;var wc={};var wd={};var xc={ARRAY_BUFFER:"arraybuffer",JSON:"json",TEXT:"text",XML:"xml"};var nq=!1;function Sk(e,t,r,i){return function($,o,a){var s=new XMLHttpRequest;s.open("GET","function"==typeof e?e($,o,a):e,!0),t.getType()==xc.ARRAY_BUFFER&&(s.responseType="arraybuffer"),s.withCredentials=nq,s.onload=function(e){if(!s.status||s.status>=200&&s.status<300){var o=t.getType(),n=void 0;o==xc.JSON||o==xc.TEXT?n=s.responseText:o==xc.XML?(n=s.responseXML)||(n=new DOMParser().parseFromString(s.responseText,"application/xml")):o==xc.ARRAY_BUFFER&&(n=s.response),n?r.call(this,t.readFeatures(n,{extent:$,featureProjection:a}),t.readProjection(n)):i.call(this)}else i.call(this)}.bind(this),s.onerror=function(){i.call(this)}.bind(this),s.send()}}function Ah(e,t){return Sk(e,t,function(e,t){"function"==typeof this.addFeatures&&this.addFeatures(e)},Da)}function oq(e){nq=e}wd.loadFeaturesXhr=Sk,wd.xhr=Ah,wd.setWithCredentials=oq;function pq(t,e){return[[-1/0,-1/0,1/0,1/0]]}var xd={};var qq=xd&&xd.__extends||function(){var t=function(r,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)r.hasOwnProperty(o)&&(t[o]=r[o])})(r,o)};return function(r,o){function e(){this.constructor=r}t(r,o),r.prototype=null===o?Object.create(o):(e.prototype=o.prototype,new e)}}(),Tk=function(t){function r(r){var o=t.call(this)||this;return o.projection_=E(r.projection),o.attributions_=Uk(r.attributions),o.attributionsCollapsible_=void 0===r.attributionsCollapsible||r.attributionsCollapsible,o.loading=!1,o.state_=void 0!==r.state?r.state:jb.READY,o.wrapX_=void 0!==r.wrapX&&r.wrapX,o}return qq(r,t),r.prototype.getAttributions=function(){return this.attributions_},r.prototype.getAttributionsCollapsible=function(){return this.attributionsCollapsible_},r.prototype.getProjection=function(){return this.projection_},r.prototype.getResolutions=function(){return h()},r.prototype.getState=function(){return this.state_},r.prototype.getWrapX=function(){return this.wrapX_},r.prototype.refresh=function(){this.changed()},r.prototype.setAttributions=function(t){this.attributions_=Uk(t),this.changed()},r.prototype.setState=function(t){this.state_=t,this.changed()},r}(X);function Uk(t){return t?Array.isArray(t)?function(r){return t}:"function"==typeof t?t:function(r){return[t]}:null}xd.default=Tk;var P={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature"};var Ge=function(){function t(t){var $tMOH$$interop$default=Cd(De);this.rbush_=new $tMOH$$interop$default.d(t),this.items_={}}return t.prototype.insert=function(t,r){var e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:r};this.rbush_.insert(e),this.items_[aa(r)]=e},t.prototype.load=function(t,r){for(var e=new Array(r.length),n=0,i=r.length;n<i;n++){var o=t[n],s=r[n],u={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:s};e[n]=u,this.items_[aa(s)]=u}this.rbush_.load(e)},t.prototype.remove=function(t){var r=aa(t),e=this.items_[r];return delete this.items_[r],null!==this.rbush_.remove(e)},t.prototype.update=function(t,r){var e=this.items_[aa(r)],n=[e.minX,e.minY,e.maxX,e.maxY];db(n,t)||(this.remove(r),this.insert(t,r))},t.prototype.getAll=function(){return this.rbush_.all().map(function(t){return t.value})},t.prototype.getInExtent=function(t){var r={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(r).map(function(t){return t.value})},t.prototype.forEach=function(t){return this.forEach_(this.getAll(),t)},t.prototype.forEachInExtent=function(t,r){return this.forEach_(this.getInExtent(t),r)},t.prototype.forEach_=function(t,r){for(var e,n=0,i=t.length;n<i;n++)if(e=r(t[n]))return e;return e},t.prototype.isEmpty=function(){return Lc(this.items_)},t.prototype.clear=function(){this.rbush_.clear(),this.items_={}},t.prototype.getExtent=function(t){var r=this.rbush_.toJSON();return Ia(r.minX,r.minY,r.maxX,r.maxY,t)},t.prototype.concat=function(t){for(var r in this.rbush_.load(t.rbush_.all()),t.items_)this.items_[r]=t.items_[r]},t}();var Vk=wc&&wc.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),yc=function(e){function t(t,r){var o=e.call(this,t)||this;return o.feature=r,o}return Vk(t,e),t}(T);wc.VectorSourceEvent=yc;var zc=function(e){function t(t){var r=this,o=t||{};(r=e.call(this,{attributions:o.attributions,projection:void 0,state:jb.READY,wrapX:void 0===o.wrapX||o.wrapX})||this).loader_=Da,r.format_=o.format,r.overlaps_=null==o.overlaps||o.overlaps,r.url_=o.url,void 0!==o.loader?r.loader_=o.loader:void 0!==r.url_&&(q(r.format_,7),r.loader_=Ah(r.url_,r.format_)),r.strategy_=void 0!==o.strategy?o.strategy:pq;var n,i,s=void 0===o.useSpatialIndex||o.useSpatialIndex;return r.featuresRtree_=s?new Ge:null,r.loadedExtentsRtree_=new Ge,r.nullGeometryFeatures_={},r.idIndex_={},r.uidIndex_={},r.featureChangeKeys_={},r.featuresCollection_=null,Array.isArray(o.features)?i=o.features:o.features&&(i=(n=o.features).getArray()),s||void 0!==n||(n=new K(i)),void 0!==i&&r.addFeaturesInternal(i),void 0!==n&&r.bindFeaturesCollection_(n),r}return Vk(t,e),t.prototype.addFeature=function(e){this.addFeatureInternal(e),this.changed()},t.prototype.addFeatureInternal=function(e){var t=aa(e);if(this.addToIndex_(t,e)){this.setupChangeEvents_(t,e);var r=e.getGeometry();if(r){var o=r.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(o,e)}else this.nullGeometryFeatures_[t]=e;this.dispatchEvent(new yc(P.ADDFEATURE,e))}else this.featuresCollection_&&this.featuresCollection_.remove(e)},t.prototype.setupChangeEvents_=function(e,t){this.featureChangeKeys_[e]=[d(t,f.CHANGE,this.handleFeatureChange_,this),d(t,Ya.PROPERTYCHANGE,this.handleFeatureChange_,this)]},t.prototype.addToIndex_=function(e,t){var r=!0,o=t.getId();return void 0!==o&&(o.toString()in this.idIndex_?r=!1:this.idIndex_[o.toString()]=t),r&&(q(!(e in this.uidIndex_),30),this.uidIndex_[e]=t),r},t.prototype.addFeatures=function(e){this.addFeaturesInternal(e),this.changed()},t.prototype.addFeaturesInternal=function(e){for(var t=[],r=[],o=[],n=0,i=e.length;n<i;n++){var s=e[n],a=aa(s);this.addToIndex_(a,s)&&r.push(s)}n=0;for(var u=r.length;n<u;n++){s=r[n],a=aa(s);this.setupChangeEvents_(a,s);var $=s.getGeometry();if($){var l=$.getExtent();t.push(l),o.push(s)}else this.nullGeometryFeatures_[a]=s}this.featuresRtree_&&this.featuresRtree_.load(t,o);n=0;for(var v=r.length;n<v;n++)this.dispatchEvent(new yc(P.ADDFEATURE,r[n]))},t.prototype.bindFeaturesCollection_=function(e){var t=!1;this.addEventListener(P.ADDFEATURE,function(r){t||(t=!0,e.push(r.feature),t=!1)}),this.addEventListener(P.REMOVEFEATURE,function(r){t||(t=!0,e.remove(r.feature),t=!1)}),e.addEventListener(C.ADD,function(e){t||(t=!0,this.addFeature(e.element),t=!1)}.bind(this)),e.addEventListener(C.REMOVE,function(e){t||(t=!0,this.removeFeature(e.element),t=!1)}.bind(this)),this.featuresCollection_=e},t.prototype.clear=function(e){if(e){for(var t in this.featureChangeKeys_){this.featureChangeKeys_[t].forEach(m)}this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_)for(var r in this.featuresRtree_.forEach(this.removeFeatureInternal.bind(this)),this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[r]);this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};var o=new yc(P.CLEAR);this.dispatchEvent(o),this.changed()},t.prototype.forEachFeature=function(e){if(this.featuresRtree_)return this.featuresRtree_.forEach(e);this.featuresCollection_&&this.featuresCollection_.forEach(e)},t.prototype.forEachFeatureAtCoordinateDirect=function(e,t){var r=[e[0],e[1],e[0],e[1]];return this.forEachFeatureInExtent(r,function(r){return r.getGeometry().intersectsCoordinate(e)?t(r):void 0})},t.prototype.forEachFeatureInExtent=function(e,t){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(e,t);this.featuresCollection_&&this.featuresCollection_.forEach(t)},t.prototype.forEachFeatureIntersectingExtent=function(e,t){return this.forEachFeatureInExtent(e,function(r){if(r.getGeometry().intersectsExtent(e)){var o=t(r);if(o)return o}})},t.prototype.getFeaturesCollection=function(){return this.featuresCollection_},t.prototype.getFeatures=function(){var e;return this.featuresCollection_?e=this.featuresCollection_.getArray():this.featuresRtree_&&(e=this.featuresRtree_.getAll(),Lc(this.nullGeometryFeatures_)||v(e,Ed(this.nullGeometryFeatures_))),e},t.prototype.getFeaturesAtCoordinate=function(e){var t=[];return this.forEachFeatureAtCoordinateDirect(e,function(e){t.push(e)}),t},t.prototype.getFeaturesInExtent=function(e){return this.featuresRtree_?this.featuresRtree_.getInExtent(e):this.featuresCollection_?this.featuresCollection_.getArray():[]},t.prototype.getClosestFeatureToCoordinate=function(e,t){var r=e[0],o=e[1],n=null,i=[NaN,NaN],s=1/0,a=[-1/0,-1/0,1/0,1/0],u=t||W;return this.featuresRtree_.forEachInExtent(a,function(e){if(u(e)){var t=e.getGeometry(),$=s;if((s=t.closestPointXY(r,o,i,s))<$){n=e;var l=Math.sqrt(s);a[0]=r-l,a[1]=o-l,a[2]=r+l,a[3]=o+l}}}),n},t.prototype.getExtent=function(e){return this.featuresRtree_.getExtent(e)},t.prototype.getFeatureById=function(e){var t=this.idIndex_[e.toString()];return void 0!==t?t:null},t.prototype.getFeatureByUid=function(e){var t=this.uidIndex_[e];return void 0!==t?t:null},t.prototype.getFormat=function(){return this.format_},t.prototype.getOverlaps=function(){return this.overlaps_},t.prototype.getUrl=function(){return this.url_},t.prototype.handleFeatureChange_=function(e){var t=e.target,r=aa(t),o=t.getGeometry();if(o){var n=o.getExtent();r in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[r],this.featuresRtree_&&this.featuresRtree_.insert(n,t)):this.featuresRtree_&&this.featuresRtree_.update(n,t)}else r in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(t),this.nullGeometryFeatures_[r]=t);var i=t.getId();if(void 0!==i){var s=i.toString();this.idIndex_[s]!==t&&(this.removeFromIdIndex_(t),this.idIndex_[s]=t)}else this.removeFromIdIndex_(t),this.uidIndex_[r]=t;this.changed(),this.dispatchEvent(new yc(P.CHANGEFEATURE,t))},t.prototype.hasFeature=function(e){var t=e.getId();return void 0!==t?t in this.idIndex_:aa(e)in this.uidIndex_},t.prototype.isEmpty=function(){return this.featuresRtree_.isEmpty()&&Lc(this.nullGeometryFeatures_)},t.prototype.loadFeatures=function(e,t,r){var o=this.loadedExtentsRtree_,n=this.strategy_(e,t);this.loading=!1;for(var i=function(e,i){var a=n[e];o.forEachInExtent(a,function(e){return ra(e.extent,a)})||(s.loader_.call(s,a,t,r),o.insert(a,{extent:a.slice()}),s.loading=s.loader_!==Da)},s=this,a=0,u=n.length;a<u;++a)i(a)},t.prototype.refresh=function(){this.clear(!0),this.loadedExtentsRtree_.clear(),e.prototype.refresh.call(this)},t.prototype.removeLoadedExtent=function(e){var t,r=this.loadedExtentsRtree_;r.forEachInExtent(e,function(r){if(db(r.extent,e))return t=r,!0}),t&&r.remove(t)},t.prototype.removeFeature=function(e){var t=aa(e);t in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[t]:this.featuresRtree_&&this.featuresRtree_.remove(e),this.removeFeatureInternal(e),this.changed()},t.prototype.removeFeatureInternal=function(e){var t=aa(e);this.featureChangeKeys_[t].forEach(m),delete this.featureChangeKeys_[t];var r=e.getId();void 0!==r&&delete this.idIndex_[r.toString()],delete this.uidIndex_[t],this.dispatchEvent(new yc(P.REMOVEFEATURE,e))},t.prototype.removeFromIdIndex_=function(e){var t=!1;for(var r in this.idIndex_)if(this.idIndex_[r]===e){delete this.idIndex_[r],t=!0;break}return t},t.prototype.setLoader=function(e){this.loader_=e},t.prototype.setUrl=function(e){q(this.format_,7),this.setLoader(Ah(e,this.format_))},t}(Tk);wc.default=zc;var Wk=rd&&rd.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),u={POINT:"Point",LINE_STRING:"LineString",POLYGON:"Polygon",CIRCLE:"Circle"},He={DRAWSTART:"drawstart",DRAWEND:"drawend",DRAWABORT:"drawabort"},Ie=function(e){function t(t,r){var i=e.call(this,t)||this;return i.feature=r,i}return Wk(t,e),t}(T),rq=function(e){function t(t){var r=this,i=t;i.stopDown||(i.stopDown=vb),(r=e.call(this,i)||this).shouldHandle_=!1,r.downPx_=null,r.downTimeout_,r.lastDragTime_,r.freehand_=!1,r.source_=t.source?t.source:null,r.features_=t.features?t.features:null,r.snapTolerance_=t.snapTolerance?t.snapTolerance:12,r.type_=t.type,r.mode_=vq(r.type_),r.stopClick_=!!t.stopClick,r.minPoints_=t.minPoints?t.minPoints:r.mode_===u.POLYGON?3:2,r.maxPoints_=t.maxPoints?t.maxPoints:1/0,r.finishCondition_=t.finishCondition?t.finishCondition:W;var o=t.geometryFunction;if(!o)if(r.type_===k.CIRCLE)o=function(e,t,r){var i=t||new ye([NaN,NaN]),o=w(e[0],r),n=U(o,w(e[1],r));i.setCenterAndRadius(o,Math.sqrt(n));var s=ib();return s&&i.transform(r,s),i};else{var n,s=r.mode_;s===u.POINT?n=Qa:s===u.LINE_STRING?n=mb:s===u.POLYGON&&(n=na),o=function(e,t,r){var i=t;return i?s===u.POLYGON?e[0].length?i.setCoordinates([e[0].concat([e[0][0]])]):i.setCoordinates([]):i.setCoordinates(e):i=new n(e),i}}return r.geometryFunction_=o,r.dragVertexDelay_=void 0!==t.dragVertexDelay?t.dragVertexDelay:500,r.finishCoordinate_=null,r.sketchFeature_=null,r.sketchPoint_=null,r.sketchCoords_=null,r.sketchLine_=null,r.sketchLineCoords_=null,r.squaredClickTolerance_=t.clickTolerance?t.clickTolerance*t.clickTolerance:36,r.overlay_=new vc({source:new zc({useSpatialIndex:!1,wrapX:!!t.wrapX&&t.wrapX}),style:t.style?t.style:sq(),updateWhileInteracting:!0}),r.geometryName_=t.geometryName,r.condition_=t.condition?t.condition:Kg,r.freehandCondition_,t.freehand?r.freehandCondition_=Jg:r.freehandCondition_=t.freehandCondition?t.freehandCondition:te,r.addEventListener(A(qe.ACTIVE),r.updateState_),r}return Wk(t,e),t.prototype.setMap=function(t){e.prototype.setMap.call(this,t),this.updateState_()},t.prototype.getOverlay=function(){return this.overlay_},t.prototype.handleEvent=function(t){t.originalEvent.type===f.CONTEXTMENU&&t.preventDefault(),this.freehand_=this.mode_!==u.POINT&&this.freehandCondition_(t);var r=t.type===j.POINTERMOVE,i=!0;!this.freehand_&&this.lastDragTime_&&t.type===j.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=t.pixel,this.shouldHandle_=!this.freehand_,r=!0):this.lastDragTime_=void 0,this.shouldHandle_&&void 0!==this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0));return this.freehand_&&t.type===j.POINTERDRAG&&null!==this.sketchFeature_?(this.addToDrawing_(t.coordinate),i=!1):this.freehand_&&t.type===j.POINTERDOWN?i=!1:r?(i=t.type===j.POINTERMOVE)&&this.freehand_?i=this.handlePointerMove_(t):("mouse"==t.pointerEvent.pointerType||t.type===j.POINTERDRAG&&void 0===this.downTimeout_)&&this.handlePointerMove_(t):t.type===j.DBLCLICK&&(i=!1),e.prototype.handleEvent.call(this,t)&&i},t.prototype.handleDownEvent=function(e){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=e.pixel,this.finishCoordinate_||this.startDrawing_(e),!0):this.condition_(e)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(function(){this.handlePointerMove_(new Fa(j.POINTERMOVE,e.map,e.pointerEvent,!1,e.frameState))}.bind(this),this.dragVertexDelay_),this.downPx_=e.pixel,!0):(this.lastDragTime_=void 0,!1)},t.prototype.handleUpEvent=function(e){var t=!0;this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(e);var r=this.mode_===u.CIRCLE;return this.shouldHandle_?(this.finishCoordinate_?this.freehand_||r?this.finishDrawing():this.atFinish_(e)?this.finishCondition_(e)&&this.finishDrawing():this.addToDrawing_(e.coordinate):(this.startDrawing_(e),this.mode_===u.POINT&&this.finishDrawing()),t=!1):this.freehand_&&this.abortDrawing(),!t&&this.stopClick_&&e.stopPropagation(),t},t.prototype.handlePointerMove_=function(e){if(this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){var t=this.downPx_,r=e.pixel,i=t[0]-r[0],o=t[1]-r[1],n=i*i+o*o;if(this.shouldHandle_=this.freehand_?n>this.squaredClickTolerance_:n<=this.squaredClickTolerance_,!this.shouldHandle_)return!0}return this.finishCoordinate_?this.modifyDrawing_(e):this.createOrUpdateSketchPoint_(e),!0},t.prototype.atFinish_=function(e){var t=!1;if(this.sketchFeature_){var r=!1,i=[this.finishCoordinate_];if(this.mode_===u.LINE_STRING)r=this.sketchCoords_.length>this.minPoints_;else if(this.mode_===u.POLYGON){var o=this.sketchCoords_;r=o[0].length>this.minPoints_,i=[o[0][0],o[0][o[0].length-2]]}if(r)for(var n=e.map,s=0,a=i.length;s<a;s++){var $=i[s],h=n.getPixelFromCoordinate($),L=e.pixel,l=L[0]-h[0],p=L[1]-h[1],d=this.freehand_?1:this.snapTolerance_;if(t=Math.sqrt(l*l+p*p)<=d){this.finishCoordinate_=$;break}}}return t},t.prototype.createOrUpdateSketchPoint_=function(e){var t=e.coordinate.slice();this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(t):(this.sketchPoint_=new va(new Qa(t)),this.updateSketchFeatures_())},t.prototype.startDrawing_=function(e){var t=e.coordinate,r=e.map.getView().getProjection();this.finishCoordinate_=t,this.mode_===u.POINT?this.sketchCoords_=t.slice():this.mode_===u.POLYGON?(this.sketchCoords_=[[t.slice(),t.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[t.slice(),t.slice()],this.sketchLineCoords_&&(this.sketchLine_=new va(new mb(this.sketchLineCoords_)));var i=this.geometryFunction_(this.sketchCoords_,void 0,r);this.sketchFeature_=new va,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(i),this.updateSketchFeatures_(),this.dispatchEvent(new Ie(He.DRAWSTART,this.sketchFeature_))},t.prototype.modifyDrawing_=function(e){var t,r,i,o=e.coordinate,n=this.sketchFeature_.getGeometry(),s=e.map.getView().getProjection();(this.mode_===u.POINT?r=this.sketchCoords_:this.mode_===u.POLYGON?(r=(t=this.sketchCoords_[0])[t.length-1],this.atFinish_(e)&&(o=this.finishCoordinate_.slice())):r=(t=this.sketchCoords_)[t.length-1],r[0]=o[0],r[1]=o[1],this.geometryFunction_(this.sketchCoords_,n,s),this.sketchPoint_)&&this.sketchPoint_.getGeometry().setCoordinates(o);if(n.getType()==k.POLYGON&&this.mode_!==u.POLYGON){this.sketchLine_||(this.sketchLine_=new va);var a=n.getLinearRing(0);(i=this.sketchLine_.getGeometry())?(i.setFlatCoordinates(a.getLayout(),a.getFlatCoordinates()),i.changed()):(i=new mb(a.getFlatCoordinates(),a.getLayout()),this.sketchLine_.setGeometry(i))}else this.sketchLineCoords_&&(i=this.sketchLine_.getGeometry()).setCoordinates(this.sketchLineCoords_);this.updateSketchFeatures_()},t.prototype.addToDrawing_=function(e){var t,r,i=this.sketchFeature_.getGeometry(),o=this.getMap().getView().getProjection();this.mode_===u.LINE_STRING?(this.finishCoordinate_=e.slice(),(r=this.sketchCoords_).length>=this.maxPoints_&&(this.freehand_?r.pop():t=!0),r.push(e.slice()),this.geometryFunction_(r,i,o)):this.mode_===u.POLYGON&&((r=this.sketchCoords_[0]).length>=this.maxPoints_&&(this.freehand_?r.pop():t=!0),r.push(e.slice()),t&&(this.finishCoordinate_=r[0]),this.geometryFunction_(this.sketchCoords_,i,o)),this.updateSketchFeatures_(),t&&this.finishDrawing()},t.prototype.removeLastPoint=function(){if(this.sketchFeature_){var e,t=this.sketchFeature_.getGeometry(),r=this.getMap().getView().getProjection();this.mode_===u.LINE_STRING?((e=this.sketchCoords_).splice(-2,1),this.geometryFunction_(e,t,r),e.length>=2&&(this.finishCoordinate_=e[e.length-2].slice())):this.mode_===u.POLYGON&&((e=this.sketchCoords_[0]).splice(-2,1),this.sketchLine_.getGeometry().setCoordinates(e),this.geometryFunction_(this.sketchCoords_,t,r)),0===e.length&&this.abortDrawing(),this.updateSketchFeatures_()}},t.prototype.finishDrawing=function(){var e=this.abortDrawing_();if(e){var t=this.sketchCoords_,r=e.getGeometry(),i=this.getMap().getView().getProjection();this.mode_===u.LINE_STRING?(t.pop(),this.geometryFunction_(t,r,i)):this.mode_===u.POLYGON&&(t[0].pop(),this.geometryFunction_(t,r,i),t=r.getCoordinates()),this.type_===k.MULTI_POINT?e.setGeometry(new Ae([t])):this.type_===k.MULTI_LINE_STRING?e.setGeometry(new ze([t])):this.type_===k.MULTI_POLYGON&&e.setGeometry(new bh([t])),this.dispatchEvent(new Ie(He.DRAWEND,e)),this.features_&&this.features_.push(e),this.source_&&this.source_.addFeature(e)}},t.prototype.abortDrawing_=function(){this.finishCoordinate_=null;var e=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),e},t.prototype.abortDrawing=function(){var e=this.abortDrawing_();e&&this.dispatchEvent(new Ie(He.DRAWABORT,e))},t.prototype.appendCoordinates=function(e){var t=this.mode_,r=[];t===u.LINE_STRING?r=this.sketchCoords_:t===u.POLYGON&&(r=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[]);for(var i=r.pop(),o=0;o<e.length;o++)this.addToDrawing_(e[o]);this.addToDrawing_(i)},t.prototype.extend=function(e){var t=e.getGeometry();this.sketchFeature_=e,this.sketchCoords_=t.getCoordinates();var r=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=r.slice(),this.sketchCoords_.push(r.slice()),this.updateSketchFeatures_(),this.dispatchEvent(new Ie(He.DRAWSTART,this.sketchFeature_))},t.prototype.updateSketchFeatures_=function(){var e=[];this.sketchFeature_&&e.push(this.sketchFeature_),this.sketchLine_&&e.push(this.sketchLine_),this.sketchPoint_&&e.push(this.sketchPoint_);var t=this.overlay_.getSource();t.clear(!0),t.addFeatures(e)},t.prototype.updateState_=function(){var e=this.getMap(),t=this.getActive();e&&t||this.abortDrawing(),this.overlay_.setMap(t?e:null)},t}($);function sq(){var e=rc();return function(t,r){return e[t.getGeometry().getType()]}}function tq(e,t){return function(r,i,o){var n=w(r[0],o),s=w(r[1],o),a=Math.sqrt(U(n,s)),$=i||hg(new ye(n),e),h=t;if(!t){var L=s[0]-n[0],l=s[1]-n[1];h=Math.atan(l/L)-(L<0?Math.PI:0)}ig($,n,a,h);var p=ib();return p&&$.transform(o,p),$}}function uq(){return function(e,t,r){var i=D(e.map(function(e){return w(e,r)})),o=[[eb(i),xb(i),yb(i),fb(i),eb(i)]],n=t;n?n.setCoordinates(o):n=new na(o);var s=ib();return s&&n.transform(r,s),n}}function vq(e){var t;return e===k.POINT||e===k.MULTI_POINT?t=u.POINT:e===k.LINE_STRING||e===k.MULTI_LINE_STRING?t=u.LINE_STRING:e===k.POLYGON||e===k.MULTI_POLYGON?t=u.POLYGON:e===k.CIRCLE&&(t=u.CIRCLE),t}rd.createRegularPolygon=tq,rd.createBox=uq,rd.default=rq;var Bh={};var Xk=Bh&&Bh.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),wq={EXTENTCHANGED:"extentchanged"},xq=function(e){function t(t){var r=e.call(this,wq.EXTENTCHANGED)||this;return r.extent=t,r}return Xk(t,e),t}(T),yq=function(e){function t(t){var r=this,n=t||{};return(r=e.call(this,n)||this).extent_=null,r.pointerHandler_=null,r.pixelTolerance_=void 0!==n.pixelTolerance?n.pixelTolerance:10,r.snappedToVertex_=!1,r.extentFeature_=null,r.vertexFeature_=null,t||(t={}),r.extentOverlay_=new vc({source:new zc({useSpatialIndex:!1,wrapX:!!t.wrapX}),style:t.boxStyle?t.boxStyle:zq(),updateWhileAnimating:!0,updateWhileInteracting:!0}),r.vertexOverlay_=new vc({source:new zc({useSpatialIndex:!1,wrapX:!!t.wrapX}),style:t.pointerStyle?t.pointerStyle:Aq(),updateWhileAnimating:!0,updateWhileInteracting:!0}),t.extent&&r.setExtent(t.extent),r}return Xk(t,e),t.prototype.snapToVertex_=function(e,t){var r=t.getCoordinateFromPixelInternal(e),n=this.getExtentInternal();if(n){var o=Bq(n);o.sort(function(e,t){return _c(r,e)-_c(r,t)});var i=o[0],a=Zc(r,i),$=t.getPixelFromCoordinateInternal(a);if($c(e,$)<=this.pixelTolerance_){var l=t.getPixelFromCoordinateInternal(i[0]),p=t.getPixelFromCoordinateInternal(i[1]),u=U($,l),y=U($,p),s=Math.sqrt(Math.min(u,y));return this.snappedToVertex_=s<=this.pixelTolerance_,this.snappedToVertex_&&(a=u>y?i[1]:i[0]),a}}return null},t.prototype.handlePointerMove_=function(e){var t=e.pixel,r=e.map,n=this.snapToVertex_(t,r);n||(n=r.getCoordinateFromPixelInternal(t)),this.createOrUpdatePointerFeature_(n)},t.prototype.createOrUpdateExtentFeature_=function(e){var t=this.extentFeature_;return t?e?t.setGeometry(Fb(e)):t.setGeometry(void 0):(t=e?new va(Fb(e)):new va({}),this.extentFeature_=t,this.extentOverlay_.getSource().addFeature(t)),t},t.prototype.createOrUpdatePointerFeature_=function(e){var t=this.vertexFeature_;t?t.getGeometry().setCoordinates(e):(t=new va(new Qa(e)),this.vertexFeature_=t,this.vertexOverlay_.getSource().addFeature(t));return t},t.prototype.handleEvent=function(t){return!t.pointerEvent||(t.type!=j.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(t),e.prototype.handleEvent.call(this,t),!1)},t.prototype.handleDownEvent=function(e){var t=e.pixel,r=e.map,n=this.getExtentInternal(),o=this.snapToVertex_(t,r),i=function(e){var t=null,r=null;return e[0]==n[0]?t=n[2]:e[0]==n[2]&&(t=n[0]),e[1]==n[1]?r=n[3]:e[1]==n[3]&&(r=n[1]),null!==t&&null!==r?[t,r]:null};if(o&&n){var a=o[0]==n[0]||o[0]==n[2]?o[0]:null,$=o[1]==n[1]||o[1]==n[3]?o[1]:null;null!==a&&null!==$?this.pointerHandler_=Yk(i(o)):null!==a?this.pointerHandler_=Zk(i([a,n[1]]),i([a,n[3]])):null!==$&&(this.pointerHandler_=Zk(i([n[0],$]),i([n[2],$])))}else o=r.getCoordinateFromPixelInternal(t),this.setExtent([o[0],o[1],o[0],o[1]]),this.pointerHandler_=Yk(o);return!0},t.prototype.handleDragEvent=function(e){if(this.pointerHandler_){var t=e.coordinate;this.setExtent(this.pointerHandler_(t)),this.createOrUpdatePointerFeature_(t)}return!0},t.prototype.handleUpEvent=function(e){this.pointerHandler_=null;var t=this.getExtentInternal();return t&&0!==Bf(t)||this.setExtent(null),!1},t.prototype.setMap=function(t){this.extentOverlay_.setMap(t),this.vertexOverlay_.setMap(t),e.prototype.setMap.call(this,t)},t.prototype.getExtent=function(){return fc(this.getExtentInternal(),this.getMap().getView().getProjection())},t.prototype.getExtentInternal=function(){return this.extent_},t.prototype.setExtent=function(e){this.extent_=e||null,this.createOrUpdateExtentFeature_(e),this.dispatchEvent(new xq(this.extent_))},t}($);function zq(){var e=rc();return function(t,r){return e[k.POLYGON]}}function Aq(){var e=rc();return function(t,r){return e[k.POINT]}}function Yk(e){return function(t){return D([e,t])}}function Zk(e,t){return e[0]==t[0]?function(r){return D([e,[r[0],t[1]]])}:e[1]==t[1]?function(r){return D([e,[t[0],r[1]]])}:null}function Bq(e){return[[[e[0],e[1]],[e[0],e[3]]],[[e[0],e[3]],[e[2],e[3]]],[[e[2],e[3]],[e[2],e[1]]],[[e[2],e[1]],[e[0],e[1]]]]}Bh.default=yq;var Je={};var $k=Je&&Je.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),_k=0,yd=1,al=[0,0,0,0],Ac=[],Ch={MODIFYSTART:"modifystart",MODIFYEND:"modifyend"},Ke=function(e){function t(t,r,i){var o=e.call(this,t)||this;return o.features=r,o.mapBrowserEvent=i,o}return $k(t,e),t}(T);Je.ModifyEvent=Ke;var Cq=function(e){function t(t){var r,i=e.call(this,t)||this;if(i.boundHandleFeatureChange_=i.handleFeatureChange_.bind(i),i.condition_=t.condition?t.condition:mk,i.defaultDeleteCondition_=function(e){return ip(e)&&kk(e)},i.deleteCondition_=t.deleteCondition?t.deleteCondition:i.defaultDeleteCondition_,i.insertVertexCondition_=t.insertVertexCondition?t.insertVertexCondition:Jg,i.vertexFeature_=null,i.vertexSegments_=null,i.lastPixel_=[0,0],i.ignoreNextSingleClick_=!1,i.modified_=!1,i.rBush_=new Ge,i.pixelTolerance_=void 0!==t.pixelTolerance?t.pixelTolerance:10,i.snappedToVertex_=!1,i.changingFeature_=!1,i.dragSegments_=[],i.overlay_=new vc({source:new zc({useSpatialIndex:!1,wrapX:!!t.wrapX}),style:t.style?t.style:Eq(),updateWhileAnimating:!0,updateWhileInteracting:!0}),i.SEGMENT_WRITERS_={Point:i.writePointGeometry_.bind(i),LineString:i.writeLineStringGeometry_.bind(i),LinearRing:i.writeLineStringGeometry_.bind(i),Polygon:i.writePolygonGeometry_.bind(i),MultiPoint:i.writeMultiPointGeometry_.bind(i),MultiLineString:i.writeMultiLineStringGeometry_.bind(i),MultiPolygon:i.writeMultiPolygonGeometry_.bind(i),Circle:i.writeCircleGeometry_.bind(i),GeometryCollection:i.writeGeometryCollectionGeometry_.bind(i)},i.source_=null,t.source?(i.source_=t.source,r=new K(i.source_.getFeatures()),i.source_.addEventListener(P.ADDFEATURE,i.handleSourceAdd_.bind(i)),i.source_.addEventListener(P.REMOVEFEATURE,i.handleSourceRemove_.bind(i))):r=t.features,!r)throw new Error("The modify interaction requires features or a source");return i.features_=r,i.features_.forEach(i.addFeature_.bind(i)),i.features_.addEventListener(C.ADD,i.handleFeatureAdd_.bind(i)),i.features_.addEventListener(C.REMOVE,i.handleFeatureRemove_.bind(i)),i.lastPointerEvent_=null,i}return $k(t,e),t.prototype.addFeature_=function(e){var t=e.getGeometry();if(t){var r=this.SEGMENT_WRITERS_[t.getType()];r&&r(e,t)}var i=this.getMap();i&&i.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,i),e.addEventListener(f.CHANGE,this.boundHandleFeatureChange_)},t.prototype.willModifyFeatures_=function(e){this.modified_||(this.modified_=!0,this.dispatchEvent(new Ke(Ch.MODIFYSTART,this.features_,e)))},t.prototype.removeFeature_=function(e){this.removeFeatureSegmentData_(e),this.vertexFeature_&&0===this.features_.getLength()&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.removeEventListener(f.CHANGE,this.boundHandleFeatureChange_)},t.prototype.removeFeatureSegmentData_=function(e){var t=this.rBush_,r=[];t.forEach(function(t){e===t.feature&&r.push(t)});for(var i=r.length-1;i>=0;--i){for(var o=r[i],n=this.dragSegments_.length-1;n>=0;--n)this.dragSegments_[n][0]===o&&this.dragSegments_.splice(n,1);t.remove(o)}},t.prototype.setActive=function(t){this.vertexFeature_&&!t&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),e.prototype.setActive.call(this,t)},t.prototype.setMap=function(t){this.overlay_.setMap(t),e.prototype.setMap.call(this,t)},t.prototype.getOverlay=function(){return this.overlay_},t.prototype.handleSourceAdd_=function(e){e.feature&&this.features_.push(e.feature)},t.prototype.handleSourceRemove_=function(e){e.feature&&this.features_.remove(e.feature)},t.prototype.handleFeatureAdd_=function(e){this.addFeature_(e.element)},t.prototype.handleFeatureChange_=function(e){if(!this.changingFeature_){var t=e.target;this.removeFeature_(t),this.addFeature_(t)}},t.prototype.handleFeatureRemove_=function(e){var t=e.element;this.removeFeature_(t)},t.prototype.writePointGeometry_=function(e,t){var r=t.getCoordinates(),i={feature:e,geometry:t,segment:[r,r]};this.rBush_.insert(t.getExtent(),i)},t.prototype.writeMultiPointGeometry_=function(e,t){for(var r=t.getCoordinates(),i=0,o=r.length;i<o;++i){var n=r[i],a={feature:e,geometry:t,depth:[i],index:i,segment:[n,n]};this.rBush_.insert(t.getExtent(),a)}},t.prototype.writeLineStringGeometry_=function(e,t){for(var r=t.getCoordinates(),i=0,o=r.length-1;i<o;++i){var n=r.slice(i,i+2),a={feature:e,geometry:t,index:i,segment:n};this.rBush_.insert(D(n),a)}},t.prototype.writeMultiLineStringGeometry_=function(e,t){for(var r=t.getCoordinates(),i=0,o=r.length;i<o;++i)for(var n=r[i],a=0,s=n.length-1;a<s;++a){var $=n.slice(a,a+2),p={feature:e,geometry:t,depth:[i],index:a,segment:$};this.rBush_.insert(D($),p)}},t.prototype.writePolygonGeometry_=function(e,t){for(var r=t.getCoordinates(),i=0,o=r.length;i<o;++i)for(var n=r[i],a=0,s=n.length-1;a<s;++a){var $=n.slice(a,a+2),p={feature:e,geometry:t,depth:[i],index:a,segment:$};this.rBush_.insert(D($),p)}},t.prototype.writeMultiPolygonGeometry_=function(e,t){for(var r=t.getCoordinates(),i=0,o=r.length;i<o;++i)for(var n=r[i],a=0,s=n.length;a<s;++a)for(var $=n[a],p=0,u=$.length-1;p<u;++p){var d=$.slice(p,p+2),m={feature:e,geometry:t,depth:[a,i],index:p,segment:d};this.rBush_.insert(D(d),m)}},t.prototype.writeCircleGeometry_=function(e,t){var r=t.getCenter(),i={feature:e,geometry:t,index:_k,segment:[r,r]},o={feature:e,geometry:t,index:yd,segment:[r,r]},n=[i,o];i.featureSegments=n,o.featureSegments=n,this.rBush_.insert(Xc(r),i),this.rBush_.insert(t.getExtent(),o)},t.prototype.writeGeometryCollectionGeometry_=function(e,t){for(var r=t.getGeometriesArray(),i=0;i<r.length;++i){var o=r[i];(0,this.SEGMENT_WRITERS_[o.getType()])(e,o)}},t.prototype.createOrUpdateVertexFeature_=function(e){var t=this.vertexFeature_;t?t.getGeometry().setCoordinates(e):(t=new va(new Qa(e)),this.vertexFeature_=t,this.overlay_.getSource().addFeature(t));return t},t.prototype.handleEvent=function(t){return!t.pointerEvent||(this.lastPointerEvent_=t,t.map.getView().getInteracting()||t.type!=j.POINTERMOVE||this.handlingDownUpSequence||this.handlePointerMove_(t),this.vertexFeature_&&this.deleteCondition_(t)&&(r=!(t.type!=j.SINGLECLICK||!this.ignoreNextSingleClick_)||this.removePoint()),t.type==j.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),e.prototype.handleEvent.call(this,t)&&!r);var r},t.prototype.handleDragEvent=function(e){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(e);for(var t=e.coordinate,r=0,i=this.dragSegments_.length;r<i;++r){for(var o=this.dragSegments_[r],n=o[0],a=n.depth,s=n.geometry,$=void 0,p=n.segment,u=o[1];t.length<s.getStride();)t.push(p[u][t.length]);switch(s.getType()){case k.POINT:$=t,p[0]=t,p[1]=t;break;case k.MULTI_POINT:($=s.getCoordinates())[n.index]=t,p[0]=t,p[1]=t;break;case k.LINE_STRING:($=s.getCoordinates())[n.index+u]=t,p[u]=t;break;case k.MULTI_LINE_STRING:case k.POLYGON:($=s.getCoordinates())[a[0]][n.index+u]=t,p[u]=t;break;case k.MULTI_POLYGON:($=s.getCoordinates())[a[1]][a[0]][n.index+u]=t,p[u]=t;break;case k.CIRCLE:p[0]=t,p[1]=t,n.index===_k?(this.changingFeature_=!0,s.setCenter(t),this.changingFeature_=!1):(this.changingFeature_=!0,s.setRadius($c(s.getCenter(),t)),this.changingFeature_=!1);}$&&this.setGeometryCoordinates_(s,$)}this.createOrUpdateVertexFeature_(t)},t.prototype.handleDownEvent=function(e){if(!this.condition_(e))return!1;var t=e.coordinate;this.handlePointerAtPixel_(e.pixel,e.map,t),this.dragSegments_.length=0,this.modified_=!1;var r=this.vertexFeature_;if(r){var i=e.map.getView().getProjection(),o=[],n=r.getGeometry().getCoordinates(),a=D([n]),s=this.rBush_.getInExtent(a),$={};s.sort(Dq);for(var p=0,u=s.length;p<u;++p){var d=s[p],m=d.segment,g=aa(d.feature),h=d.depth;if(h&&(g+="-"+h.join("-")),$[g]||($[g]=new Array(2)),d.geometry.getType()!==k.CIRCLE||d.index!==yd){if(!la(m[0],n)||$[g][0]){if(!la(m[1],n)||$[g][1])aa(m)in this.vertexSegments_&&!$[g][0]&&!$[g][1]&&this.insertVertexCondition_(e)&&o.push([d,n]);else{if((d.geometry.getType()===k.LINE_STRING||d.geometry.getType()===k.MULTI_LINE_STRING)&&$[g][0]&&0===$[g][0].index)continue;this.dragSegments_.push([d,1]),$[g][1]=d}}else this.dragSegments_.push([d,0]),$[g][0]=d;}else{var l=cl(t,d,i);la(l,n)&&!$[g][0]&&(this.dragSegments_.push([d,0]),$[g][0]=d)}}o.length&&this.willModifyFeatures_(e);for(var _=o.length-1;_>=0;--_)this.insertVertex_.apply(this,o[_])}return!!this.vertexFeature_},t.prototype.handleUpEvent=function(e){for(var t=this.dragSegments_.length-1;t>=0;--t){var r=this.dragSegments_[t][0],i=r.geometry;if(i.getType()===k.CIRCLE){var o=i.getCenter(),n=r.featureSegments[0],a=r.featureSegments[1];n.segment[0]=o,n.segment[1]=o,a.segment[0]=o,a.segment[1]=o,this.rBush_.update(Xc(o),n),this.rBush_.update(i.getExtent(),a)}else this.rBush_.update(D(r.segment),r)}return this.modified_&&(this.dispatchEvent(new Ke(Ch.MODIFYEND,this.features_,e)),this.modified_=!1),!1},t.prototype.handlePointerMove_=function(e){this.lastPixel_=e.pixel,this.handlePointerAtPixel_(e.pixel,e.map,e.coordinate)},t.prototype.handlePointerAtPixel_=function(e,t,r){var i=r||t.getCoordinateFromPixel(e),o=t.getView().getProjection(),n=Oa(Xc(i,al),o),a=t.getView().getResolution()*this.pixelTolerance_,s=fc(_b(n,a,al),o),$=this.rBush_.getInExtent(s);if($.length>0){$.sort(function(e,t){return bl(i,e,o)-bl(i,t,o)});var p=$[0],u=p.segment,d=cl(i,p,o),m=t.getPixelFromCoordinate(d),g=$c(e,m);if(g<=this.pixelTolerance_){var h={};if(p.geometry.getType()===k.CIRCLE&&p.index===yd)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(d);else{var l=t.getPixelFromCoordinate(u[0]),_=t.getPixelFromCoordinate(u[1]),c=U(m,l),v=U(m,_);g=Math.sqrt(Math.min(c,v)),this.snappedToVertex_=g<=this.pixelTolerance_,this.snappedToVertex_&&(d=c>v?u[1]:u[0]),this.createOrUpdateVertexFeature_(d);for(var y=1,D=$.length;y<D;++y){var f=$[y].segment;if(!(la(u[0],f[0])&&la(u[1],f[1])||la(u[0],f[1])&&la(u[1],f[0])))break;h[aa(f)]=!0}}return h[aa(u)]=!0,void(this.vertexSegments_=h)}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)},t.prototype.insertVertex_=function(e,t){for(var r,i=e.segment,o=e.feature,n=e.geometry,a=e.depth,s=e.index;t.length<n.getStride();)t.push(0);switch(n.getType()){case k.MULTI_LINE_STRING:case k.POLYGON:(r=n.getCoordinates())[a[0]].splice(s+1,0,t);break;case k.MULTI_POLYGON:(r=n.getCoordinates())[a[1]][a[0]].splice(s+1,0,t);break;case k.LINE_STRING:(r=n.getCoordinates()).splice(s+1,0,t);break;default:return;}this.setGeometryCoordinates_(n,r);var $=this.rBush_;$.remove(e),this.updateSegmentIndices_(n,s,a,1);var p={segment:[i[0],t],feature:o,geometry:n,depth:a,index:s};$.insert(D(p.segment),p),this.dragSegments_.push([p,1]);var u={segment:[t,i[1]],feature:o,geometry:n,depth:a,index:s+1};$.insert(D(u.segment),u),this.dragSegments_.push([u,0]),this.ignoreNextSingleClick_=!0},t.prototype.removePoint=function(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=j.POINTERDRAG){var e=this.lastPointerEvent_;this.willModifyFeatures_(e);var t=this.removeVertex_();return this.dispatchEvent(new Ke(Ch.MODIFYEND,this.features_,e)),this.modified_=!1,t}return!1},t.prototype.removeVertex_=function(){var e,t,r,i,o,n,a,s,$,p,u,d=this.dragSegments_,m={},g=!1;for(o=d.length-1;o>=0;--o)p=(r=d[o])[0],u=aa(p.feature),p.depth&&(u+="-"+p.depth.join("-")),u in m||(m[u]={}),0===r[1]?(m[u].right=p,m[u].index=p.index):1==r[1]&&(m[u].left=p,m[u].index=p.index+1);for(u in m){switch($=m[u].right,a=m[u].left,(s=(n=m[u].index)-1)<0&&(s=0),e=t=(i=(p=void 0!==a?a:$).geometry).getCoordinates(),g=!1,i.getType()){case k.MULTI_LINE_STRING:t[p.depth[0]].length>2&&(t[p.depth[0]].splice(n,1),g=!0);break;case k.LINE_STRING:t.length>2&&(t.splice(n,1),g=!0);break;case k.MULTI_POLYGON:e=e[p.depth[1]];case k.POLYGON:(e=e[p.depth[0]]).length>4&&(n==e.length-1&&(n=0),e.splice(n,1),g=!0,0===n&&(e.pop(),e.push(e[0]),s=e.length-1));}if(g){this.setGeometryCoordinates_(i,t);var h=[];if(void 0!==a&&(this.rBush_.remove(a),h.push(a.segment[0])),void 0!==$&&(this.rBush_.remove($),h.push($.segment[1])),void 0!==a&&void 0!==$){var l={depth:p.depth,feature:p.feature,geometry:p.geometry,index:s,segment:h};this.rBush_.insert(D(l.segment),l)}this.updateSegmentIndices_(i,n,p.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),d.length=0}}return g},t.prototype.setGeometryCoordinates_=function(e,t){this.changingFeature_=!0,e.setCoordinates(t),this.changingFeature_=!1},t.prototype.updateSegmentIndices_=function(e,t,r,i){this.rBush_.forEachInExtent(e.getExtent(),function(o){o.geometry===e&&(void 0===r||void 0===o.depth||$a(o.depth,r))&&o.index>t&&(o.index+=i)})},t}($);function Dq(e,t){return e.index-t.index}function bl(e,t,r){var i=t.geometry;if(i.getType()===k.CIRCLE){var o=i;if(t.index===yd){var n=U(o.getCenter(),e),a=Math.sqrt(n)-o.getRadius();return a*a}}var s=w(e,r);return Ac[0]=w(t.segment[0],r),Ac[1]=w(t.segment[1],r),_c(s,Ac)}function cl(e,t,r){var i=t.geometry;if(i.getType()===k.CIRCLE&&t.index===yd)return i.getClosestPoint(e);var o=w(e,r);return Ac[0]=w(t.segment[0],r),Ac[1]=w(t.segment[1],r),ec(Zc(o,Ac),r)}function Eq(){var e=rc();return function(t,r){return e[k.POINT]}}Je.default=Cq;var Dh={};var dl=Dh&&Dh.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Fq={SELECT:"select"},Gq=function(e){function t(t,r,i,o){var n=e.call(this,t)||this;return n.selected=r,n.deselected=i,n.mapBrowserEvent=o,n}return dl(t,e),t}(T),Le={},Hq=function(e){function t(t){var r,i=e.call(this,{handleEvent:Iq})||this,o=t||{};if(i.condition_=o.condition?o.condition:kk,i.addCondition_=o.addCondition?o.addCondition:jk,i.removeCondition_=o.removeCondition?o.removeCondition:jk,i.toggleCondition_=o.toggleCondition?o.toggleCondition:te,i.multi_=!!o.multi&&o.multi,i.filter_=o.filter?o.filter:W,i.hitTolerance_=o.hitTolerance?o.hitTolerance:0,i.style_=void 0!==o.style?o.style:Jq(),i.features_=o.features||new K,o.layers){if("function"==typeof o.layers)r=o.layers;else{var n=o.layers;r=function(e){return N(n,e)}}}else r=W;i.layerFilter_=r,i.featureLayerAssociation_={};var a=i.getFeatures();return a.addEventListener(C.ADD,i.addFeature_.bind(i)),a.addEventListener(C.REMOVE,i.removeFeature_.bind(i)),i}return dl(t,e),t.prototype.addFeatureLayerAssociation_=function(e,t){this.featureLayerAssociation_[aa(e)]=t},t.prototype.getFeatures=function(){return this.features_},t.prototype.getHitTolerance=function(){return this.hitTolerance_},t.prototype.getLayer=function(e){return this.featureLayerAssociation_[aa(e)]},t.prototype.setHitTolerance=function(e){this.hitTolerance_=e},t.prototype.setMap=function(t){this.getMap()&&this.style_&&this.features_.forEach(this.restorePreviousStyle_.bind(this)),e.prototype.setMap.call(this,t),t&&this.style_&&this.features_.forEach(this.applySelectedStyle_.bind(this))},t.prototype.addFeature_=function(e){var t=e.element;this.style_&&this.applySelectedStyle_(t)},t.prototype.removeFeature_=function(e){var t=e.element;this.style_&&this.restorePreviousStyle_(t)},t.prototype.getStyle=function(){return this.style_},t.prototype.applySelectedStyle_=function(e){var t=aa(e);t in Le||(Le[t]=e.getStyle()),e.setStyle(this.style_)},t.prototype.restorePreviousStyle_=function(e){var r=aa(e),i=this.getMap().getInteractions().getArray().filter(function(r){return r instanceof t&&r.getStyle()&&-1!==r.getFeatures().getArray().indexOf(e)});i.length>0?e.setStyle(i[i.length-1].getStyle()):(e.setStyle(Le[r]),delete Le[r])},t.prototype.removeFeatureLayerAssociation_=function(e){delete this.featureLayerAssociation_[aa(e)]},t}(lb);function Iq(e){if(!this.condition_(e))return!0;var t=this.addCondition_(e),r=this.removeCondition_(e),i=this.toggleCondition_(e),o=!t&&!r&&!i,n=e.map,a=this.getFeatures(),$=[],s=[];if(o){Za(this.featureLayerAssociation_),n.forEachFeatureAtPixel(e.pixel,function(e,t){if(this.filter_(e,t))return s.push(e),this.addFeatureLayerAssociation_(e,t),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var l=a.getLength()-1;l>=0;--l){var u=a.item(l),p=s.indexOf(u);p>-1?s.splice(p,1):(a.remove(u),$.push(u))}0!==s.length&&a.extend(s)}else{n.forEachFeatureAtPixel(e.pixel,function(e,o){if(this.filter_(e,o))return!t&&!i||N(a.getArray(),e)?(r||i)&&N(a.getArray(),e)&&($.push(e),this.removeFeatureLayerAssociation_(e)):(s.push(e),this.addFeatureLayerAssociation_(e,o)),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var c=$.length-1;c>=0;--c)a.remove($[c]);a.extend(s)}return(s.length>0||$.length>0)&&this.dispatchEvent(new Gq(Fq.SELECT,s,$,e)),!0}function Jq(){var e=rc();return v(e[k.POLYGON],e[k.LINE_STRING]),v(e[k.GEOMETRY_COLLECTION],e[k.LINE_STRING]),function(t){return t.getGeometry()?e[t.getGeometry().getType()]:null}}Dh.default=Hq;var Eh={};var Kq=Eh&&Eh.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}();function el(e){return e.feature?e.feature:e.element?e.element:void 0}var Bc=[],Lq=function(e){function t(t){var r=this,o=t||{},i=o;return i.handleDownEvent||(i.handleDownEvent=W),i.stopDown||(i.stopDown=vb),(r=e.call(this,i)||this).source_=o.source?o.source:null,r.vertex_=void 0===o.vertex||o.vertex,r.edge_=void 0===o.edge||o.edge,r.features_=o.features?o.features:null,r.featuresListenerKeys_=[],r.featureChangeListenerKeys_={},r.indexedFeaturesExtents_={},r.pendingFeatures_={},r.pixelTolerance_=void 0!==o.pixelTolerance?o.pixelTolerance:10,r.rBush_=new Ge,r.SEGMENT_WRITERS_={Point:r.writePointGeometry_.bind(r),LineString:r.writeLineStringGeometry_.bind(r),LinearRing:r.writeLineStringGeometry_.bind(r),Polygon:r.writePolygonGeometry_.bind(r),MultiPoint:r.writeMultiPointGeometry_.bind(r),MultiLineString:r.writeMultiLineStringGeometry_.bind(r),MultiPolygon:r.writeMultiPolygonGeometry_.bind(r),GeometryCollection:r.writeGeometryCollectionGeometry_.bind(r),Circle:r.writeCircleGeometry_.bind(r)},r}return Kq(t,e),t.prototype.addFeature=function(e,t){var r=void 0===t||t,o=aa(e),i=e.getGeometry();if(i){var n=this.SEGMENT_WRITERS_[i.getType()];n&&(this.indexedFeaturesExtents_[o]=i.getExtent(da()),n(e,i))}r&&(this.featureChangeListenerKeys_[o]=d(e,f.CHANGE,this.handleFeatureChange_,this))},t.prototype.forEachFeatureAdd_=function(e){this.addFeature(e)},t.prototype.forEachFeatureRemove_=function(e){this.removeFeature(e)},t.prototype.getFeatures_=function(){var e;return this.features_?e=this.features_:this.source_&&(e=this.source_.getFeatures()),e},t.prototype.handleEvent=function(t){var r=this.snapTo(t.pixel,t.coordinate,t.map);return r.snapped&&(t.coordinate=r.vertex.slice(0,2),t.pixel=r.vertexPixel),e.prototype.handleEvent.call(this,t)},t.prototype.handleFeatureAdd_=function(e){var t=el(e);this.addFeature(t)},t.prototype.handleFeatureRemove_=function(e){var t=el(e);this.removeFeature(t)},t.prototype.handleFeatureChange_=function(e){var t=e.target;if(this.handlingDownUpSequence){var r=aa(t);r in this.pendingFeatures_||(this.pendingFeatures_[r]=t)}else this.updateFeature_(t)},t.prototype.handleUpEvent=function(e){var t=Ed(this.pendingFeatures_);return t.length&&(t.forEach(this.updateFeature_.bind(this)),this.pendingFeatures_={}),!1},t.prototype.removeFeature=function(e,t){var r=void 0===t||t,o=aa(e),i=this.indexedFeaturesExtents_[o];if(i){var n=this.rBush_,a=[];n.forEachInExtent(i,function(t){e===t.feature&&a.push(t)});for(var s=a.length-1;s>=0;--s)n.remove(a[s])}r&&(m(this.featureChangeListenerKeys_[o]),delete this.featureChangeListenerKeys_[o])},t.prototype.setMap=function(t){var r=this.getMap(),o=this.featuresListenerKeys_,i=this.getFeatures_();r&&(o.forEach(m),o.length=0,i.forEach(this.forEachFeatureRemove_.bind(this))),e.prototype.setMap.call(this,t),t&&(this.features_?o.push(d(this.features_,C.ADD,this.handleFeatureAdd_,this),d(this.features_,C.REMOVE,this.handleFeatureRemove_,this)):this.source_&&o.push(d(this.source_,P.ADDFEATURE,this.handleFeatureAdd_,this),d(this.source_,P.REMOVEFEATURE,this.handleFeatureRemove_,this)),i.forEach(this.forEachFeatureAdd_.bind(this)))},t.prototype.snapTo=function(e,t,r){var o=r.getCoordinateFromPixel([e[0]-this.pixelTolerance_,e[1]+this.pixelTolerance_]),i=r.getCoordinateFromPixel([e[0]+this.pixelTolerance_,e[1]-this.pixelTolerance_]),n=D([o,i]),a=this.rBush_.getInExtent(n);this.vertex_&&!this.edge_&&(a=a.filter(function(e){return e.feature.getGeometry().getType()!==k.CIRCLE}));var s=!1,$=null,u=null;if(0===a.length)return{snapped:s,vertex:$,vertexPixel:u};for(var p,l=r.getView().getProjection(),h=w(t,l),m=1/0,d=0;d<a.length;++d){var C=a[d];Bc[0]=w(C.segment[0],l),Bc[1]=w(C.segment[1],l);var c=_c(h,Bc);c<m&&(p=C,m=c)}var g=p.segment;if(this.vertex_&&!this.edge_){var _=r.getPixelFromCoordinate(g[0]),v=r.getPixelFromCoordinate(g[1]),f=U(e,_),M=U(e,v);Math.sqrt(Math.min(f,M))<=this.pixelTolerance_&&(s=!0,$=f>M?g[1]:g[0],u=r.getPixelFromCoordinate($))}else if(this.edge_){var j=p.feature.getGeometry().getType()===k.CIRCLE;if(j?$=Fi(t,p.feature.getGeometry()):(Bc[0]=w(g[0],l),Bc[1]=w(g[1],l),$=ec(Zc(h,Bc),l)),u=r.getPixelFromCoordinate($),$c(e,u)<=this.pixelTolerance_&&(s=!0,this.vertex_&&!j)){_=r.getPixelFromCoordinate(g[0]),v=r.getPixelFromCoordinate(g[1]),f=U(u,_),M=U(u,v);Math.sqrt(Math.min(f,M))<=this.pixelTolerance_&&($=f>M?g[1]:g[0],u=r.getPixelFromCoordinate($))}}return s&&(u=[Math.round(u[0]),Math.round(u[1])]),{snapped:s,vertex:$,vertexPixel:u}},t.prototype.updateFeature_=function(e){this.removeFeature(e,!1),this.addFeature(e,!1)},t.prototype.writeCircleGeometry_=function(e,t){for(var r=hg(t).getCoordinates()[0],o=0,i=r.length-1;o<i;++o){var n=r.slice(o,o+2),a={feature:e,segment:n};this.rBush_.insert(D(n),a)}},t.prototype.writeGeometryCollectionGeometry_=function(e,t){for(var r=t.getGeometriesArray(),o=0;o<r.length;++o){var i=this.SEGMENT_WRITERS_[r[o].getType()];i&&i(e,r[o])}},t.prototype.writeLineStringGeometry_=function(e,t){for(var r=t.getCoordinates(),o=0,i=r.length-1;o<i;++o){var n=r.slice(o,o+2),a={feature:e,segment:n};this.rBush_.insert(D(n),a)}},t.prototype.writeMultiLineStringGeometry_=function(e,t){for(var r=t.getCoordinates(),o=0,i=r.length;o<i;++o)for(var n=r[o],a=0,s=n.length-1;a<s;++a){var $=n.slice(a,a+2),u={feature:e,segment:$};this.rBush_.insert(D($),u)}},t.prototype.writeMultiPointGeometry_=function(e,t){for(var r=t.getCoordinates(),o=0,i=r.length;o<i;++o){var n=r[o],a={feature:e,segment:[n,n]};this.rBush_.insert(t.getExtent(),a)}},t.prototype.writeMultiPolygonGeometry_=function(e,t){for(var r=t.getCoordinates(),o=0,i=r.length;o<i;++o)for(var n=r[o],a=0,s=n.length;a<s;++a)for(var $=n[a],u=0,p=$.length-1;u<p;++u){var l=$.slice(u,u+2),h={feature:e,segment:l};this.rBush_.insert(D(l),h)}},t.prototype.writePointGeometry_=function(e,t){var r=t.getCoordinates(),o={feature:e,segment:[r,r]};this.rBush_.insert(t.getExtent(),o)},t.prototype.writePolygonGeometry_=function(e,t){for(var r=t.getCoordinates(),o=0,i=r.length;o<i;++o)for(var n=r[o],a=0,s=n.length-1;a<s;++a){var $=n.slice(a,a+2),u={feature:e,segment:$};this.rBush_.insert(D($),u)}},t}($);Eh.default=Lq;var Me={};var fl=Me&&Me.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function a(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(a.prototype=r.prototype,new a)}}(),Fh={TRANSLATESTART:"translatestart",TRANSLATING:"translating",TRANSLATEEND:"translateend"},Ne=function(t){function e(e,r,a,n,s){var o=t.call(this,e)||this;return o.features=r,o.coordinate=a,o.startCoordinate=n,o.mapBrowserEvent=s,o}return fl(e,t),e}(T);Me.TranslateEvent=Ne;var Mq=function(t){function e(e){var r,a=this,n=e||{};if((a=t.call(this,n)||this).lastCoordinate_=null,a.startCoordinate_=null,a.features_=void 0!==n.features?n.features:null,n.layers){if("function"==typeof n.layers)r=n.layers;else{var s=n.layers;r=function(t){return N(s,t)}}}else r=W;return a.layerFilter_=r,a.filter_=n.filter?n.filter:W,a.hitTolerance_=n.hitTolerance?n.hitTolerance:0,a.lastFeature_=null,a.addEventListener(A(qe.ACTIVE),a.handleActiveChanged_),a}return fl(e,t),e.prototype.handleDownEvent=function(t){if(this.lastFeature_=this.featuresAtPixel_(t.pixel,t.map),!this.lastCoordinate_&&this.lastFeature_){this.startCoordinate_=t.coordinate,this.lastCoordinate_=t.coordinate,this.handleMoveEvent(t);var e=this.features_||new K([this.lastFeature_]);return this.dispatchEvent(new Ne(Fh.TRANSLATESTART,e,t.coordinate,this.startCoordinate_,t)),!0}return!1},e.prototype.handleUpEvent=function(t){if(this.lastCoordinate_){this.lastCoordinate_=null,this.handleMoveEvent(t);var e=this.features_||new K([this.lastFeature_]);return this.dispatchEvent(new Ne(Fh.TRANSLATEEND,e,t.coordinate,this.startCoordinate_,t)),this.startCoordinate_=null,!0}return!1},e.prototype.handleDragEvent=function(t){if(this.lastCoordinate_){var e=t.coordinate,r=e[0]-this.lastCoordinate_[0],a=e[1]-this.lastCoordinate_[1],n=this.features_||new K([this.lastFeature_]);n.forEach(function(t){var e=t.getGeometry();e.translate(r,a),t.setGeometry(e)}),this.lastCoordinate_=e,this.dispatchEvent(new Ne(Fh.TRANSLATING,n,e,this.startCoordinate_,t))}},e.prototype.handleMoveEvent=function(t){var e=t.map.getViewport();this.featuresAtPixel_(t.pixel,t.map)?(e.classList.remove(this.lastCoordinate_?"ol-grab":"ol-grabbing"),e.classList.add(this.lastCoordinate_?"ol-grabbing":"ol-grab")):e.classList.remove("ol-grab","ol-grabbing")},e.prototype.featuresAtPixel_=function(t,e){return e.forEachFeatureAtPixel(t,function(t,e){if(this.filter_(t,e)&&(!this.features_||N(this.features_.getArray(),t)))return t}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_})},e.prototype.getHitTolerance=function(){return this.hitTolerance_},e.prototype.setHitTolerance=function(t){this.hitTolerance_=t},e.prototype.setMap=function(e){var r=this.getMap();t.prototype.setMap.call(this,e),this.updateState_(r)},e.prototype.handleActiveChanged_=function(){this.updateState_(null)},e.prototype.updateState_=function(t){var e=this.getMap(),r=this.getActive();e&&r||(e=e||t)&&e.getViewport().classList.remove("ol-grab","ol-grabbing")},e}($);Me.default=Mq;var Nq=Gc&&Gc.__extends||function(){var t=function(r,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)r.hasOwnProperty(e)&&(t[e]=r[e])})(r,e)};return function(r,e){function o(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),gl=function(t){function r(r){return(r=L({},r)).controls||(r.controls=ao()),r.interactions||(r.interactions=ep()),t.call(this,r)||this}return Nq(r,t),r.prototype.createRenderer=function(){return new Dg(this)},r}(qg);Gc.default=gl;var Gh={};var Hh={};var Oe=34962;var Ih=34963;var Oq=35040;var Pq=35044;var Pe=35048;var Qq=5121;var Rq=5123;var Sq=5125;var hl=5126;var il,jl=["experimental-webgl","webgl","webkit-3d","moz-webgl"];function kl(r,$){for(var t=jl.length,e=0;e<t;++e)try{var o=r.getContext(jl[e],$);if(o)return o}catch(p){}return null}function Tq(){if(!il){var r=kl(document.createElement("canvas"));r&&(il=r.getSupportedExtensions())}return il}var Uq={STATIC_DRAW:Pq,STREAM_DRAW:Oq,DYNAMIC_DRAW:Pe};var Jh=function(){function r(r,t){this.array=null,this.type=r,q(r===Oe||r===Ih,62),this.usage=void 0!==t?t:Uq.STATIC_DRAW}return r.prototype.ofSize=function(r){this.array=new(Kh(this.type))(r)},r.prototype.fromArray=function(r){this.array=Kh(this.type).from(r)},r.prototype.fromArrayBuffer=function(r){this.array=new(Kh(this.type))(r)},r.prototype.getType=function(){return this.type},r.prototype.getArray=function(){return this.array},r.prototype.getUsage=function(){return this.usage},r.prototype.getSize=function(){return this.array?this.array.length:0},r}();function Kh(r){switch(r){case Oe:return Float32Array;case Ih:return Uint32Array;default:return Float32Array;}}var Lb={};var Qe={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"};function Vq(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function Lh(r,$){return r[0]=$[0],r[1]=$[1],r[4]=$[2],r[5]=$[3],r[12]=$[4],r[13]=$[5],r}var Wq="\n  precision mediump float;\n  \n  attribute vec2 a_position;\n  varying vec2 v_texCoord;\n  varying vec2 v_screenCoord;\n  \n  uniform vec2 u_screenSize;\n   \n  void main() {\n    v_texCoord = a_position * 0.5 + 0.5;\n    v_screenCoord = v_texCoord * u_screenSize;\n    gl_Position = vec4(a_position, 0.0, 1.0);\n  }\n",Xq="\n  precision mediump float;\n   \n  uniform sampler2D u_image;\n   \n  varying vec2 v_texCoord;\n   \n  void main() {\n    gl_FragColor = texture2D(u_image, v_texCoord);\n  }\n",ll=function(){function e(e){this.gl_=e.webGlContext;var r=this.gl_;this.scaleRatio_=e.scaleRatio||1,this.renderTargetTexture_=r.createTexture(),this.renderTargetTextureSize_=null,this.frameBuffer_=r.createFramebuffer();var t=r.createShader(r.VERTEX_SHADER);r.shaderSource(t,e.vertexShader||Wq),r.compileShader(t);var i=r.createShader(r.FRAGMENT_SHADER);r.shaderSource(i,e.fragmentShader||Xq),r.compileShader(i),this.renderTargetProgram_=r.createProgram(),r.attachShader(this.renderTargetProgram_,t),r.attachShader(this.renderTargetProgram_,i),r.linkProgram(this.renderTargetProgram_),this.renderTargetVerticesBuffer_=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),r.bufferData(r.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,1,-1,1,1,-1,1]),r.STATIC_DRAW),this.renderTargetAttribLocation_=r.getAttribLocation(this.renderTargetProgram_,"a_position"),this.renderTargetUniformLocation_=r.getUniformLocation(this.renderTargetProgram_,"u_screenSize"),this.renderTargetTextureLocation_=r.getUniformLocation(this.renderTargetProgram_,"u_image"),this.uniforms_=[],e.uniforms&&Object.keys(e.uniforms).forEach(function(t){this.uniforms_.push({value:e.uniforms[t],location:r.getUniformLocation(this.renderTargetProgram_,t)})}.bind(this))}return e.prototype.getGL=function(){return this.gl_},e.prototype.init=function(e){var r=this.getGL(),t=[r.drawingBufferWidth*this.scaleRatio_,r.drawingBufferHeight*this.scaleRatio_];if(r.bindFramebuffer(r.FRAMEBUFFER,this.getFrameBuffer()),r.viewport(0,0,t[0],t[1]),!this.renderTargetTextureSize_||this.renderTargetTextureSize_[0]!==t[0]||this.renderTargetTextureSize_[1]!==t[1]){this.renderTargetTextureSize_=t;var i=r.RGBA,a=r.RGBA,n=r.UNSIGNED_BYTE;r.bindTexture(r.TEXTURE_2D,this.renderTargetTexture_),r.texImage2D(r.TEXTURE_2D,0,i,t[0],t[1],0,a,n,null),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,this.renderTargetTexture_,0)}},e.prototype.apply=function(e,r){var t=this.getGL(),i=e.size;t.bindFramebuffer(t.FRAMEBUFFER,r?r.getFrameBuffer():null),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.renderTargetTexture_),t.clearColor(0,0,0,0),t.clear(t.COLOR_BUFFER_BIT),t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight),t.bindBuffer(t.ARRAY_BUFFER,this.renderTargetVerticesBuffer_),t.useProgram(this.renderTargetProgram_),t.enableVertexAttribArray(this.renderTargetAttribLocation_),t.vertexAttribPointer(this.renderTargetAttribLocation_,2,t.FLOAT,!1,0,0),t.uniform2f(this.renderTargetUniformLocation_,i[0],i[1]),t.uniform1i(this.renderTargetTextureLocation_,0),this.applyUniforms(e),t.drawArrays(t.TRIANGLES,0,6)},e.prototype.getFrameBuffer=function(){return this.frameBuffer_},e.prototype.applyUniforms=function(e){var r,t=this.getGL(),i=1;this.uniforms_.forEach(function(a){if((r="function"==typeof a.value?a.value(e):a.value)instanceof HTMLCanvasElement||r instanceof ImageData)a.texture||(a.texture=t.createTexture()),t.activeTexture(t["TEXTURE"+i]),t.bindTexture(t.TEXTURE_2D,a.texture),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),r instanceof ImageData?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,r.width,r.height,0,t.UNSIGNED_BYTE,new Uint8Array(r.data)):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r),t.uniform1i(a.location,i++);else if(Array.isArray(r))switch(r.length){case 2:return void t.uniform2f(a.location,r[0],r[1]);case 3:return void t.uniform3f(a.location,r[0],r[1],r[2]);case 4:return void t.uniform4f(a.location,r[0],r[1],r[2],r[3]);default:return;}else"number"==typeof r&&t.uniform1f(a.location,r)})},e}();var Yq=Lb&&Lb.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}(),Zq={FRAGMENT_SHADER:35632,VERTEX_SHADER:35633};Lb.ShaderType=Zq;var Mb={PROJECTION_MATRIX:"u_projectionMatrix",OFFSET_SCALE_MATRIX:"u_offsetScaleMatrix",OFFSET_ROTATION_MATRIX:"u_offsetRotateMatrix",TIME:"u_time",ZOOM:"u_zoom",RESOLUTION:"u_resolution"};Lb.DefaultUniform=Mb;var ha={UNSIGNED_BYTE:Qq,UNSIGNED_SHORT:Rq,UNSIGNED_INT:Sq,FLOAT:hl};Lb.AttributeType=ha;var ml=function(t){function e(e){var r=t.call(this)||this,o=e||{};r.boundHandleWebGLContextLost_=r.handleWebGLContextLost.bind(r),r.boundHandleWebGLContextRestored_=r.handleWebGLContextRestored.bind(r),r.canvas_=document.createElement("canvas"),r.canvas_.style.position="absolute",r.canvas_.style.left="0",r.gl_=kl(r.canvas_);var i=r.getGL();if(r.bufferCache_={},r.currentProgram_=null,q(N(Tq(),"OES_element_index_uint"),63),i.getExtension("OES_element_index_uint"),r.canvas_.addEventListener(Qe.LOST,r.boundHandleWebGLContextLost_),r.canvas_.addEventListener(Qe.RESTORED,r.boundHandleWebGLContextRestored_),r.offsetRotateMatrix_=G(),r.offsetScaleMatrix_=G(),r.tmpMat4_=Vq(),r.uniformLocations_={},r.attribLocations_={},r.uniforms_=[],o.uniforms)for(var a in o.uniforms)r.uniforms_.push({name:a,value:o.uniforms[a]});return r.postProcessPasses_=o.postProcesses?o.postProcesses.map(function(t){return new ll({webGlContext:i,scaleRatio:t.scaleRatio,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader,uniforms:t.uniforms})}):[new ll({webGlContext:i})],r.shaderCompileErrors_=null,r.startTime_=Date.now(),r}return Yq(e,t),e.prototype.bindBuffer=function(t){var e=this.getGL(),r=aa(t),o=this.bufferCache_[r];o||(o={buffer:t,webGlBuffer:e.createBuffer()},this.bufferCache_[r]=o);e.bindBuffer(t.getType(),o.webGlBuffer)},e.prototype.flushBufferData=function(t){var e=this.getGL();this.bindBuffer(t),e.bufferData(t.getType(),t.getArray(),t.getUsage())},e.prototype.deleteBuffer=function(t){var e=this.getGL(),r=aa(t),o=this.bufferCache_[r];e.isContextLost()||e.deleteBuffer(o.buffer),delete this.bufferCache_[r]},e.prototype.disposeInternal=function(){this.canvas_.removeEventListener(Qe.LOST,this.boundHandleWebGLContextLost_),this.canvas_.removeEventListener(Qe.RESTORED,this.boundHandleWebGLContextRestored_)},e.prototype.prepareDraw=function(t){var e=this.getGL(),r=this.getCanvas(),o=t.size,i=t.pixelRatio;r.width=o[0]*i,r.height=o[1]*i,r.style.width=o[0]+"px",r.style.height=o[1]+"px",e.useProgram(this.currentProgram_);for(var a=this.postProcessPasses_.length-1;a>=0;a--)this.postProcessPasses_[a].init(t);e.bindTexture(e.TEXTURE_2D,null),e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT),e.enable(e.BLEND),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA),e.useProgram(this.currentProgram_),this.applyFrameState(t),this.applyUniforms(t)},e.prototype.prepareDrawToRenderTarget=function(t,e,r){var o=this.getGL(),i=e.getSize();o.bindFramebuffer(o.FRAMEBUFFER,e.getFramebuffer()),o.viewport(0,0,i[0],i[1]),o.bindTexture(o.TEXTURE_2D,e.getTexture()),o.clearColor(0,0,0,0),o.clear(o.COLOR_BUFFER_BIT),o.enable(o.BLEND),o.blendFunc(o.ONE,r?o.ZERO:o.ONE_MINUS_SRC_ALPHA),o.useProgram(this.currentProgram_),this.applyFrameState(t),this.applyUniforms(t)},e.prototype.drawElements=function(t,e){var r=this.getGL(),o=r.UNSIGNED_INT,i=e-t,a=4*t;r.drawElements(r.TRIANGLES,i,o,a)},e.prototype.finalizeDraw=function(t){for(var e=0;e<this.postProcessPasses_.length;e++)this.postProcessPasses_[e].apply(t,this.postProcessPasses_[e+1]||null)},e.prototype.getCanvas=function(){return this.canvas_},e.prototype.getGL=function(){return this.gl_},e.prototype.applyFrameState=function(t){var e=t.size,r=t.viewState.rotation,o=Ud(this.offsetScaleMatrix_);Xf(o,2/e[0],2/e[1]);var i=Ud(this.offsetRotateMatrix_);0!==r&&aj(i,-r),this.setUniformMatrixValue(Mb.OFFSET_SCALE_MATRIX,Lh(this.tmpMat4_,o)),this.setUniformMatrixValue(Mb.OFFSET_ROTATION_MATRIX,Lh(this.tmpMat4_,i)),this.setUniformFloatValue(Mb.TIME,.001*(Date.now()-this.startTime_)),this.setUniformFloatValue(Mb.ZOOM,t.viewState.zoom),this.setUniformFloatValue(Mb.RESOLUTION,t.viewState.resolution)},e.prototype.applyUniforms=function(t){var e,r=this.getGL(),o=0;this.uniforms_.forEach(function(i){if((e="function"==typeof i.value?i.value(t):i.value)instanceof HTMLCanvasElement||e instanceof HTMLImageElement||e instanceof ImageData)i.texture||(i.prevValue=void 0,i.texture=r.createTexture()),r.activeTexture(r["TEXTURE"+o]),r.bindTexture(r.TEXTURE_2D,i.texture),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),(!(e instanceof HTMLImageElement)||e.complete)&&i.prevValue!==e&&(i.prevValue=e,r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,e)),r.uniform1i(this.getUniformLocation(i.name),o++);else if(Array.isArray(e)&&6===e.length)this.setUniformMatrixValue(i.name,Lh(this.tmpMat4_,e));else if(Array.isArray(e)&&e.length<=4)switch(e.length){case 2:return void r.uniform2f(this.getUniformLocation(i.name),e[0],e[1]);case 3:return void r.uniform3f(this.getUniformLocation(i.name),e[0],e[1],e[2]);case 4:return void r.uniform4f(this.getUniformLocation(i.name),e[0],e[1],e[2],e[3]);default:return;}else"number"==typeof e&&r.uniform1f(this.getUniformLocation(i.name),e)}.bind(this))},e.prototype.useProgram=function(t){return t!=this.currentProgram_&&(this.getGL().useProgram(t),this.currentProgram_=t,this.uniformLocations_={},this.attribLocations_={},!0)},e.prototype.compileShader=function(t,e){var r=this.getGL(),o=r.createShader(e);return r.shaderSource(o,t),r.compileShader(o),o},e.prototype.getProgram=function(t,e){var r=this.getGL(),o=this.compileShader(t,r.FRAGMENT_SHADER),i=this.compileShader(e,r.VERTEX_SHADER);this.shaderCompileErrors_=null,r.getShaderInfoLog(o)&&(this.shaderCompileErrors_="Fragment shader compilation failed:\n"+r.getShaderInfoLog(o)),r.getShaderInfoLog(i)&&(this.shaderCompileErrors_=(this.shaderCompileErrors_||"")+"Vertex shader compilation failed:\n"+r.getShaderInfoLog(i));var a=r.createProgram();return r.attachShader(a,o),r.attachShader(a,i),r.linkProgram(a),a},e.prototype.getShaderCompileErrors=function(){return this.shaderCompileErrors_},e.prototype.getUniformLocation=function(t){return void 0===this.uniformLocations_[t]&&(this.uniformLocations_[t]=this.getGL().getUniformLocation(this.currentProgram_,t)),this.uniformLocations_[t]},e.prototype.getAttributeLocation=function(t){return void 0===this.attribLocations_[t]&&(this.attribLocations_[t]=this.getGL().getAttribLocation(this.currentProgram_,t)),this.attribLocations_[t]},e.prototype.makeProjectionTransform=function(t,e){var r=t.size,o=t.viewState.rotation,i=t.viewState.resolution,a=t.viewState.center;return Ud(e),ga(e,0,0,2/(i*r[0]),2/(i*r[1]),-o,-a[0],-a[1]),e},e.prototype.setUniformFloatValue=function(t,e){this.getGL().uniform1f(this.getUniformLocation(t),e)},e.prototype.setUniformMatrixValue=function(t,e){this.getGL().uniformMatrix4fv(this.getUniformLocation(t),!1,e)},e.prototype.enableAttributeArray_=function(t,e,r,o,i){var a=this.getAttributeLocation(t);a<0||(this.getGL().enableVertexAttribArray(a),this.getGL().vertexAttribPointer(a,e,r,!1,o,i))},e.prototype.enableAttributes=function(t){for(var e=nl(t),r=0,o=0;o<t.length;o++){var i=t[o];this.enableAttributeArray_(i.name,i.size,i.type||hl,e,r),r+=i.size*ol(i.type)}},e.prototype.handleWebGLContextLost=function(){Za(this.bufferCache_),this.currentProgram_=null},e.prototype.handleWebGLContextRestored=function(){},e.prototype.createTexture=function(t,e,r){var o=this.getGL(),i=r||o.createTexture(),a=o.RGBA,n=o.RGBA,s=o.UNSIGNED_BYTE;return o.bindTexture(o.TEXTURE_2D,i),e?o.texImage2D(o.TEXTURE_2D,0,a,n,s,e):o.texImage2D(o.TEXTURE_2D,0,a,t[0],t[1],0,n,s,null),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),i},e}(Nc);function nl(t){for(var e=0,r=0;r<t.length;r++){var o=t[r];e+=o.size*ol(o.type)}return e}function ol(t){switch(t){case ha.UNSIGNED_BYTE:return Uint8Array.BYTES_PER_ELEMENT;case ha.UNSIGNED_SHORT:return Uint16Array.BYTES_PER_ELEMENT;case ha.UNSIGNED_INT:return Uint32Array.BYTES_PER_ELEMENT;case ha.FLOAT:default:return Float32Array.BYTES_PER_ELEMENT;}}Lb.computeAttributesStride=nl,Lb.default=ml;var rb={};var $q=rb&&rb.__extends||function(){var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,e){r.__proto__=e}||function(r,e){for(var t in e)e.hasOwnProperty(t)&&(r[t]=e[t])})(e,t)};return function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),Re={GENERATE_BUFFERS:"GENERATE_BUFFERS"};rb.WebGLWorkerMessageType=Re;var pl=function(r){function e(e,t){var o=r.call(this,e)||this,$=t||{};return o.helper=new ml({postProcesses:$.postProcesses,uniforms:$.uniforms}),o}return $q(e,r),e.prototype.disposeInternal=function(){this.helper.dispose(),r.prototype.disposeInternal.call(this)},e.prototype.getShaderCompileErrors=function(){return this.helper.getShaderCompileErrors()},e}(uh),_q=[],Mh={vertexPosition:0,indexPosition:0};function Se(r,e,t,o,$){r[e+0]=t,r[e+1]=o,r[e+2]=$}function ar(r,e,t,o,$,n){var a=3+$,i=r[e+0],s=r[e+1],p=_q;p.length=$;for(var m=0;m<p.length;m++)p[m]=r[e+2+m];var u=n?n.vertexPosition:0,c=n?n.indexPosition:0,f=u/a;return Se(t,u,i,s,0),p.length&&t.set(p,u+3),Se(t,u+=a,i,s,1),p.length&&t.set(p,u+3),Se(t,u+=a,i,s,2),p.length&&t.set(p,u+3),Se(t,u+=a,i,s,3),p.length&&t.set(p,u+3),u+=a,o[c++]=f,o[c++]=f+1,o[c++]=f+3,o[c++]=f+1,o[c++]=f+2,o[c++]=f+3,Mh.vertexPosition=u,Mh.indexPosition=c,Mh}function br(){var r=document.createElement("canvas").getContext("2d").createImageData(1,1);return r.data[0]=255,r.data[1]=255,r.data[2]=255,r.data[3]=255,r}function ql(r,e){var t=e||[];return t[0]=Math.floor(r/256/256/256)/255,t[1]=Math.floor(r/256/256)%256/255,t[2]=Math.floor(r/256)%256/255,t[3]=r%256/255,t}function rl(r){var e=0;return e+=Math.round(256*r[0]*256*256*255),e+=Math.round(256*r[1]*256*255),e+=Math.round(256*r[2]*255),e+=Math.round(255*r[3])}rb.writePointFeatureToBuffers=ar,rb.getBlankImageData=br,rb.colorEncodeId=ql,rb.colorDecodeId=rl,rb.default=pl;var cr="var e=\"function\"==typeof Object.assign?Object.assign:function(e,n){if(null==e)throw new TypeError(\"Cannot convert undefined or null to object\");for(var t=Object(e),r=1,o=arguments.length;r<o;++r){var i=arguments[r];if(null!=i)for(var f in i)i.hasOwnProperty(f)&&(t[f]=i[f])}return t},n=\"GENERATE_BUFFERS\",t=[],r={vertexPosition:0,indexPosition:0};function o(e,n,t,r,o){e[n+0]=t,e[n+1]=r,e[n+2]=o}function i(e,n,i,f,s,u){var a=3+s,l=e[n+0],v=e[n+1],c=t;c.length=s;for(var g=0;g<c.length;g++)c[g]=e[n+2+g];var b=u?u.vertexPosition:0,h=u?u.indexPosition:0,d=b/a;return o(i,b,l,v,0),c.length&&i.set(c,b+3),o(i,b+=a,l,v,1),c.length&&i.set(c,b+3),o(i,b+=a,l,v,2),c.length&&i.set(c,b+3),o(i,b+=a,l,v,3),c.length&&i.set(c,b+3),b+=a,f[h++]=d,f[h++]=d+1,f[h++]=d+3,f[h++]=d+1,f[h++]=d+2,f[h++]=d+3,r.vertexPosition=b,r.indexPosition=h,r}var f=self;f.onmessage=function(t){var r=t.data;if(r.type===n){for(var o=r.customAttributesCount,s=2+o,u=new Float32Array(r.renderInstructions),a=u.length/s,l=4*a*(o+3),v=new Uint32Array(6*a),c=new Float32Array(l),g=null,b=0;b<u.length;b+=s)g=i(u,b,c,v,o,g);var h=e({vertexBuffer:c.buffer,indexBuffer:v.buffer,renderInstructions:u.buffer},r);f.postMessage(h,[c.buffer,v.buffer,u.buffer])}};",dr=new Blob([cr],{type:"application/javascript"}),er=URL.createObjectURL(dr);function fr(){return new Worker(er)}var ya=new Uint8Array(4),gr=function(){function t(t,r){this.helper_=t;var e=t.getGL();this.texture_=e.createTexture(),this.framebuffer_=e.createFramebuffer(),this.size_=r||[1,1],this.data_=new Uint8Array(0),this.dataCacheDirty_=!0,this.updateSize_()}return t.prototype.setSize=function(t){$a(t,this.size_)||(this.size_[0]=t[0],this.size_[1]=t[1],this.updateSize_())},t.prototype.getSize=function(){return this.size_},t.prototype.clearCachedData=function(){this.dataCacheDirty_=!0},t.prototype.readAll=function(){if(this.dataCacheDirty_){var t=this.size_,r=this.helper_.getGL();r.bindFramebuffer(r.FRAMEBUFFER,this.framebuffer_),r.readPixels(0,0,t[0],t[1],r.RGBA,r.UNSIGNED_BYTE,this.data_),this.dataCacheDirty_=!1}return this.data_},t.prototype.readPixel=function(t,r){if(t<0||r<0||t>this.size_[0]||r>=this.size_[1])return ya[0]=0,ya[1]=0,ya[2]=0,ya[3]=0,ya;this.readAll();var e=Math.floor(t)+(this.size_[1]-Math.floor(r)-1)*this.size_[0];return ya[0]=this.data_[4*e],ya[1]=this.data_[4*e+1],ya[2]=this.data_[4*e+2],ya[3]=this.data_[4*e+3],ya},t.prototype.getTexture=function(){return this.texture_},t.prototype.getFramebuffer=function(){return this.framebuffer_},t.prototype.updateSize_=function(){var t=this.size_,r=this.helper_.getGL();this.texture_=this.helper_.createTexture(t,null,this.texture_),r.bindFramebuffer(r.FRAMEBUFFER,this.framebuffer_),r.viewport(0,0,t[0],t[1]),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,this.texture_,0),this.data_=new Uint8Array(t[0]*t[1]*4)},t}();var hr=Hh&&Hh.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),sl=function(e){function t(t,r){var i=this,s=r.uniforms||{},n=G();s[Mb.PROJECTION_MATRIX]=n,(i=e.call(this,t,{uniforms:s,postProcesses:r.postProcesses})||this).sourceRevision_=-1,i.verticesBuffer_=new Jh(Oe,Pe),i.hitVerticesBuffer_=new Jh(Oe,Pe),i.indicesBuffer_=new Jh(Ih,Pe),i.program_=i.helper.getProgram(r.fragmentShader,r.vertexShader),i.hitDetectionEnabled_=!(!r.hitFragmentShader||!r.hitVertexShader),i.hitProgram_=i.hitDetectionEnabled_&&i.helper.getProgram(r.hitFragmentShader,r.hitVertexShader);var o=r.attributes?r.attributes.map(function(e){return{name:"a_"+e.name,size:1,type:ha.FLOAT}}):[];i.attributes=[{name:"a_position",size:2,type:ha.FLOAT},{name:"a_index",size:1,type:ha.FLOAT}].concat(o),i.hitDetectionAttributes=[{name:"a_position",size:2,type:ha.FLOAT},{name:"a_index",size:1,type:ha.FLOAT},{name:"a_hitColor",size:4,type:ha.FLOAT},{name:"a_featureUid",size:1,type:ha.FLOAT}].concat(o),i.customAttributes=r.attributes?r.attributes:[],i.previousExtent_=da(),i.currentTransform_=n,i.renderTransform_=G(),i.invertRenderTransform_=G(),i.renderInstructions_=new Float32Array(0),i.hitRenderInstructions_=new Float32Array(0),i.hitRenderTarget_=i.hitDetectionEnabled_&&new gr(i.helper),i.worker_=fr(),i.worker_.addEventListener("message",function(e){var t=e.data;if(t.type===Re.GENERATE_BUFFERS){var r=t.projectionTransform;t.hitDetection?(this.hitVerticesBuffer_.fromArrayBuffer(t.vertexBuffer),this.helper.flushBufferData(this.hitVerticesBuffer_)):(this.verticesBuffer_.fromArrayBuffer(t.vertexBuffer),this.helper.flushBufferData(this.verticesBuffer_)),this.indicesBuffer_.fromArrayBuffer(t.indexBuffer),this.helper.flushBufferData(this.indicesBuffer_),this.renderTransform_=r,ic(this.invertRenderTransform_,this.renderTransform_),t.hitDetection?this.hitRenderInstructions_=new Float32Array(e.data.renderInstructions):this.renderInstructions_=new Float32Array(e.data.renderInstructions),this.getLayer().changed()}}.bind(i)),i.featureCache_={},i.featureCount_=0;var a=i.getLayer().getSource();return i.sourceListenKeys_=[d(a,P.ADDFEATURE,i.handleSourceFeatureAdded_,i),d(a,P.CHANGEFEATURE,i.handleSourceFeatureChanged_,i),d(a,P.REMOVEFEATURE,i.handleSourceFeatureDelete_,i),d(a,P.CLEAR,i.handleSourceFeatureClear_,i)],a.forEachFeature(function(e){this.featureCache_[aa(e)]={feature:e,properties:e.getProperties(),geometry:e.getGeometry()},this.featureCount_++}.bind(i)),i}return hr(t,e),t.prototype.handleSourceFeatureAdded_=function(e){var t=e.feature;this.featureCache_[aa(t)]={feature:t,properties:t.getProperties(),geometry:t.getGeometry()},this.featureCount_++},t.prototype.handleSourceFeatureChanged_=function(e){var t=e.feature;this.featureCache_[aa(t)]={feature:t,properties:t.getProperties(),geometry:t.getGeometry()}},t.prototype.handleSourceFeatureDelete_=function(e){var t=e.feature;delete this.featureCache_[aa(t)],this.featureCount_--},t.prototype.handleSourceFeatureClear_=function(){this.featureCache_={},this.featureCount_=0},t.prototype.renderFrame=function(e){var t=this.indicesBuffer_.getSize();this.helper.drawElements(0,t),this.helper.finalizeDraw(e);var r=this.helper.getCanvas(),i=e.layerStatesArray[e.layerIndex].opacity;return i!==parseFloat(r.style.opacity)&&(r.style.opacity=i),this.hitDetectionEnabled_&&(this.renderHitDetection(e),this.hitRenderTarget_.clearCachedData()),r},t.prototype.prepareFrame=function(e){var t=this.getLayer(),r=t.getSource(),i=e.viewState,s=!e.viewHints[H.ANIMATING]&&!e.viewHints[H.INTERACTING],n=!db(this.previousExtent_,e.extent),o=this.sourceRevision_<r.getRevision();if(o&&(this.sourceRevision_=r.getRevision()),s&&(n||o)){var a=i.projection,p=i.resolution,c=t instanceof ih?t.getRenderBuffer():0,u=_b(e.extent,c*p);r.loadFeatures(u,p,a),this.rebuildBuffers_(e),this.previousExtent_=e.extent.slice()}return this.helper.makeProjectionTransform(e,this.currentTransform_),gc(this.currentTransform_,this.invertRenderTransform_),this.helper.useProgram(this.program_),this.helper.prepareDraw(e),this.helper.bindBuffer(this.verticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.attributes),!0},t.prototype.rebuildBuffers_=function(e){var t=G();this.helper.makeProjectionTransform(e,t);var r,i,s=(2+this.customAttributes.length)*this.featureCount_;if(this.renderInstructions_&&this.renderInstructions_.length===s||(this.renderInstructions_=new Float32Array(s)),this.hitDetectionEnabled_){var n=(7+this.customAttributes.length)*this.featureCount_;this.hitRenderInstructions_&&this.hitRenderInstructions_.length===n||(this.hitRenderInstructions_=new Float32Array(n))}var o,a=[],p=[],c=0,u=0;for(var h in this.featureCache_)if((i=(r=this.featureCache_[h]).geometry)&&i.getType()===k.POINT){a[0]=i.getFlatCoordinates()[0],a[1]=i.getFlatCoordinates()[1],ca(t,a),o=ql(u+6,p),this.renderInstructions_[c++]=a[0],this.renderInstructions_[c++]=a[1],this.hitDetectionEnabled_&&(this.hitRenderInstructions_[u++]=a[0],this.hitRenderInstructions_[u++]=a[1],this.hitRenderInstructions_[u++]=o[0],this.hitRenderInstructions_[u++]=o[1],this.hitRenderInstructions_[u++]=o[2],this.hitRenderInstructions_[u++]=o[3],this.hitRenderInstructions_[u++]=Number(h));for(var $=void 0,f=0;f<this.customAttributes.length;f++)$=this.customAttributes[f].callback(r.feature,r.properties),this.renderInstructions_[c++]=$,this.hitDetectionEnabled_&&(this.hitRenderInstructions_[u++]=$)}var _={type:Re.GENERATE_BUFFERS,renderInstructions:this.renderInstructions_.buffer,customAttributesCount:this.customAttributes.length};if(_.projectionTransform=t,this.worker_.postMessage(_,[this.renderInstructions_.buffer]),this.renderInstructions_=null,this.hitDetectionEnabled_){var l={type:Re.GENERATE_BUFFERS,renderInstructions:this.hitRenderInstructions_.buffer,customAttributesCount:5+this.customAttributes.length};l.projectionTransform=t,l.hitDetection=!0,this.worker_.postMessage(l,[this.hitRenderInstructions_.buffer]),this.hitRenderInstructions_=null}},t.prototype.forEachFeatureAtCoordinate=function(e,t,r,i,s){if(q(this.hitDetectionEnabled_,66),this.hitRenderInstructions_){var n=ca(t.coordinateToPixelTransform,e.slice()),o=this.hitRenderTarget_.readPixel(n[0]/2,n[1]/2),a=[o[0]/255,o[1]/255,o[2]/255,o[3]/255],p=rl(a),c=this.hitRenderInstructions_[p],u=Math.floor(c).toString(),h=this.getLayer().getSource().getFeatureByUid(u);return h?i(h,this.getLayer()):void 0}},t.prototype.renderHitDetection=function(e){if(this.hitVerticesBuffer_.getSize()){this.hitRenderTarget_.setSize([Math.floor(e.size[0]/2),Math.floor(e.size[1]/2)]),this.helper.useProgram(this.hitProgram_),this.helper.prepareDrawToRenderTarget(e,this.hitRenderTarget_,!0),this.helper.bindBuffer(this.hitVerticesBuffer_),this.helper.bindBuffer(this.indicesBuffer_),this.helper.enableAttributes(this.hitDetectionAttributes);var t=this.indicesBuffer_.getSize();this.helper.drawElements(0,t)}},t.prototype.disposeInternal=function(){this.worker_.terminate(),this.layer_=null,this.sourceListenKeys_.forEach(function(e){m(e)}),this.sourceListenKeys_=null,e.prototype.disposeInternal.call(this)},t}(pl);Hh.default=sl;var ir=Gh&&Gh.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),oa={BLUR:"blur",GRADIENT:"gradient",RADIUS:"radius"},jr=["#00f","#0ff","#0f0","#ff0","#f00"],tl=function(t){function e(e){var r=this,i=e||{},n=L({},i);delete n.gradient,delete n.radius,delete n.blur,delete n.weight,(r=t.call(this,n)||this).gradient_=null,r.addEventListener(A(oa.GRADIENT),r.handleGradientChanged_),r.setGradient(i.gradient?i.gradient:jr),r.setBlur(void 0!==i.blur?i.blur:15),r.setRadius(void 0!==i.radius?i.radius:8);var o=i.weight?i.weight:"weight";return r.weightFunction_="string"==typeof o?function(t){return t.get(o)}:o,r.setRenderOrder(null),r}return ir(e,t),e.prototype.getBlur=function(){return this.get(oa.BLUR)},e.prototype.getGradient=function(){return this.get(oa.GRADIENT)},e.prototype.getRadius=function(){return this.get(oa.RADIUS)},e.prototype.handleGradientChanged_=function(){this.gradient_=kr(this.getGradient())},e.prototype.setBlur=function(t){this.set(oa.BLUR,t)},e.prototype.setGradient=function(t){this.set(oa.GRADIENT,t)},e.prototype.setRadius=function(t){this.set(oa.RADIUS,t)},e.prototype.createRenderer=function(){return new sl(this,{attributes:[{name:"weight",callback:function(t){var e=this.weightFunction_(t);return void 0!==e?F(e,0,1):1}.bind(this)}],vertexShader:"\n        precision mediump float;\n        uniform mat4 u_projectionMatrix;\n        uniform mat4 u_offsetScaleMatrix;\n        uniform float u_size;\n        attribute vec2 a_position;\n        attribute float a_index;\n        attribute float a_weight;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n\n        void main(void) {\n          mat4 offsetMatrix = u_offsetScaleMatrix;\n          float offsetX = a_index == 0.0 || a_index == 3.0 ? -u_size / 2.0 : u_size / 2.0;\n          float offsetY = a_index == 0.0 || a_index == 1.0 ? -u_size / 2.0 : u_size / 2.0;\n          vec4 offsets = offsetMatrix * vec4(offsetX, offsetY, 0.0, 0.0);\n          gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n          float u = a_index == 0.0 || a_index == 3.0 ? 0.0 : 1.0;\n          float v = a_index == 0.0 || a_index == 1.0 ? 0.0 : 1.0;\n          v_texCoord = vec2(u, v);\n          v_weight = a_weight;\n        }",fragmentShader:"\n        precision mediump float;\n        uniform float u_blurSlope;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n\n        void main(void) {\n          vec2 texCoord = v_texCoord * 2.0 - vec2(1.0, 1.0);\n          float sqRadius = texCoord.x * texCoord.x + texCoord.y * texCoord.y;\n          float value = (1.0 - sqrt(sqRadius)) * u_blurSlope;\n          float alpha = smoothstep(0.0, 1.0, value) * v_weight;\n          gl_FragColor = vec4(alpha, alpha, alpha, alpha);\n        }",hitVertexShader:"\n        precision mediump float;\n        uniform mat4 u_projectionMatrix;\n        uniform mat4 u_offsetScaleMatrix;\n        uniform float u_size;\n        attribute vec2 a_position;\n        attribute float a_index;\n        attribute float a_weight;\n        attribute vec4 a_hitColor;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n        varying vec4 v_hitColor;\n\n        void main(void) {\n          mat4 offsetMatrix = u_offsetScaleMatrix;\n          float offsetX = a_index == 0.0 || a_index == 3.0 ? -u_size / 2.0 : u_size / 2.0;\n          float offsetY = a_index == 0.0 || a_index == 1.0 ? -u_size / 2.0 : u_size / 2.0;\n          vec4 offsets = offsetMatrix * vec4(offsetX, offsetY, 0.0, 0.0);\n          gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n          float u = a_index == 0.0 || a_index == 3.0 ? 0.0 : 1.0;\n          float v = a_index == 0.0 || a_index == 1.0 ? 0.0 : 1.0;\n          v_texCoord = vec2(u, v);\n          v_hitColor = a_hitColor;\n          v_weight = a_weight;\n        }",hitFragmentShader:"\n        precision mediump float;\n        uniform float u_blurSlope;\n\n        varying vec2 v_texCoord;\n        varying float v_weight;\n        varying vec4 v_hitColor;\n\n        void main(void) {\n          vec2 texCoord = v_texCoord * 2.0 - vec2(1.0, 1.0);\n          float sqRadius = texCoord.x * texCoord.x + texCoord.y * texCoord.y;\n          float value = (1.0 - sqrt(sqRadius)) * u_blurSlope;\n          float alpha = smoothstep(0.0, 1.0, value) * v_weight;\n          if (alpha < 0.05) {\n            discard;\n          }\n\n          gl_FragColor = v_hitColor;\n        }",uniforms:{u_size:function(){return 2*(this.get(oa.RADIUS)+this.get(oa.BLUR))}.bind(this),u_blurSlope:function(){return this.get(oa.RADIUS)/Math.max(1,this.get(oa.BLUR))}.bind(this)},postProcesses:[{fragmentShader:"\n            precision mediump float;\n\n            uniform sampler2D u_image;\n            uniform sampler2D u_gradientTexture;\n\n            varying vec2 v_texCoord;\n\n            void main() {\n              vec4 color = texture2D(u_image, v_texCoord);\n              gl_FragColor.a = color.a;\n              gl_FragColor.rgb = texture2D(u_gradientTexture, vec2(0.5, color.a)).rgb;\n              gl_FragColor.rgb *= gl_FragColor.a;\n            }",uniforms:{u_gradientTexture:function(){return this.gradient_}.bind(this)}}]})},e}(vc);function kr(t){for(var e=Z(1,256),r=e.createLinearGradient(0,0,1,256),i=1/(t.length-1),n=0,o=t.length;n<o;++n)r.addColorStop(n*i,t[n]);return e.fillStyle=r,e.fillRect(0,0,1,256),e.canvas}Gh.default=tl;var Te={},lr=.5;Te.ERROR_THRESHOLD=lr;var mr=!0;Te.ENABLE_RASTER_REPROJECTION=mr;var zd={};var Nh={};var Ue={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};var nr=Nh&&Nh.__extends||function(){var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,e){r.__proto__=e}||function(r,e){for(var t in e)e.hasOwnProperty(t)&&(r[t]=e[t])})(e,t)};return function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),ul=function(r){function e(e){var t=this,o=e||{},n=L({},o);return delete n.preload,delete n.useInterimTilesOnError,(t=r.call(this,n)||this).setPreload(void 0!==o.preload?o.preload:0),t.setUseInterimTilesOnError(void 0===o.useInterimTilesOnError||o.useInterimTilesOnError),t}return nr(e,r),e.prototype.getPreload=function(){return this.get(Ue.PRELOAD)},e.prototype.setPreload=function(r){this.set(Ue.PRELOAD,r)},e.prototype.getUseInterimTilesOnError=function(){return this.get(Ue.USE_INTERIM_TILES_ON_ERROR)},e.prototype.setUseInterimTilesOnError=function(r){this.set(Ue.USE_INTERIM_TILES_ON_ERROR,r)},e}(de);Nh.default=ul;var Oh={};var Ve={},Ph=function(){function t(t,i,n,m){this.minX=t,this.maxX=i,this.minY=n,this.maxY=m}return t.prototype.contains=function(t){return this.containsXY(t[1],t[2])},t.prototype.containsTileRange=function(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY},t.prototype.containsXY=function(t,i){return this.minX<=t&&t<=this.maxX&&this.minY<=i&&i<=this.maxY},t.prototype.equals=function(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY},t.prototype.extend=function(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)},t.prototype.getHeight=function(){return this.maxY-this.minY+1},t.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]},t.prototype.getWidth=function(){return this.maxX-this.minX+1},t.prototype.intersects=function(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY},t}();function or(t,i,n,m,e){return void 0!==e?(e.minX=t,e.maxX=i,e.minY=n,e.maxY=m,e):new Ph(t,i,n,m)}Ve.createOrUpdate=or,Ve.default=Ph;var pr=Oh&&Oh.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Qh=function(e){function t(t){var r=e.call(this,t)||this;return r.extentChanged=!0,r.renderedExtent_=null,r.renderedPixelRatio,r.renderedProjection=null,r.renderedRevision,r.renderedTiles=[],r.newTiles_=!1,r.tmpExtent=da(),r.tmpTileRange_=new Ph(0,0,0,0),r}return pr(t,e),t.prototype.isDrawableTile=function(e){var t=this.getLayer(),r=e.getState(),i=t.getUseInterimTilesOnError();return r==fa.LOADED||r==fa.EMPTY||r==fa.ERROR&&!i},t.prototype.getTile=function(e,t,r,i){var o=i.pixelRatio,n=i.viewState.projection,a=this.getLayer(),s=a.getSource().getTile(e,t,r,o,n);return s.getState()==fa.ERROR&&(a.getUseInterimTilesOnError()?a.getPreload()>0&&(this.newTiles_=!0):s.setState(fa.LOADED)),this.isDrawableTile(s)||(s=s.getInterimTile()),s},t.prototype.loadedTileCallback=function(t,r,i){return!!this.isDrawableTile(i)&&e.prototype.loadedTileCallback.call(this,t,r,i)},t.prototype.prepareFrame=function(e){return!!this.getLayer().getSource()},t.prototype.renderFrame=function(e,t){var r=e.layerStatesArray[e.layerIndex],i=e.viewState,o=i.projection,n=i.resolution,a=i.center,s=i.rotation,l=e.pixelRatio,p=this.getLayer(),$=p.getSource(),d=$.getRevision(),h=$.getTileGridForProjection(o),u=h.getZForResolution(n,$.zDirection),c=h.getResolution(u),g=e.extent,m=r.extent&&Oa(r.extent,o);m&&(g=Kd(g,Oa(r.extent,o)));var T=$.getTilePixelRatio(l),S=Math.round(e.size[0]*T),f=Math.round(e.size[1]*T);if(s){var P=Math.round(Math.sqrt(S*S+f*f));S=P,f=P}var I=c*S/2/T,v=c*f/2/T,x=[a[0]-I,a[1]-v,a[0]+I,a[1]+v],k=h.getTileRangeForExtentAndZ(g,u),y={};y[u]={};var R=this.createLoadedTileFinder($,o,y),_=this.tmpExtent,w=this.tmpTileRange_;this.newTiles_=!1;for(var E=k.minX;E<=k.maxX;++E)for(var C=k.minY;C<=k.maxY;++C){var j=this.getTile(u,E,C,e);if(this.isDrawableTile(j)){var b=aa(this);if(j.getState()==fa.LOADED){y[u][j.tileCoord.toString()]=j;var O=j.inTransition(b);this.newTiles_||!O&&-1!==this.renderedTiles.indexOf(j)||(this.newTiles_=!0)}if(1===j.getAlpha(b,e.time))continue}var A=h.getTileCoordChildTileRange(j.tileCoord,w,_),L=!1;A&&(L=R(u+1,A)),L||h.forEachTileCoordParentTileRange(j.tileCoord,R,w,_)}var U=c/n;ga(this.pixelTransform,e.size[0]/2,e.size[1]/2,1/T,1/T,s,-S/2,-f/2);var q=this.createTransformString(this.pixelTransform);this.useContainer(t,q,r.opacity);var D=this.context,F=D.canvas;ic(this.inversePixelTransform,this.pixelTransform),ga(this.tempTransform_,S/2,f/2,U,U,0,-S/2,-f/2),F.width!=S||F.height!=f?(F.width=S,F.height=f):this.containerReused||D.clearRect(0,0,S,f),m&&this.clipUnrotated(D,e,m),this.preRender(D,e),this.renderedTiles.length=0;var M,z,Y,Z=Object.keys(y).map(Number);Z.sort(Ea),1!==r.opacity||this.containerReused&&!$.getOpaque(e.viewState.projection)?(M=[],z=[]):Z=Z.reverse();for(var K=Z.length-1;K>=0;--K){var X=Z[K],G=$.getTilePixelSize(X,l,o),Q=h.getResolution(X)/c,N=G[0]*Q*U,B=G[1]*Q*U,H=h.getTileCoordForCoordAndZ(fb(x),X),J=h.getTileCoordExtent(H),V=ca(this.tempTransform_,[T*(J[0]-x[0])/c,T*(x[3]-J[3])/c]),W=T*$.getGutterForProjection(o),ee=y[X];for(var te in ee){var re=(j=ee[te]).tileCoord,ie=V[0]-(H[1]-re[1])*N,oe=Math.round(ie+N),ne=V[1]-(H[2]-re[2])*B,ae=Math.round(ne+B),se=oe-(E=Math.round(ie)),le=ae-(C=Math.round(ne)),pe=u===X;if(!(O=pe&&1!==j.getAlpha(aa(this),e.time)))if(M){D.save(),Y=[E,C,E+se,C,E+se,C+le,E,C+le];for(var $e=0,de=M.length;$e<de;++$e)if(u!==X&&X<z[$e]){var he=M[$e];D.beginPath(),D.moveTo(Y[0],Y[1]),D.lineTo(Y[2],Y[3]),D.lineTo(Y[4],Y[5]),D.lineTo(Y[6],Y[7]),D.moveTo(he[6],he[7]),D.lineTo(he[4],he[5]),D.lineTo(he[2],he[3]),D.lineTo(he[0],he[1]),D.clip()}M.push(Y),z.push(X)}else D.clearRect(E,C,se,le);this.drawTileImage(j,e,E,C,se,le,W,pe,r.opacity),M&&!O&&D.restore(),this.renderedTiles.push(j),this.updateUsedTiles(e.usedTiles,$,j)}}return this.renderedRevision=d,this.renderedResolution=c,this.extentChanged=!this.renderedExtent_||!db(this.renderedExtent_,x),this.renderedExtent_=x,this.renderedPixelRatio=l,this.renderedProjection=o,this.manageTilePyramid(e,$,h,l,o,g,u,p.getPreload()),this.scheduleExpireCache(e,$),this.postRender(D,e),r.extent&&D.restore(),q!==F.style.transform&&(F.style.transform=q),this.container},t.prototype.drawTileImage=function(e,t,r,i,o,n,a,s,l){var p=this.getTileImage(e);if(p){var $=aa(this),d=s?e.getAlpha($,t.time):1,h=l*d,u=h!==this.context.globalAlpha;u&&(this.context.save(),this.context.globalAlpha=h),this.context.drawImage(p,a,a,p.width-2*a,p.height-2*a,r,i,o,n),u&&this.context.restore(),1!==d?t.animate=!0:s&&e.endTransition($)}},t.prototype.getImage=function(){var e=this.context;return e?e.canvas:null},t.prototype.getTileImage=function(e){return e.getImage()},t.prototype.scheduleExpireCache=function(e,t){if(t.canExpireCache()){var r=function(e,t,r){var i=aa(e);i in r.usedTiles&&e.expireCache(r.viewState.projection,r.usedTiles[i])}.bind(null,t);e.postRenderFunctions.push(r)}},t.prototype.updateUsedTiles=function(e,t,r){var i=aa(t);i in e||(e[i]={}),e[i][r.getKey()]=!0},t.prototype.manageTilePyramid=function(e,t,r,i,o,n,a,s,l){var p=aa(t);p in e.wantedTiles||(e.wantedTiles[p]={});var $,d,h,u,c,g,m=e.wantedTiles[p],T=e.tileQueue;for(g=r.getMinZoom();g<=a;++g)for(d=r.getTileRangeForExtentAndZ(n,g,d),h=r.getResolution(g),u=d.minX;u<=d.maxX;++u)for(c=d.minY;c<=d.maxY;++c)a-g<=s?(($=t.getTile(g,u,c,i,o)).getState()==fa.IDLE&&(m[$.getKey()]=!0,T.isKeyQueued($.getKey())||T.enqueue([$,p,r.getTileCoordCenter($.tileCoord),h])),void 0!==l&&l($)):t.useTile(g,u,c,o)},t}(vh);Qh.prototype.getLayer,Oh.default=Qh;var qr=zd&&zd.__extends||function(){var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,e){r.__proto__=e}||function(r,e){for(var t in e)e.hasOwnProperty(t)&&(r[t]=e[t])})(e,t)};return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),rr=function(r){function e(e){return r.call(this,e)||this}return qr(e,r),e.prototype.createRenderer=function(){return new Qh(this)},e}(ul);zd.default=rr;var sr=function(){function t(){this.dataProjection=null,this.defaultFeatureProjection=null}return t.prototype.getReadOptions=function(t,e){var r;if(e){var o=e.dataProjection?E(e.dataProjection):this.readProjection(t);e.extent&&o&&o.getUnits()===O.TILE_PIXELS&&(o=E(o)).setWorldExtent(e.extent),r={dataProjection:o,featureProjection:e.featureProjection}}return this.adaptOptions(r)},t.prototype.adaptOptions=function(t){return L({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection},t)},t.prototype.getType=function(){return h()},t.prototype.readFeature=function(t,e){return h()},t.prototype.readFeatures=function(t,e){return h()},t.prototype.readGeometry=function(t,e){return h()},t.prototype.readProjection=function(t){return h()},t.prototype.writeFeature=function(t,e){return h()},t.prototype.writeFeatures=function(t,e){return h()},t.prototype.writeGeometry=function(t,e){return h()},t}();function vl(t,e,r){var o,n=r?E(r.featureProjection):null,i=r?E(r.dataProjection):null;if(o=n&&i&&!Ri(n,i)?(e?t.clone():t).transform(e?n:i,e?i:n):t,e&&r&&void 0!==r.decimals){var u=Math.pow(10,r.decimals);o===t&&(o=t.clone()),o.applyTransform(function(t){for(var e=0,r=t.length;e<r;++e)t[e]=Math.round(t[e]*u)/u;return t})}return o}var Rh={};var tr=Rh&&Rh.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}(),Nb=function(e){function t(t){var r=e.call(this)||this;return r.geometries_=t||null,r.changeEventsKeys_=[],r.listenGeometriesChange_(),r}return tr(t,e),t.prototype.unlistenGeometriesChange_=function(){this.changeEventsKeys_.forEach(m),this.changeEventsKeys_.length=0},t.prototype.listenGeometriesChange_=function(){if(this.geometries_)for(var e=0,t=this.geometries_.length;e<t;++e)this.changeEventsKeys_.push(d(this.geometries_[e],f.CHANGE,this.changed,this))},t.prototype.clone=function(){var e=new t(null);return e.setGeometries(this.geometries_),e},t.prototype.closestPointXY=function(e,t,r,i){if(i<bb(this.getExtent(),e,t))return i;for(var o=this.geometries_,n=0,s=o.length;n<s;++n)i=o[n].closestPointXY(e,t,r,i);return i},t.prototype.containsXY=function(e,t){for(var r=this.geometries_,i=0,o=r.length;i<o;++i)if(r[i].containsXY(e,t))return!0;return!1},t.prototype.computeExtent=function(e){cb(e);for(var t=this.geometries_,r=0,i=t.length;r<i;++r)xf(e,t[r].getExtent());return e},t.prototype.getGeometries=function(){return wl(this.geometries_)},t.prototype.getGeometriesArray=function(){return this.geometries_},t.prototype.getSimplifiedGeometry=function(e){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),e<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&e<this.simplifiedGeometryMaxMinSquaredTolerance)return this;for(var r=[],i=this.geometries_,o=!1,n=0,s=i.length;n<s;++n){var p=i[n],a=p.getSimplifiedGeometry(e);r.push(a),a!==p&&(o=!0)}if(o){var g=new t(null);return g.setGeometriesArray(r),g}return this.simplifiedGeometryMaxMinSquaredTolerance=e,this},t.prototype.getType=function(){return k.GEOMETRY_COLLECTION},t.prototype.intersectsExtent=function(e){for(var t=this.geometries_,r=0,i=t.length;r<i;++r)if(t[r].intersectsExtent(e))return!0;return!1},t.prototype.isEmpty=function(){return 0===this.geometries_.length},t.prototype.rotate=function(e,t){for(var r=this.geometries_,i=0,o=r.length;i<o;++i)r[i].rotate(e,t);this.changed()},t.prototype.scale=function(e,t,r){var i=r;i||(i=ac(this.getExtent()));for(var o=this.geometries_,n=0,s=o.length;n<s;++n)o[n].scale(e,t,i);this.changed()},t.prototype.setGeometries=function(e){this.setGeometriesArray(wl(e))},t.prototype.setGeometriesArray=function(e){this.unlistenGeometriesChange_(),this.geometries_=e,this.listenGeometriesChange_(),this.changed()},t.prototype.applyTransform=function(e){for(var t=this.geometries_,r=0,i=t.length;r<i;++r)t[r].applyTransform(e);this.changed()},t.prototype.translate=function(e,t){for(var r=this.geometries_,i=0,o=r.length;i<o;++i)r[i].translate(e,t);this.changed()},t.prototype.disposeInternal=function(){this.unlistenGeometriesChange_(),e.prototype.disposeInternal.call(this)},t}(Yf);function wl(e){for(var t=[],r=0,i=e.length;r<i;++r)t.push(e[r].clone());return t}Rh.default=Nb;var Sh={};var xl="http://www.w3.org/2001/XMLSchema-instance";function Ad(e,r){return Xe().createElementNS(e,r)}function sb(e,r){return yl(e,r,[]).join("")}function yl(e,r,t){if(e.nodeType==Node.CDATA_SECTION_NODE||e.nodeType==Node.TEXT_NODE)r?t.push(String(e.nodeValue).replace(/(\r\n|\r|\n)/g,"")):t.push(e.nodeValue);else{var $=void 0;for($=e.firstChild;$;$=$.nextSibling)yl($,r,t)}return t}function Ob(e){return"documentElement"in e}function Pb(e){return new DOMParser().parseFromString(e,"application/xml")}function zl(e,r){return function(t,$){var o=e.call(void 0!==r?r:this,t,$);if(void 0!==o){var O=$[$.length-1];v(O,o)}}}function Qb(e,r){return function(t,$){var o=e.call(void 0!==r?r:this,t,$);void 0!==o&&$[$.length-1].push(o)}}function We(e,r){return function(t,$){var o=e.call(void 0!==r?r:this,t,$);void 0!==o&&($[$.length-1]=o)}}function a(e,r,t){return function($,o){var O=e.call(void 0!==t?t:this,$,o);void 0!==O&&(o[o.length-1][void 0!==r?r:$.localName]=O)}}function e(e,r){return function(t,$,o){e.call(void 0!==r?r:this,t,$,o),o[o.length-1].node.appendChild(t)}}function za(e,r){var t=e;return function(e,$,o){var O=$[$.length-1].node,n=t;return void 0===n&&(n=o),Ad(void 0!==r?r:O.namespaceURI,n)}}var pa=za();function Aa(e,r){for(var t=r.length,$=new Array(t),o=0;o<t;++o)$[o]=e[r[o]];return $}function c(e,r,t){var $,o,O=void 0!==t?t:{};for($=0,o=e.length;$<o;++$)O[e[$]]=r;return O}function Cc(e,r,t,$){var o;for(o=r.firstElementChild;o;o=o.nextElementSibling){var O=e[o.namespaceURI];if(void 0!==O){var n=O[o.localName];void 0!==n&&n.call($,o,t)}}}function z(e,r,t,$,o){return $.push(e),Cc(r,t,$,o),$.pop()}function ur(e,r,t,$,o,O){for(var n,i,a=(void 0!==o?o:t).length,p=0;p<a;++p)void 0!==(n=t[p])&&void 0!==(i=r.call(void 0!==O?O:this,n,$,void 0!==o?o[p]:void 0))&&e[i.namespaceURI][i.localName].call(O,i,n,$)}function B(e,r,t,$,o,O,n){return o.push(e),ur(r,t,$,o,O,n),o.pop()}var Al=void 0;function vr(){return void 0===Al&&"undefined"!=typeof XMLSerializer&&(Al=new XMLSerializer),Al}var Bl=void 0;function Xe(){return void 0===Bl&&"undefined"!=typeof document&&(Bl=document.implementation.createDocument("","",null)),Bl}var wr=Sh&&Sh.__extends||function(){var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,e){r.__proto__=e}||function(r,e){for(var t in e)e.hasOwnProperty(t)&&(r[t]=e[t])})(e,t)};return function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}(),Cl=function(r){function e(){var e=r.call(this)||this;return e.xmlSerializer_=vr(),e}return wr(e,r),e.prototype.getType=function(){return xc.XML},e.prototype.readFeature=function(r,e){if(r){if("string"==typeof r){var t=Pb(r);return this.readFeatureFromDocument(t,e)}return Ob(r)?this.readFeatureFromDocument(r,e):this.readFeatureFromNode(r,e)}return null},e.prototype.readFeatureFromDocument=function(r,e){var t=this.readFeaturesFromDocument(r,e);return t.length>0?t[0]:null},e.prototype.readFeatureFromNode=function(r,e){return null},e.prototype.readFeatures=function(r,e){if(r){if("string"==typeof r){var t=Pb(r);return this.readFeaturesFromDocument(t,e)}return Ob(r)?this.readFeaturesFromDocument(r,e):this.readFeaturesFromNode(r,e)}return[]},e.prototype.readFeaturesFromDocument=function(r,e){for(var t=[],o=r.firstChild;o;o=o.nextSibling)o.nodeType==Node.ELEMENT_NODE&&v(t,this.readFeaturesFromNode(o,e));return t},e.prototype.readFeaturesFromNode=function(r,e){return h()},e.prototype.readGeometry=function(r,e){if(r){if("string"==typeof r){var t=Pb(r);return this.readGeometryFromDocument(t,e)}return Ob(r)?this.readGeometryFromDocument(r,e):this.readGeometryFromNode(r,e)}return null},e.prototype.readGeometryFromDocument=function(r,e){return null},e.prototype.readGeometryFromNode=function(r,e){return null},e.prototype.readProjection=function(r){if(r){if("string"==typeof r){var e=Pb(r);return this.readProjectionFromDocument(e)}return Ob(r)?this.readProjectionFromDocument(r):this.readProjectionFromNode(r)}return null},e.prototype.readProjectionFromDocument=function(r){return this.dataProjection},e.prototype.readProjectionFromNode=function(r){return this.dataProjection},e.prototype.writeFeature=function(r,e){var t=this.writeFeatureNode(r,e);return this.xmlSerializer_.serializeToString(t)},e.prototype.writeFeatureNode=function(r,e){return null},e.prototype.writeFeatures=function(r,e){var t=this.writeFeaturesNode(r,e);return this.xmlSerializer_.serializeToString(t)},e.prototype.writeFeaturesNode=function(r,e){return null},e.prototype.writeGeometry=function(r,e){var t=this.writeGeometryNode(r,e);return this.xmlSerializer_.serializeToString(t)},e.prototype.writeGeometryNode=function(r,e){return null},e}(sr);Sh.default=Cl;function tb(e){return xr(sb(e,!1))}function xr(e){var t=/^\s*(true|1)|(false|0)\s*$/.exec(e);return t?void 0!==t[1]||!1:void 0}function r(e){return yr(sb(e,!1))}function yr(e){var t=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*$/i.exec(e);return t?parseFloat(t[1]):void 0}function R(e){return sb(e,!1).trim()}function Ye(e,t){qa(e,t?"1":"0")}function zr(e,t){e.appendChild(Xe().createCDATASection(t))}function Rb(e,t){var o=t.toPrecision();e.appendChild(Xe().createTextNode(o))}function qa(e,t){e.appendChild(Xe().createTextNode(t))}var Ba={};var Bd,Dl,El,Fl,Th,Ze,Gl,Ar=Ba&&Ba.__extends||function(){var e=function($,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,$){e.__proto__=$}||function(e,$){for(var r in $)$.hasOwnProperty(r)&&(e[r]=$[r])})($,r)};return function($,r){function s(){this.constructor=$}e($,r),$.prototype=null===r?Object.create(r):(s.prototype=r.prototype,new s)}}(),Wa=["http://www.google.com/kml/ext/2.2"],b=[null,"http://earth.google.com/kml/2.0","http://earth.google.com/kml/2.1","http://earth.google.com/kml/2.2","http://www.opengis.net/kml/2.2"],Br="http://www.opengis.net/kml/2.2 https://developers.google.com/kml/schema/kml22gx.xsd",Hl={fraction:Q.FRACTION,pixels:Q.PIXELS,insetPixels:Q.PIXELS},Cr=c(b,{ExtendedData:Xl,Region:Yl,MultiGeometry:a(Ul,"geometry"),LineString:a(Sl,"geometry"),LinearRing:a(Tl,"geometry"),Point:a(Vl,"geometry"),Polygon:a(Wl,"geometry"),Style:a(_h),StyleMap:os,address:a(R),description:a(R),name:a(R),open:a(tb),phoneNumber:a(R),styleUrl:a(_e),visibility:a(tb)},c(Wa,{MultiTrack:a(bs,"geometry"),Track:a(Rl,"geometry")})),Dr=c(b,{ExtendedData:Xl,Region:Yl,Link:As,address:a(R),description:a(R),name:a(R),open:a(tb),phoneNumber:a(R),visibility:a(tb)}),Er=c(b,{href:a(_e)}),Il=c(b,{LatLonAltBox:ts,Lod:vs}),Fr=c(b,["Document","Placemark"]),Gr=c(b,{Document:e(Is),Placemark:e(cm)}),$e=null;function Hr(){return $e}Ba.getDefaultFillStyle=Hr;var Jl,Uh=null;function Ir(){return Uh}Ba.getDefaultImageStyle=Ir;var Kl,Vh=null;function Jr(){return Vh}Ba.getDefaultStrokeStyle=Jr;var Sb=null;function Kr(){return Sb}Ba.getDefaultTextStyle=Kr;var Ll=null;function Lr(){return Ll}Ba.getDefaultStyle=Lr;var Wh,Xh=null;function Mr(){return Xh}function Nr(){Bd=[255,255,255,1],$e=new nb({color:Bd}),Dl=[20,2],El=Q.PIXELS,Fl=Q.PIXELS,Th=[64,64],Ze="https://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png",Gl=.5,Uh=new Fe({anchor:Dl,anchorOrigin:I.BOTTOM_LEFT,anchorXUnits:El,anchorYUnits:Fl,crossOrigin:"anonymous",rotation:0,scale:Gl,size:Th,src:Ze}),Jl="NO_IMAGE",Vh=new ob({color:Bd,width:1}),Kl=new ob({color:[51,51,51,1],width:2}),Sb=new zh({font:"bold 16px Helvetica",fill:$e,stroke:Kl,scale:.8}),Ll=new _({fill:$e,image:Uh,text:Sb,stroke:Vh,zIndex:0}),Xh=[Ll]}Ba.getDefaultStyleArray=Mr;var Ml=function(e){function $($){var r=e.call(this)||this,s=$||{};return Xh||Nr(),r.dataProjection=E("EPSG:4326"),r.defaultStyle_=s.defaultStyle?s.defaultStyle:Xh,r.extractStyles_=void 0===s.extractStyles||s.extractStyles,r.writeStyles_=void 0===s.writeStyles||s.writeStyles,r.sharedStyles_={},r.showPointNames_=void 0===s.showPointNames||s.showPointNames,r.crossOrigin_=void 0!==s.crossOrigin?s.crossOrigin:"anonymous",r}return Ar($,e),$.prototype.readDocumentOrFolder_=function(e,$){var r=c(b,{Document:zl(this.readDocumentOrFolder_,this),Folder:zl(this.readDocumentOrFolder_,this),Placemark:Qb(this.readPlacemark_,this),Style:this.readSharedStyle_.bind(this),StyleMap:this.readSharedStyleMap_.bind(this)}),s=z([],r,e,$,this);return s||void 0},$.prototype.readPlacemark_=function(e,$){var r=z({geometry:null},Cr,e,$,this);if(r){var s=new va,t=e.getAttribute("id");null!==t&&s.setId(t);var a=$[0],o=r.geometry;if(o&&vl(o,!1,a),s.setGeometry(o),delete r.geometry,this.extractStyles_){var i=Pr(r.Style,r.styleUrl,this.defaultStyle_,this.sharedStyles_,this.showPointNames_);s.setStyle(i)}return delete r.Style,s.setProperties(r,!0),s}},$.prototype.readSharedStyle_=function(e,$){var r=e.getAttribute("id");if(null!==r){var s=_h.call(this,e,$);if(s){var t=void 0,a=e.baseURI;if(a&&"about:blank"!=a||(a=window.location.href),a)t=new URL("#"+r,a).href;else t="#"+r;this.sharedStyles_[t]=s}}},$.prototype.readSharedStyleMap_=function(e,$){var r=e.getAttribute("id");if(null!==r){var s=Pl.call(this,e,$);if(s){var t,a=e.baseURI;if(a&&"about:blank"!=a||(a=window.location.href),a)t=new URL("#"+r,a).href;else t="#"+r;this.sharedStyles_[t]=s}}},$.prototype.readFeatureFromNode=function(e,$){if(!N(b,e.namespaceURI))return null;var r=this.readPlacemark_(e,[this.getReadOptions(e,$)]);return r||null},$.prototype.readFeaturesFromNode=function(e,$){if(!N(b,e.namespaceURI))return[];var r,s=e.localName;if("Document"==s||"Folder"==s)return(r=this.readDocumentOrFolder_(e,[this.getReadOptions(e,$)]))||[];if("Placemark"==s){var t=this.readPlacemark_(e,[this.getReadOptions(e,$)]);return t?[t]:[]}if("kml"==s){r=[];for(var a=e.firstElementChild;a;a=a.nextElementSibling){var o=this.readFeaturesFromNode(a,$);o&&v(r,o)}return r}return[]},$.prototype.readName=function(e){if(e){if("string"==typeof e){var $=Pb(e);return this.readNameFromDocument($)}return Ob(e)?this.readNameFromDocument(e):this.readNameFromNode(e)}},$.prototype.readNameFromDocument=function(e){for(var $=e.firstChild;$;$=$.nextSibling)if($.nodeType==Node.ELEMENT_NODE){var r=this.readNameFromNode($);if(r)return r}},$.prototype.readNameFromNode=function(e){for(var $=e.firstElementChild;$;$=$.nextElementSibling)if(N(b,$.namespaceURI)&&"name"==$.localName)return R($);for($=e.firstElementChild;$;$=$.nextElementSibling){var r=$.localName;if(N(b,$.namespaceURI)&&("Document"==r||"Folder"==r||"Placemark"==r||"kml"==r)){var s=this.readNameFromNode($);if(s)return s}}},$.prototype.readNetworkLinks=function(e){var $=[];if("string"==typeof e){var r=Pb(e);v($,this.readNetworkLinksFromDocument(r))}else Ob(e)?v($,this.readNetworkLinksFromDocument(e)):v($,this.readNetworkLinksFromNode(e));return $},$.prototype.readNetworkLinksFromDocument=function(e){for(var $=[],r=e.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&v($,this.readNetworkLinksFromNode(r));return $},$.prototype.readNetworkLinksFromNode=function(e){for(var $=[],r=e.firstElementChild;r;r=r.nextElementSibling)if(N(b,r.namespaceURI)&&"NetworkLink"==r.localName){var s=z({},Dr,r,[]);$.push(s)}for(r=e.firstElementChild;r;r=r.nextElementSibling){var t=r.localName;!N(b,r.namespaceURI)||"Document"!=t&&"Folder"!=t&&"kml"!=t||v($,this.readNetworkLinksFromNode(r))}return $},$.prototype.readRegion=function(e){var $=[];if("string"==typeof e){var r=Pb(e);v($,this.readRegionFromDocument(r))}else Ob(e)?v($,this.readRegionFromDocument(e)):v($,this.readRegionFromNode(e));return $},$.prototype.readRegionFromDocument=function(e){for(var $=[],r=e.firstChild;r;r=r.nextSibling)r.nodeType==Node.ELEMENT_NODE&&v($,this.readRegionFromNode(r));return $},$.prototype.readRegionFromNode=function(e){for(var $=[],r=e.firstElementChild;r;r=r.nextElementSibling)if(N(b,r.namespaceURI)&&"Region"==r.localName){var s=z({},Il,r,[]);$.push(s)}for(r=e.firstElementChild;r;r=r.nextElementSibling){var t=r.localName;!N(b,r.namespaceURI)||"Document"!=t&&"Folder"!=t&&"kml"!=t||v($,this.readRegionFromNode(r))}return $},$.prototype.writeFeaturesNode=function(e,$){$=this.adaptOptions($);var r=Ad(b[4],"kml"),s="http://www.w3.org/2000/xmlns/";r.setAttributeNS(s,"xmlns:gx",Wa[0]),r.setAttributeNS(s,"xmlns:xsi",xl),r.setAttributeNS(xl,"xsi:schemaLocation",Br);var t={node:r},a={};e.length>1?a.Document=e:1==e.length&&(a.Placemark=e[0]);var o=Fr[r.namespaceURI],i=Aa(a,o);return B(t,Gr,pa,i,[$],o,this),r},$}(Cl);function Or(e,$){var r=[0,0],s="start",t=e.getImage();if(t){var a=t.getImageSize();if(null===a&&(a=Th),2==a.length){var o=t.getScale();r[0]=o*a[0]/2,r[1]=-o*a[1]/2,s="left"}}var i=e.getText();return i?((i=i.clone()).setFont(i.getFont()||Sb.getFont()),i.setScale(i.getScale()||Sb.getScale()),i.setFill(i.getFill()||Sb.getFill()),i.setStroke(i.getStroke()||Kl)):i=Sb.clone(),i.setText($),i.setOffsetX(r[0]),i.setOffsetY(r[1]),i.setTextAlign(s),new _({image:t,text:i,fill:e.getFill(),stroke:e.getStroke()})}function Pr(e,$,r,s,t){return function(a,o){var i=t,n="",m=[];if(i){var p=a.getGeometry();if(p){var S=p.getType();i=S===k.GEOMETRY_COLLECTION?(m=p.getGeometriesArray().filter(function(e){var $=e.getType();return $===k.POINT||$===k.MULTI_POINT})).length>0:S===k.POINT||S===k.MULTI_POINT}}i&&(n=a.get("name"),(i=i&&!!n)&&n.search(/&[^&]+;/)>-1&&(Wh||(Wh=document.createElement("textarea")),Wh.innerHTML=n,n=Wh.value));var l=r;if(e?l=e:$&&(l=Nl($,r,s)),i){var E=Or(l[0],n);return m.length>0?(E.setGeometry(new Nb(m)),[E,new _({geometry:l[0].getGeometry(),image:null,fill:l[0].getFill(),stroke:l[0].getStroke(),text:null})].concat(l.slice(1))):E}return l}}function Nl(e,$,r){return Array.isArray(e)?e:"string"==typeof e?(!(e in r)&&"#"+e in r&&(e="#"+e),Nl(r[e],$,r)):$}function Yh(e){var $=sb(e,!1),r=/^\s*#?\s*([0-9A-Fa-f]{8})\s*$/.exec($);if(r){var s=r[1];return[parseInt(s.substr(6,2),16),parseInt(s.substr(4,2),16),parseInt(s.substr(2,2),16),parseInt(s.substr(0,2),16)/255]}}function Zh(e){for(var $,r=sb(e,!1),s=[],t=/^\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)\s*,\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?)(?:\s*,\s*([+\-]?\d*\.?\d+(?:e[+\-]?\d+)?))?\s*/i;$=t.exec(r);){var a=parseFloat($[1]),o=parseFloat($[2]),i=$[3]?parseFloat($[3]):0;s.push(a,o,i),r=r.substr($[0].length)}if(""===r)return s}function _e(e){var $=sb(e,!1).trim(),r=e.baseURI;return r&&"about:blank"!=r||(r=window.location.href),r?new URL($,r).href:$}function Qr(e){var $,r=e.getAttribute("xunits"),s=e.getAttribute("yunits");return $="insetPixels"!==r?"insetPixels"!==s?I.BOTTOM_LEFT:I.TOP_LEFT:"insetPixels"!==s?I.BOTTOM_RIGHT:I.TOP_RIGHT,{x:parseFloat(e.getAttribute("x")),xunits:Hl[r],y:parseFloat(e.getAttribute("y")),yunits:Hl[s],origin:$}}function Ol(e){return r(e)}Ba.readFlatCoordinates=Zh;var Rr=c(b,{Pair:ns});function Pl(e,$){return z(void 0,Rr,e,$,this)}var Sr=c(b,{Icon:a(es),heading:a(r),hotSpot:a(Qr),scale:a(Ol)});function Tr(e,$){var r=z({},Sr,e,$);if(r){var s,t,a,o,i=$[$.length-1],n="Icon"in r?r.Icon:{},m=!("Icon"in r)||Object.keys(n).length>0,p=n.href;p?s=p:m&&(s=Ze);var S,l=I.BOTTOM_LEFT,E=r.hotSpot;E?(t=[E.x,E.y],a=E.xunits,o=E.yunits,l=E.origin):s===Ze?(t=Dl,a=El,o=Fl):/^http:\/\/maps\.(?:google|gstatic)\.com\//.test(s)&&(t=[.5,0],a=Q.FRACTION,o=Q.FRACTION);var v,A=n.x,d=n.y;void 0!==A&&void 0!==d&&(S=[A,d]);var _,u=n.w,c=n.h;void 0!==u&&void 0!==c&&(v=[u,c]);var T=r.heading;void 0!==T&&(_=ja(T));var R=r.scale;if(m){s==Ze&&(v=Th,void 0===R&&(R=Gl));var y=new Fe({anchor:t,anchorOrigin:l,anchorXUnits:a,anchorYUnits:o,crossOrigin:this.crossOrigin_,offset:S,offsetOrigin:I.BOTTOM_LEFT,rotation:_,scale:R,size:v,src:s});i.imageStyle=y}else i.imageStyle=Jl}}var Ur=c(b,{color:a(Yh),scale:a(Ol)});function Vr(e,$){var r=z({},Ur,e,$);if(r){var s=$[$.length-1],t=new zh({fill:new nb({color:"color"in r?r.color:Bd}),scale:r.scale});s.textStyle=t}}var Wr=c(b,{color:a(Yh),width:a(r)});function Xr(e,$){var r=z({},Wr,e,$);if(r){var s=$[$.length-1],t=new ob({color:"color"in r?r.color:Bd,width:"width"in r?r.width:1});s.strokeStyle=t}}var Yr=c(b,{color:a(Yh),fill:a(tb),outline:a(tb)});function Zr(e,$){var r=z({},Yr,e,$);if(r){var s=$[$.length-1],t=new nb({color:"color"in r?r.color:Bd});s.fillStyle=t;var a=r.fill;void 0!==a&&(s.fill=a);var o=r.outline;void 0!==o&&(s.outline=o)}}var $r=c(b,{coordinates:We(Zh)});function Ql(e,$){return z(null,$r,e,$)}function _r(e,$){var r=$[$.length-1].flatCoordinates,s=sb(e,!1),t=/^\s*([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s+([+\-]?\d+(?:\.\d*)?(?:e[+\-]?\d*)?)\s*$/i.exec(s);if(t){var a=parseFloat(t[1]),o=parseFloat(t[2]),i=parseFloat(t[3]);r.push(a,o,i,0)}else r.push(0,0,0,0)}var as=c(Wa,{Track:Qb(Rl)});function bs(e,$){var r=z([],as,e,$);if(r)return new ze(r)}var cs=c(b,{when:Bs},c(Wa,{coord:_r}));function Rl(e,$){var r=z({flatCoordinates:[],whens:[]},cs,e,$);if(r){for(var s=r.flatCoordinates,t=r.whens,a=0,o=Math.min(s.length,t.length);a<o;++a)s[4*a+3]=t[a];return new mb(s,l.XYZM)}}var ds=c(b,{href:a(_e)},c(Wa,{x:a(r),y:a(r),w:a(r),h:a(r)}));function es(e,$){var r=z({},ds,e,$);return r||null}var fs=c(b,{coordinates:We(Zh)});function $h(e,$){return z(null,fs,e,$)}var af=c(b,{extrude:a(tb),tessellate:a(tb),altitudeMode:a(R)});function Sl(e,$){var r=z({},af,e,$),s=$h(e,$);if(s){var t=new mb(s,l.XYZ);return t.setProperties(r,!0),t}}function Tl(e,$){var r=z({},af,e,$),s=$h(e,$);if(s){var t=new na(s,l.XYZ,[s.length]);return t.setProperties(r,!0),t}}var gs=c(b,{LineString:Qb(Sl),LinearRing:Qb(Tl),MultiGeometry:Qb(Ul),Point:Qb(Vl),Polygon:Qb(Wl)});function Ul(e,$){var r,s=z([],gs,e,$);if(!s)return null;if(0===s.length)return new Nb(s);for(var t,a=!0,o=s[0].getType(),i=1,n=s.length;i<n;++i)if((t=s[i]).getType()!=o){a=!1;break}if(a){var m=void 0,p=void 0;if(o==k.POINT){var S=s[0];m=S.getLayout(),p=S.getFlatCoordinates();for(i=1,n=s.length;i<n;++i)t=s[i],v(p,t.getFlatCoordinates());ai(r=new Ae(p,m),s)}else o==k.LINE_STRING?ai(r=new ze(s),s):o==k.POLYGON?ai(r=new bh(s),s):o==k.GEOMETRY_COLLECTION?r=new Nb(s):q(!1,37)}else r=new Nb(s);return r}function Vl(e,$){var r=z({},af,e,$),s=$h(e,$);if(s){var t=new Qa(s,l.XYZ);return t.setProperties(r,!0),t}}var hs=c(b,{innerBoundaryIs:xs,outerBoundaryIs:zs});function Wl(e,$){var r=z({},af,e,$),s=z([null],hs,e,$);if(s&&s[0]){for(var t=s[0],a=[t.length],o=1,i=s.length;o<i;++o)v(t,s[o]),a.push(t.length);var n=new na(t,l.XYZ,a);return n.setProperties(r,!0),n}}var is=c(b,{IconStyle:Tr,LabelStyle:Vr,LineStyle:Xr,PolyStyle:Zr});function _h(e,$){var r=z({},is,e,$,this);if(!r)return null;var s,t="fillStyle"in r?r.fillStyle:$e,a=r.fill;void 0===a||a||(t=null),"imageStyle"in r?r.imageStyle!=Jl&&(s=r.imageStyle):s=Uh;var o="textStyle"in r?r.textStyle:Sb,i="strokeStyle"in r?r.strokeStyle:Vh,n=r.outline;return void 0===n||n?[new _({fill:t,image:s,stroke:i,text:o,zIndex:void 0})]:[new _({geometry:function(e){var $=e.getGeometry(),r=$.getType();return r===k.GEOMETRY_COLLECTION?new Nb($.getGeometriesArray().filter(function(e){var $=e.getType();return $!==k.POLYGON&&$!==k.MULTI_POLYGON})):r!==k.POLYGON&&r!==k.MULTI_POLYGON?$:void 0},fill:t,image:s,stroke:i,text:o,zIndex:void 0}),new _({geometry:function(e){var $=e.getGeometry(),r=$.getType();return r===k.GEOMETRY_COLLECTION?new Nb($.getGeometriesArray().filter(function(e){var $=e.getType();return $===k.POLYGON||$===k.MULTI_POLYGON})):r===k.POLYGON||r===k.MULTI_POLYGON?$:void 0},fill:t,stroke:null,zIndex:void 0})]}function ai(e,$){var r,s,t,a=$.length,o=new Array($.length),i=new Array($.length),n=new Array($.length);r=!1,s=!1,t=!1;for(var m=0;m<a;++m){var p=$[m];o[m]=p.get("extrude"),i[m]=p.get("tessellate"),n[m]=p.get("altitudeMode"),r=r||void 0!==o[m],s=s||void 0!==i[m],t=t||n[m]}r&&e.set("extrude",o),s&&e.set("tessellate",i),t&&e.set("altitudeMode",n)}var js=c(b,{displayName:a(R),value:a(R)});function ks(e,$){var r=e.getAttribute("name");Cc(js,e,$);var s=$[$.length-1];r&&s.displayName?s[r]={value:s.value,displayName:s.displayName,toString:function(){return s.value}}:null!==r?s[r]=s.value:null!==s.displayName&&(s[s.displayName]=s.value),delete s.value}var ls=c(b,{Data:ks,SchemaData:qs});function Xl(e,$){Cc(ls,e,$)}function Yl(e,$){Cc(Il,e,$)}var ms=c(b,{Style:a(_h),key:a(R),styleUrl:a(_e)});function ns(e,$){var r=z({},ms,e,$,this);if(r){var s=r.key;if(s&&"normal"==s){var t=r.styleUrl;t&&($[$.length-1]=t);var a=r.Style;a&&($[$.length-1]=a)}}}function os(e,$){var r=Pl.call(this,e,$);if(r){var s=$[$.length-1];Array.isArray(r)?s.Style=r:"string"==typeof r?s.styleUrl=r:q(!1,38)}}var ps=c(b,{SimpleData:rs});function qs(e,$){Cc(ps,e,$)}function rs(e,$){var r=e.getAttribute("name");if(null!==r){var s=R(e);$[$.length-1][r]=s}}var ss=c(b,{altitudeMode:a(R),minAltitude:a(r),maxAltitude:a(r),north:a(r),south:a(r),east:a(r),west:a(r)});function ts(e,$){var r=z({},ss,e,$);if(r){var s=$[$.length-1],t=[parseFloat(r.west),parseFloat(r.south),parseFloat(r.east),parseFloat(r.north)];s.extent=t,s.altitudeMode=r.altitudeMode,s.minAltitude=parseFloat(r.minAltitude),s.maxAltitude=parseFloat(r.maxAltitude)}}var us=c(b,{minLodPixels:a(r),maxLodPixels:a(r),minFadeExtent:a(r),maxFadeExtent:a(r)});function vs(e,$){var r=z({},us,e,$);if(r){var s=$[$.length-1];s.minLodPixels=parseFloat(r.minLodPixels),s.maxLodPixels=parseFloat(r.maxLodPixels),s.minFadeExtent=parseFloat(r.minFadeExtent),s.maxFadeExtent=parseFloat(r.maxFadeExtent)}}var ws=c(b,{LinearRing:We(Ql)});function xs(e,$){var r=z(void 0,ws,e,$);r&&$[$.length-1].push(r)}var ys=c(b,{LinearRing:We(Ql)});function zs(e,$){var r=z(void 0,ys,e,$);r&&($[$.length-1][0]=r)}function As(e,$){Cc(Er,e,$)}function Bs(e,$){var r=$[$.length-1].whens,s=sb(e,!1),t=Date.parse(s);r.push(isNaN(t)?0:t)}function bi(e,$){for(var r=Ag($),s=[255*(4==r.length?r[3]:1),r[2],r[1],r[0]],t=0;t<4;++t){var a=Math.floor(s[t]).toString(16);s[t]=1==a.length?"0"+a:a}qa(e,s.join(""))}function Cs(e,$,r){var s,t=r[r.length-1],a=t.layout,o=t.stride;a==l.XY||a==l.XYM?s=2:a==l.XYZ||a==l.XYZM?s=3:q(!1,34);var i=$.length,n="";if(i>0){n+=$[0];for(var m=1;m<s;++m)n+=","+$[m];for(var p=o;p<i;p+=o){n+=" "+$[p];for(m=1;m<s;++m)n+=","+$[p+m]}}qa(e,n)}var bf=c(b,{Data:e(Ds),value:e(Fs),displayName:e(Es)});function Ds(e,$,r){e.setAttribute("name",$.name);var s={node:e},t=$.value;"object"==typeof t?(null!==t&&t.displayName&&B(s,bf,pa,[t.displayName],r,["displayName"]),null!==t&&t.value&&B(s,bf,pa,[t.value],r,["value"])):B(s,bf,pa,[t],r,["value"])}function Es(e,$){zr(e,$)}function Fs(e,$){qa(e,$)}var Gs=c(b,{Placemark:e(cm)}),Hs=function(e,$,r){var s=$[$.length-1].node;return Ad(s.namespaceURI,"Placemark")};function Is(e,$,r){B({node:e},Gs,Hs,$,r,void 0,this)}var Js=za("Data");function Ks(e,$,r){for(var s={node:e},t=$.names,a=$.values,o=t.length,i=0;i<o;i++)B(s,bf,Js,[{name:t[i],value:a[i]}],r)}var Zl=c(b,["href"],c(Wa,["x","y","w","h"])),$l=c(b,{href:e(qa)},c(Wa,{x:e(Rb),y:e(Rb),w:e(Rb),h:e(Rb)})),Ls=function(e,$,r){return Ad(Wa[0],"gx:"+r)};function Ms(e,$,r){var s={node:e},t=r[r.length-1].node,a=Zl[t.namespaceURI],o=Aa($,a);B(s,$l,pa,o,r,a),a=Zl[Wa[0]],o=Aa($,a),B(s,$l,Ls,o,r,a)}var Ns=c(b,["scale","heading","Icon","hotSpot"]),Os=c(b,{Icon:e(Ms),heading:e(Rb),hotSpot:e(nt),scale:e(fm)});function Ps(e,$,r){var s={node:e},t={},a=$.getSrc(),o=$.getSize(),i=$.getImageSize(),n={href:a};if(o){n.w=o[0],n.h=o[1];var m=$.getAnchor(),p=$.getOrigin();if(p&&i&&0!==p[0]&&p[1]!==o[1]&&(n.x=p[0],n.y=i[1]-(p[1]+o[1])),m&&(m[0]!==o[0]/2||m[1]!==o[1]/2)){var S={x:m[0],xunits:Q.PIXELS,y:o[1]-m[1],yunits:Q.PIXELS};t.hotSpot=S}}t.Icon=n;var l=$.getScale();1!==l&&(t.scale=l);var E=$.getRotation();0!==E&&(t.heading=E);var v=r[r.length-1].node,A=Ns[v.namespaceURI],d=Aa(t,A);B(s,Os,pa,d,r,A)}var Qs=c(b,["color","scale"]),Rs=c(b,{color:e(bi),scale:e(fm)});function Ss(e,$,r){var s={node:e},t={},a=$.getFill();a&&(t.color=a.getColor());var o=$.getScale();o&&1!==o&&(t.scale=o);var i=r[r.length-1].node,n=Qs[i.namespaceURI],m=Aa(t,n);B(s,Rs,pa,m,r,n)}var Ts=c(b,["color","width"]),Us=c(b,{color:e(bi),width:e(Rb)});function Vs(e,$,r){var s={node:e},t={color:$.getColor(),width:Number($.getWidth())||1},a=r[r.length-1].node,o=Ts[a.namespaceURI],i=Aa(t,o);B(s,Us,pa,i,r,o)}var Ws={Point:"Point",LineString:"LineString",LinearRing:"LinearRing",Polygon:"Polygon",MultiPoint:"MultiGeometry",MultiLineString:"MultiGeometry",MultiPolygon:"MultiGeometry",GeometryCollection:"MultiGeometry"},_l=function(e,$,r){if(e){var s=$[$.length-1].node;return Ad(s.namespaceURI,Ws[e.getType()])}},Xs=za("Point"),Ys=za("LineString"),Zs=za("LinearRing"),$s=za("Polygon"),_s=c(b,{LineString:e(Dc),Point:e(Dc),Polygon:e(em),GeometryCollection:e(am)});function am(e,$,r){var s,t,a={node:e},o=$.getType();o==k.GEOMETRY_COLLECTION?(s=$.getGeometries(),t=_l):o==k.MULTI_POINT?(s=$.getPoints(),t=Xs):o==k.MULTI_LINE_STRING?(s=$.getLineStrings(),t=Ys):o==k.MULTI_POLYGON?(s=$.getPolygons(),t=$s):q(!1,39),B(a,_s,t,s,r)}var at=c(b,{LinearRing:e(Dc)});function bm(e,$,r){B({node:e},at,Zs,[$],r)}var ci=c(b,{ExtendedData:e(Ks),MultiGeometry:e(am),LineString:e(Dc),LinearRing:e(Dc),Point:e(Dc),Polygon:e(em),Style:e(mt),address:e(qa),description:e(qa),name:e(qa),open:e(Ye),phoneNumber:e(qa),styleUrl:e(qa),visibility:e(Ye)}),bt=c(b,["name","open","visibility","address","phoneNumber","description","styleUrl","Style"]),ct=za("ExtendedData");function cm(e,$,r){var s={node:e};$.getId()&&e.setAttribute("id",$.getId());var t=$.getProperties(),a={address:1,description:1,name:1,open:1,phoneNumber:1,styleUrl:1,visibility:1};a[$.getGeometryName()]=1;var o=Object.keys(t||{}).sort().filter(function(e){return!a[e]}),i=$.getStyleFunction();if(i){var n=i($,0);if(n){var m=Array.isArray(n)?n[0]:n;this.writeStyles_&&(t.Style=m);var p=m.getText();p&&(t.name=p.getText())}}var S=r[r.length-1].node,l=bt[S.namespaceURI],E=Aa(t,l);if(B(s,ci,pa,E,r,l),o.length>0){var v=Aa(t,o);B(s,ci,ct,[{names:o,values:v}],r)}var A=r[0],d=$.getGeometry();d&&(d=vl(d,!0,A)),B(s,ci,_l,[d],r)}var dt=c(b,["extrude","tessellate","altitudeMode","coordinates"]),et=c(b,{extrude:e(Ye),tessellate:e(Ye),altitudeMode:e(qa),coordinates:e(Cs)});function Dc(e,$,r){var s=$.getFlatCoordinates(),t={node:e};t.layout=$.getLayout(),t.stride=$.getStride();var a=$.getProperties();a.coordinates=s;var o=r[r.length-1].node,i=dt[o.namespaceURI],n=Aa(a,i);B(t,et,pa,n,r,i)}var dm=c(b,{outerBoundaryIs:e(bm),innerBoundaryIs:e(bm)}),ft=za("innerBoundaryIs"),gt=za("outerBoundaryIs");function em(e,$,r){var s=$.getLinearRings(),t=s.shift(),a={node:e};B(a,dm,ft,s,r),B(a,dm,gt,[t],r)}var ht=c(b,{color:e(bi)}),it=za("color");function jt(e,$,r){B({node:e},ht,it,[$.getColor()],r)}function fm(e,$){Rb(e,Math.round(1e6*$)/1e6)}var kt=c(b,["IconStyle","LabelStyle","LineStyle","PolyStyle"]),lt=c(b,{IconStyle:e(Ps),LabelStyle:e(Ss),LineStyle:e(Vs),PolyStyle:e(jt)});function mt(e,$,r){var s={node:e},t={},a=$.getFill(),o=$.getStroke(),i=$.getImage(),n=$.getText();i&&"function"==typeof i.getSrc&&(t.IconStyle=i),n&&(t.LabelStyle=n),o&&(t.LineStyle=o),a&&(t.PolyStyle=a);var m=r[r.length-1].node,p=kt[m.namespaceURI],S=Aa(t,p);B(s,lt,pa,S,r,p)}function nt(e,$){e.setAttribute("x",String($.x)),e.setAttribute("y",String($.y)),e.setAttribute("xunits",$.xunits),e.setAttribute("yunits",$.yunits)}Ba.default=Ml;var gm=function(t,r,o,a,$){var e,p,J=8*$-a-1,N=(1<<J)-1,h=N>>1,M=-7,w=o?$-1:0,f=o?-1:1,i=t[r+w];for(w+=f,e=i&(1<<-M)-1,i>>=-M,M+=J;M>0;e=256*e+t[r+w],w+=f,M-=8);for(p=e&(1<<-M)-1,e>>=-M,M+=a;M>0;p=256*p+t[r+w],w+=f,M-=8);if(0===e)e=1-h;else{if(e===N)return p?NaN:1/0*(i?-1:1);p+=Math.pow(2,a),e-=h}return(i?-1:1)*p*Math.pow(2,e-a)};var hm=function(t,r,o,a,$,e){var p,J,N,h=8*e-$-1,M=(1<<h)-1,w=M>>1,f=23===$?Math.pow(2,-24)-Math.pow(2,-77):0,i=a?0:e-1,g=a?1:-1,s=r<0||0===r&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(J=isNaN(r)?1:0,p=M):(p=Math.floor(Math.log(r)/Math.LN2),r*(N=Math.pow(2,-p))<1&&(p--,N*=2),(r+=p+w>=1?f/N:f*Math.pow(2,1-w))*N>=2&&(p++,N/=2),p+w>=M?(J=0,p=M):p+w>=1?(J=(r*N-1)*Math.pow(2,$),p+=w):(J=r*Math.pow(2,w-1)*Math.pow(2,$),p=0));$>=8;t[o+i]=255&J,i+=g,J/=256,$-=8);for(p=p<<$|J,h+=$;h>0;t[o+i]=255&p,i+=g,p/=256,h-=8);t[o+i-g]|=128*s};function n(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}n.Varint=0,n.Fixed64=1,n.Bytes=2,n.Fixed32=5;var di=4294967296,im=1/di,ot=12,jm="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function pt(t,r,i){var e,a,s=i.buf;if(e=(112&(a=s[i.pos++]))>>4,a<128)return Ec(t,e,r);if(e|=(127&(a=s[i.pos++]))<<3,a<128)return Ec(t,e,r);if(e|=(127&(a=s[i.pos++]))<<10,a<128)return Ec(t,e,r);if(e|=(127&(a=s[i.pos++]))<<17,a<128)return Ec(t,e,r);if(e|=(127&(a=s[i.pos++]))<<24,a<128)return Ec(t,e,r);if(e|=(1&(a=s[i.pos++]))<<31,a<128)return Ec(t,e,r);throw new Error("Expected varint not more than 10 bytes")}function Xa(t){return t.type===n.Bytes?t.readVarint()+t.pos:t.pos+1}function Ec(t,r,i){return i?4294967296*r+(t>>>0):4294967296*(r>>>0)+(t>>>0)}function qt(t,r){var i,e;if(t>=0?(i=t%4294967296|0,e=t/4294967296|0):(e=~(-t/4294967296),4294967295^(i=~(-t%4294967296))?i=i+1|0:(i=0,e=e+1|0)),t>=0x10000000000000000||t<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");r.realloc(10),rt(i,e,r),st(e,r)}function rt(t,r,i){i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos++]=127&t|128,t>>>=7,i.buf[i.pos]=127&t}function st(t,r){var i=(7&t)<<4;r.buf[r.pos++]|=i|((t>>>=3)?128:0),t&&(r.buf[r.pos++]=127&t|((t>>>=7)?128:0),t&&(r.buf[r.pos++]=127&t|((t>>>=7)?128:0),t&&(r.buf[r.pos++]=127&t|((t>>>=7)?128:0),t&&(r.buf[r.pos++]=127&t|((t>>>=7)?128:0),t&&(r.buf[r.pos++]=127&t)))))}function km(t,r,i){var e=r<=16383?1:r<=2097151?2:r<=268435455?3:Math.floor(Math.log(r)/(7*Math.LN2));i.realloc(e);for(var a=i.pos-1;a>=t;a--)i.buf[a+e]=i.buf[a]}function tt(t,r){for(var i=0;i<t.length;i++)r.writeVarint(t[i])}function ut(t,r){for(var i=0;i<t.length;i++)r.writeSVarint(t[i])}function vt(t,r){for(var i=0;i<t.length;i++)r.writeFloat(t[i])}function wt(t,r){for(var i=0;i<t.length;i++)r.writeDouble(t[i])}function xt(t,r){for(var i=0;i<t.length;i++)r.writeBoolean(t[i])}function yt(t,r){for(var i=0;i<t.length;i++)r.writeFixed32(t[i])}function zt(t,r){for(var i=0;i<t.length;i++)r.writeSFixed32(t[i])}function At(t,r){for(var i=0;i<t.length;i++)r.writeFixed64(t[i])}function Bt(t,r){for(var i=0;i<t.length;i++)r.writeSFixed64(t[i])}function cf(t,r){return(t[r]|t[r+1]<<8|t[r+2]<<16)+16777216*t[r+3]}function Fc(t,r,i){t[i]=r,t[i+1]=r>>>8,t[i+2]=r>>>16,t[i+3]=r>>>24}function lm(t,r){return(t[r]|t[r+1]<<8|t[r+2]<<16)+(t[r+3]<<24)}function Ct(t,r,i){for(var e="",a=r;a<i;){var s,n,f,$=t[a],o=null,h=$>239?4:$>223?3:$>191?2:1;if(a+h>i)break;1===h?$<128&&(o=$):2===h?128==(192&(s=t[a+1]))&&(o=(31&$)<<6|63&s)<=127&&(o=null):3===h?(s=t[a+1],n=t[a+2],128==(192&s)&&128==(192&n)&&((o=(15&$)<<12|(63&s)<<6|63&n)<=2047||o>=55296&&o<=57343)&&(o=null)):4===h&&(s=t[a+1],n=t[a+2],f=t[a+3],128==(192&s)&&128==(192&n)&&128==(192&f)&&((o=(15&$)<<18|(63&s)<<12|(63&n)<<6|63&f)<=65535||o>=1114112)&&(o=null)),null===o?(o=65533,h=1):o>65535&&(o-=65536,e+=String.fromCharCode(o>>>10&1023|55296),o=56320|1023&o),e+=String.fromCharCode(o),a+=h}return e}function Dt(t,r,i){return jm.decode(t.subarray(r,i))}function Et(t,r,i){for(var e,a,s=0;s<r.length;s++){if((e=r.charCodeAt(s))>55295&&e<57344){if(!a){e>56319||s+1===r.length?(t[i++]=239,t[i++]=191,t[i++]=189):a=e;continue}if(e<56320){t[i++]=239,t[i++]=191,t[i++]=189,a=e;continue}e=a-55296<<10|e-56320|65536,a=null}else a&&(t[i++]=239,t[i++]=191,t[i++]=189,a=null);e<128?t[i++]=e:(e<2048?t[i++]=e>>6|192:(e<65536?t[i++]=e>>12|224:(t[i++]=e>>18|240,t[i++]=e>>12&63|128),t[i++]=e>>6&63|128),t[i++]=63&e|128)}return i}n.prototype={destroy:function(){this.buf=null},readFields:function(t,r,i){for(i=i||this.length;this.pos<i;){var e=this.readVarint(),a=e>>3,s=this.pos;this.type=7&e,t(a,r,this),this.pos===s&&this.skip(e)}return r},readMessage:function(t,r){return this.readFields(t,r,this.readVarint()+this.pos)},readFixed32:function(){var t=cf(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=lm(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=cf(this.buf,this.pos)+cf(this.buf,this.pos+4)*di;return this.pos+=8,t},readSFixed64:function(){var t=cf(this.buf,this.pos)+lm(this.buf,this.pos+4)*di;return this.pos+=8,t},readFloat:function(){var t=gm(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=gm(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var r,i,e=this.buf;return r=127&(i=e[this.pos++]),i<128?r:(r|=(127&(i=e[this.pos++]))<<7,i<128?r:(r|=(127&(i=e[this.pos++]))<<14,i<128?r:(r|=(127&(i=e[this.pos++]))<<21,i<128?r:pt(r|=(15&(i=e[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,r=this.pos;return this.pos=t,t-r>=ot&&jm?Dt(this.buf,r,t):Ct(this.buf,r,t)},readBytes:function(){var t=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,t);return this.pos=t,r},readPackedVarint:function(t,r){if(this.type!==n.Bytes)return t.push(this.readVarint(r));var i=Xa(this);for(t=t||[];this.pos<i;)t.push(this.readVarint(r));return t},readPackedSVarint:function(t){if(this.type!==n.Bytes)return t.push(this.readSVarint());var r=Xa(this);for(t=t||[];this.pos<r;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==n.Bytes)return t.push(this.readBoolean());var r=Xa(this);for(t=t||[];this.pos<r;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==n.Bytes)return t.push(this.readFloat());var r=Xa(this);for(t=t||[];this.pos<r;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==n.Bytes)return t.push(this.readDouble());var r=Xa(this);for(t=t||[];this.pos<r;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==n.Bytes)return t.push(this.readFixed32());var r=Xa(this);for(t=t||[];this.pos<r;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==n.Bytes)return t.push(this.readSFixed32());var r=Xa(this);for(t=t||[];this.pos<r;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==n.Bytes)return t.push(this.readFixed64());var r=Xa(this);for(t=t||[];this.pos<r;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==n.Bytes)return t.push(this.readSFixed64());var r=Xa(this);for(t=t||[];this.pos<r;)t.push(this.readSFixed64());return t},skip:function(t){var r=7&t;if(r===n.Varint)for(;this.buf[this.pos++]>127;);else if(r===n.Bytes)this.pos=this.readVarint()+this.pos;else if(r===n.Fixed32)this.pos+=4;else{if(r!==n.Fixed64)throw new Error("Unimplemented type: "+r);this.pos+=8}},writeTag:function(t,r){this.writeVarint(t<<3|r)},realloc:function(t){for(var r=this.length||16;r<this.pos+t;)r*=2;if(r!==this.length){var i=new Uint8Array(r);i.set(this.buf),this.buf=i,this.length=r}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Fc(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Fc(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Fc(this.buf,-1&t,this.pos),Fc(this.buf,Math.floor(t*im),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Fc(this.buf,-1&t,this.pos),Fc(this.buf,Math.floor(t*im),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?qt(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var r=this.pos;this.pos=Et(this.buf,t,this.pos);var i=this.pos-r;i>=128&&km(r,i,this),this.pos=r-1,this.writeVarint(i),this.pos+=i},writeFloat:function(t){this.realloc(4),hm(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),hm(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var r=t.length;this.writeVarint(r),this.realloc(r);for(var i=0;i<r;i++)this.buf[this.pos++]=t[i]},writeRawMessage:function(t,r){this.pos++;var i=this.pos;t(r,this);var e=this.pos-i;e>=128&&km(i,e,this),this.pos=i-1,this.writeVarint(e),this.pos+=e},writeMessage:function(t,r,i){this.writeTag(t,n.Bytes),this.writeRawMessage(r,i)},writePackedVarint:function(t,r){r.length&&this.writeMessage(t,tt,r)},writePackedSVarint:function(t,r){r.length&&this.writeMessage(t,ut,r)},writePackedBoolean:function(t,r){r.length&&this.writeMessage(t,xt,r)},writePackedFloat:function(t,r){r.length&&this.writeMessage(t,vt,r)},writePackedDouble:function(t,r){r.length&&this.writeMessage(t,wt,r)},writePackedFixed32:function(t,r){r.length&&this.writeMessage(t,yt,r)},writePackedSFixed32:function(t,r){r.length&&this.writeMessage(t,zt,r)},writePackedFixed64:function(t,r){r.length&&this.writeMessage(t,At,r)},writePackedSFixed64:function(t,r){r.length&&this.writeMessage(t,Bt,r)},writeBytesField:function(t,r){this.writeTag(t,n.Bytes),this.writeBytes(r)},writeFixed32Field:function(t,r){this.writeTag(t,n.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(t,r){this.writeTag(t,n.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(t,r){this.writeTag(t,n.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(t,r){this.writeTag(t,n.Fixed64),this.writeSFixed64(r)},writeVarintField:function(t,r){this.writeTag(t,n.Varint),this.writeVarint(r)},writeSVarintField:function(t,r){this.writeTag(t,n.Varint),this.writeSVarint(r)},writeStringField:function(t,r){this.writeTag(t,n.Bytes),this.writeString(r)},writeFloatField:function(t,r){this.writeTag(t,n.Fixed32),this.writeFloat(r)},writeDoubleField:function(t,r){this.writeTag(t,n.Fixed64),this.writeDouble(r)},writeBooleanField:function(t,r){this.writeVarintField(t,Boolean(r))}};var Ft={};Ft="world.f2ba79d8.svg";var Gt={};Gt="2012_Earthquakes_Mag5.fee35d44.kml";var Ht=Cd(Gt);var mm=new gl({target:"map",view:new Zd({center:[0,0],extent:[-180,-90,180,90],projection:"EPSG:4326",zoom:2})}),It=new tl({source:new zc({url:Ht.d,format:new Ml({extractStyles:!1})})});mm.addLayer(It);var Ca=document.createElement("div"),df=new XMLHttpRequest;var nm=Cd(Ft);console.log(nm.d),df.open("GET",nm.d),df.addEventListener("load",function(){var e=df.responseXML.documentElement;Ca.ownerDocument.importNode(e,!1),Ca.appendChild(e)}),df.send();var ei=2560,om=1280,fi=360/ei;Ca.style.width=ei+"px",Ca.style.height=om+"px",Ca.style.transformOrigin="top left",Ca.style.position="absolute",Ca.className="svg-layer";var pm=new de({render:function(e){var $=fi/e.viewState.resolution,r=e.viewState.center,a=e.size,t=cj(a[0]/2,a[1]/2,$,$,e.viewState.rotation,-r[0]/fi-ei/2,r[1]/fi-om/2);return Ca.style.transform=t,Ca.style.opacity=String(pm.getOpacity()),Ca}});mm.addLayer(pm);Gc.__esModule=true;Hc.__esModule=true;Tb.__esModule=true;Ic.__esModule=true;Jc.__esModule=true;ub.__esModule=true;Ub.__esModule=true;Kc.__esModule=true;Wb.__esModule=true;Mc.__esModule=true;ff.__esModule=true;S.__esModule=true;Oc.__esModule=true;hf.__esModule=true;Qc.__esModule=true;Rc.__esModule=true;Tc.__esModule=true;Vc.__esModule=true;pf.__esModule=true;Wc.__esModule=true;qf.__esModule=true;rf.__esModule=true;Ha.__esModule=true;Gd.__esModule=true;ia.__esModule=true;g.__esModule=true;Ef.__esModule=true;t.__esModule=true;Nd.__esModule=true;zb.__esModule=true;If.__esModule=true;Ka.__esModule=true;Jf.__esModule=true;i.__esModule=true;Td.__esModule=true;o.__esModule=true;fd.__esModule=true;Ra.__esModule=true;og.__esModule=true;jc.__esModule=true;kc.__esModule=true;Cg.__esModule=true;md.__esModule=true;Gg.__esModule=true;pc.__esModule=true;sd.__esModule=true;td.__esModule=true;qc.__esModule=true;gh.__esModule=true;hh.__esModule=true;uc.__esModule=true;vd.__esModule=true;yh.__esModule=true;wc.__esModule=true;wd.__esModule=true;xd.__esModule=true;({}).__esModule=true;({}).__esModule=true;Te.__esModule=true;zd.__esModule=true;Ve.__esModule=true;({}).__esModule=true;return{"vFY1":{},"ZXtR":Gc,"cPxi":Hc,"Kjrg":Tb,"ZRwq":Ic,"KA50":Jc,"fB8e":ub,"TW86":Ub,"MGag":Kc,"SLsU":Wb,"KnPA":Mc,"jZkk":ff,"o0G8":S,"M1Cf":Oc,"GUXn":hf,"XTM4":Qc,"umZa":Rc,"iEtH":Tc,"jTsN":Vc,"JwZs":pf,"mzg7":Wc,"FoaO":qf,"DVOE":rf,"rXL1":Ha,"exM9":Gd,"qAK2":ia,"L0Vw":g,"Xc5u":Ef,"CMtO":t,"nqHs":Nd,"k82w":zb,"ChjE":If,"DTlF":Ka,"svVK":Jf,"VAQc":i,"TVqV":Td,"Ln8D":o,"IIKA":fd,"FYLQ":Ra,"zzvP":og,"d9VJ":jc,"OA2l":kc,"tIB5":Cg,"xukD":md,"pnST":Gg,"E2jd":pc,"qAxQ":sd,"AGre":td,"JtXZ":qc,"sqJC":gh,"dz0b":hh,"yR82":uc,"NvYl":vd,"kcKm":yh,"v3xZ":wc,"Y9Xi":wd,"AC87":xd,"x523":{},"kjaO":{},"bYOC":Te,"PqrZ":zd,"m5CX":Ve,"ZO7P":{},"eP5I":{}};});